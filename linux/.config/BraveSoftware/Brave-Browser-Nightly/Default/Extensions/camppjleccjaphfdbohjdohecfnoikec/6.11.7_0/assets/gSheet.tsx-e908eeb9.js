import{R as d,j as o,c as p}from"./client-45b27fd3.js";import{o as i,L as c,d as m,g as h}from"./index-825701e8.js";import{S as u}from"./merlin-logo-9fa3c977.js";import{A as g,R as f,M as x}from"./index-9b1f0f42.js";import{f as S}from"./analytics-46c41402.js";import{u as w}from"./useUserSettings-c0487dc5.js";import{u as v}from"./useTranslation-c38a45bb.js";import{m as y}from"./motion-2f15212b.js";import{I as b}from"./IconX-71686591.js";import{c as E}from"./index-5c33a703.js";import"./hook-ae816606.js";import"./createReactComponent-d14705e3.js";const T="https://docs.google.com/spreadsheets/d/<KEY>/export?format=csv&gid=<GID>",R="/",C=0;function I(e){try{const t=new URL(e);let r=t.searchParams.get("gid");return r||(r=new URLSearchParams(t.hash.substring(1)).get("gid")),r?parseInt(r,10):0}catch(t){return console.error("Invalid URL:",t),C}}async function A(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.text()}catch(t){console.error("Fetching CSV failed:",t)}}const j=()=>window.location.href.split(R),F=async()=>{const t=j()[5],r=T.replace("<KEY>",t).replace("<GID>",I(window.location.href).toString());return await A(r)};function O(){const{t:e}=v(),[t,r]=w(),[s,n]=d.useState(!0);return o.jsx(o.Fragment,{children:s&&o.jsxs("div",{className:"group/amazon relative my-4 flex w-fit -translate-x-2",style:{zIndex:999999},children:[o.jsx("div",{className:"gradient-animated scale-55 relative flex w-fit rounded-md p-[1px]",children:o.jsxs("button",{type:"button",onClick:async a=>{a.preventDefault(),S({eventName:"ctaOnGoogleSheetsClickedDefaultQuestion",eventType:"Button",feature:"CodeInterpreterCTA",firedFromFile:"components/ctaOnGoogleSheets"});const l=await F();window.parent.postMessage({data:{action:g.CODE_INTERPRETER_WITH_FILE,csv:l,query:"Read This CSV File, I have some questions"},type:f.CODE_INTERPRETER_CTA},"*")},className:"relative flex w-fit max-w-xs flex-auto items-center justify-center gap-2 rounded-md border border-zinc-400 bg-white px-3 py-2 text-zinc-800",children:[o.jsx(u,{className:"h-5 w-5"}),o.jsx("span",{children:e("super_gmail.sheets_ai")})]})}),o.jsx(y.div,{onClick:()=>{n(!1),r(x.codeInterpreterCTAOnSheets)},className:"text-cornblue-800 p-.5 c-hide group-hover/amazon:c-show absolute -right-2 -top-1 cursor-pointer rounded-md border bg-zinc-400 shadow-md transition-[opacity,visibility] delay-500 hover:bg-zinc-500 hover:delay-0 group-hover/amazon:delay-0",children:o.jsx(b,{className:"h-4 w-4 text-white"})})]})})}const K={matches:["https://docs.google.com/spreadsheets/d/*/**","https://sheets.new/*/**"]},U=async()=>{const e=document.querySelector(".trix-offscreen"),t=await c.get("gSheet");t&&m(e,t),c.remove("gSheet")};(async()=>{try{await i(".trix-offscreen"),U()}catch(e){e instanceof Error&&console.error("Error in content script",(e==null?void 0:e.message)||"")}})();const N=async()=>{const e=document.createElement("merlin-component");e.className="merlin ai-compose-btn docs-titlebar-badges goog-inline-block";const t=e.attachShadow({mode:"open"}),r=document.createElement("style");r.textContent=`${E}
      .ai-compose-btn{
        all: initial; /* 1st rule so subsequent properties are reset. */
        position: relative;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      `;const s=document.createElement("div");s.id="reactAppRootBtn",s.className="reactAppRootBtn",t.appendChild(r),t.appendChild(s);const n=document.querySelector(".docs-titlebar-buttons"),a=document.querySelector('[aria-labelledby="docs-title-input-label-inner"');n?n.prepend(e):a&&a.append(e),p(s).render(o.jsx(O,{}))},D=async()=>{const e=await c.get("UserSettings"),t=await h();t.misc&&t.misc.merlinOnGoogleSheets&&t.misc.merlinOnGoogleSheets.visible&&(e&&e.codeInterpreterCTAOnSheets&&!e.codeInterpreterCTAOnSheets.visible||(await i(".trix-offscreen"),N()))};D();export{K as config};
