import{r as w,R as m,j as o,c as v}from"./client-45b27fd3.js";import{g as S}from"./index-9b1f0f42.js";import{L as A}from"./hook-ae816606.js";import{U as B,i as b}from"./index-825701e8.js";import{a as R,A as M}from"./index-37dc4817.js";import{T as C}from"./themeContext-38ece4f9.js";import{u as E}from"./useWindowSize-08198345.js";import{u as j}from"./useTranslation-c38a45bb.js";import{A as l}from"./index-39fb8d8a.js";import{m as p}from"./motion-2f15212b.js";import{c as k}from"./index-5c33a703.js";const L=()=>{const{t:e}=j(),t=w.useContext(R),{isAuthLoading:n,isAuthenticated:r}=t,[i,a]=m.useState(!1),c=document.querySelector("#segmented-like-button"),u=document.querySelector("#subscribe-button"),[s,y]=m.useState(0),[h]=E();m.useEffect(()=>{if(c&&u){const d=c.getBoundingClientRect(),g=u.getBoundingClientRect(),x=d.left-g.right;y(x)}},[h,c,u,s]);const f=d=>{d.preventDefault(),window.parent.postMessage({type:"HANDLE_SUMMARIZE_FROM_MID_BUTTON"},"*")};return o.jsx(l,{children:(s>65||s<0)&&o.jsx(p.button,{type:"button",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:f,className:"center-with-flex bg-cornblue-600 group relative mx-2 cursor-pointer gap-2 rounded-3xl border-[0px] px-3 py-2 font-sans",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:o.jsx(l,{children:(s>145||s<0)&&o.jsx(p.div,{className:"group relative whitespace-nowrap font-sans text-sm font-semibold text-zinc-50",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:r?e("yt_lib.summarize"):o.jsx(o.Fragment,{children:n?`${e("yt_header.logging")} . . .`:e("yt_header.login")})})})})})},T=()=>{const[e={ytSummarizer:{visible:!1}}]=A({instance:new S({area:"local"}),key:"UserSettings"});return e.ytSummarizer.visible?o.jsx(M,{children:o.jsx(C,{children:o.jsx(L,{})})}):null};function z(){return new Promise(e=>{const t=new MutationObserver(b(()=>{const n=document.querySelector("ytd-menu-renderer.style-scope.ytd-watch-metadata");n&&(e(n),t.disconnect())},50));t.observe(document.body,{childList:!0,subtree:!0})})}const D=async e=>{const t=document.createElement("merlin-component");t.id="merlin-yt-mid-button",t.className="merlin yt-mid-button";const n=t.attachShadow({mode:"open"}),r=document.createElement("style");r.textContent=`${k}
:host(#merlin-yt-mid-button) {
    all: initial; /* 1st rule so subsequent properties are reset. */
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
.ytMidButtonAppRoot {
    z-index: 1 !important;
    position: relative;
}
`;const i=document.createElement("div");i.id="ytMidButtonAppRoot",i.className="ytMidButtonAppRoot",n.appendChild(r),n.appendChild(i),e(t),v(i).render(o.jsx(T,{}))},W=async()=>{if(document.getElementById("merlin-yt-mid-button"))return;const e=await B();if(!(e&&e.tweetify.visible)&&(await z(),document.body)){const t=new MutationObserver(b(()=>{const n=document.querySelectorAll("ytd-menu-renderer.style-scope.ytd-watch-metadata");if(n.length>0)for(let r=0;r<n.length;r++)n[r].querySelector("merlin-component")||(D(i=>n[r].prepend(i)),t.disconnect())},300));t.observe(document.body,{attributes:!0,childList:!0,subtree:!0})}};W();
