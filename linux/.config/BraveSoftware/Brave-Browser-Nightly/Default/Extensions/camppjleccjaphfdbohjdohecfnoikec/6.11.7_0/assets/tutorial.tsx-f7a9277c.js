import{r as l,j as t,c as R}from"./client-45b27fd3.js";import{A as S,D as T,g as k,U as L}from"./index-9b1f0f42.js";import{L as O}from"./hook-ae816606.js";import{c as U,g as A,p as I}from"./index-825701e8.js";import{C as M}from"./index-24d5af66.js";import{S as F}from"./merlin-logo-9fa3c977.js";import{A as C}from"./aspect-ratio-6b812a0d.js";import{B as w}from"./button-f1c09d10.js";import{C as W,b as z,c as B,a as D,e as H,d as _}from"./card-16c0c2c1.js";import{u as P}from"./index-b9ed417e.js";import{u as q}from"./useTranslation-c38a45bb.js";import{I as G}from"./IconX-71686591.js";import{c as K}from"./index-5c33a703.js";import"./index-cf2cbbfc.js";import"./utils-01642ffa.js";import"./createReactComponent-d14705e3.js";const V=({host:s,tutorialConfig:e})=>{var h,x;const{t:r}=q(),o=l.useRef(null),{tutorial:i,updateTutorial:c}=P(s),[m,p]=l.useState(void 0);return e[s]?(l.useEffect(()=>{function a(E){var N,y;const{data:n}=E.data;if((n==null?void 0:n.action)!==S.OPEN_TUTORIAL)return;const{innerHeight:b,innerWidth:g}=window,u=((N=n==null?void 0:n.position)==null?void 0:N.y)+24,f=(y=n==null?void 0:n.position)==null?void 0:y.x,j=g-f-12,v=b-u+34;let d={bottom:v,right:j,transformOrigin:"bottom right"};g-j<450&&(d={left:f+12,top:u+10,transformOrigin:"top left"}),b-v<300&&(d={left:f+12,top:u+10,transformOrigin:"top left"}),!Object.values(d).includes(NaN)&&p(d)}return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[]),t.jsx(t.Fragment,{children:i&&m&&t.jsxs(W,{ref:o,style:m,className:"fixed w-[30vw] min-w-[360px] max-w-[480px] overflow-hidden",children:[t.jsxs(z,{className:"flex flex-row justify-between space-y-0 p-3",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(F,{className:"h-6 w-6"}),t.jsx(B,{className:"text-lg font-medium leading-4",children:r("tutorials.tutorial")})]}),t.jsx(w,{variant:"ghost",size:"icon",onClick:()=>c(!1),children:t.jsx(G,{size:20})})]}),t.jsxs(D,{className:"space-y-3 p-3 pt-0",children:[t.jsx(C,{ratio:16/9,className:"bg-muted",children:t.jsx("iframe",{src:((h=e==null?void 0:e[s])==null?void 0:h.videoURL)+"?autoplay=1&mute=1&controls=0",className:"absolute left-0 top-0 h-full w-full max-w-full border-none",allow:"autoplay",allowFullScreen:!0,title:"Merlin Demo"})}),t.jsx(H,{className:"leading-6",children:(x=e==null?void 0:e[s])==null?void 0:x.summary})]}),t.jsxs(_,{className:"flex items-center justify-between gap-4 p-3 pt-0",children:[t.jsx(w,{variant:"outline",onClick:()=>{var a;return U((a=e==null?void 0:e[s])==null?void 0:a.blogURL)},children:r("tutorials.blogs")}),t.jsx(w,{onClick:()=>c(!1),children:r("tutorials.skip")})]})]})})):null};function X(s){const[e=L]=O({instance:new k({area:"local"}),key:"UserSettings"}),[r,o]=l.useState();return l.useEffect(()=>{window.location.hostname.includes("mail.google")&&o("gmail"),window.location.hostname.includes("outlook")&&o("outlook"),window.location.hostname.includes("facebook")&&o("facebook"),window.location.hostname.includes("twitter")&&o("twitter"),window.location.hostname.includes("linkedin")&&o("linkedin")},[]),!e.merlinGUI.visible&&r?t.jsx(M,{children:t.jsx(V,{host:r,tutorialConfig:s==null?void 0:s.tutorialConfig})}):null}const $=async()=>{if(document.getElementById("merlin-tutorial"))return;const s=await A();if(s&&!s.misc.chat.visible)return;const e=document.createElement("merlin-component");e.id="merlin-tutorial",e.className="merlin-tutorial";const r=e.attachShadow({mode:"open"}),o=document.createElement("style");o.textContent=`${K}
    :host(#merlin-tutorial) {
    }
    .reactAppRoot {
      all: initial; /* 1st rule so subsequent properties are reset. */
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      position: relative;
      z-index: 2147483647;
    }
    `;const i=document.createElement("div");i.id="reactAppRoot",i.className="reactAppRoot",T.forEach(m=>{i.addEventListener(m,p=>{p.stopPropagation()})}),r.appendChild(o),r.appendChild(i),I(e);const c=R(i);J(()=>{c.render(t.jsx(X,{tutorialConfig:s==null?void 0:s.tutorialConfig}))})},J=s=>{let e="";const r=new MutationObserver(i=>{location.href!==e&&(e=location.href,s())}),o={childList:!0,subtree:!0};r.observe(document.body,o)};$();
