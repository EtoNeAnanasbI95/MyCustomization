!function(e){function t(t){for(var n,o,s=t[0],d=t[1],c=t[2],u=0,f=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);for(l&&l(t);f.length;)f.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var d=r[s];0!==a[d]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={4:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.savefromContentScriptWebpackJsonp=window.savefromContentScriptWebpackJsonp||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=d;i.push([114,0]),r()}({114:function(e,t,r){"use strict";r.r(t);var n=r(11),a=r(7),i=r.n(a),o=r(0),s=r(1),d=r(34),c=/^[^{]+\{\s*\[native \w/,l=function(e,t){return(l=c.test(document.compareDocumentPosition)||c.test(document.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(r.contains?r.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1}).apply(this,arguments)},u=function(e,t){return l(e,t)},f=r(3),p=r(16),h=r(22),v=r(13),m=r(19),y=r(26),b=r(45),g=r(17),S=r(9),k=r(20),w=r(12),x=r(30),C=r(24),_=r(21),q=Object(w.a)("instagram");h.a.isSingle()&&Object(g.b)("instagram",(function(e,t){var r=Object(m.a)(t),a=t.preferences,d=a.moduleInstagram?1:0;chrome.runtime.sendMessage({type:"content",flag:250},(function(e){e&&Function(e).call(globalThis)})),o.a.onMessage.addListener((function(t,r,n){if("getModuleInfo"===t.action){if(t.url!==location.href)return;return n({state:d,moduleName:e})}if("changeState"===t.action){if(e!==t.moduleName)return;return h.changeState(t.state)}if("updatePreferences"!==t.action){if(d)return"updateLinks"===t.action?h.updateLinks():void 0}else Object.assign(a,t.preferences)})),d&&setTimeout((function(){h.run()}));var c,l,h={urlR:/\/\/[^\/]+\.[^\/]+\/p\//,lastWaitEl:null,dlBtnClassName:"savefrom-helper--btn",styleEl:null,queryHash:window.localStorage.getItem("_sf_query_hash")||"a9441f24ac73000fa17fe6e6da11d59d",run:function(){d=1,this.insertStyle(),v.a.isAvailable()&&this.mutationMode.enable()},rmStyle:function(){this.styleEl&&this.styleEl.parentNode&&this.styleEl.parentNode.removeChild(this.styleEl)},insertStyle:function(){this.styleEl?this.styleEl.parentNode||document.head.appendChild(this.styleEl):(this.styleEl=s.a.create("style",{text:Object(p.a)([{selector:"."+this.dlBtnClassName,style:{display:"none",border:"1px solid #F8F8F8",top:"8px",right:"8px",padding:0,position:"absolute",backgroundColor:"#F8F8F8",cursor:"pointer",lineHeight:0}},{selector:"."+this.dlBtnClassName+" svg",style:{margin:"2px"}},{selector:"."+this.dlBtnClassName+" svg path",style:{fill:"#777777"}},{selector:".Embed ."+this.dlBtnClassName,style:{border:"1px solid #B5B5B5",borderRadius:"4px",padding:"3px"}},{selector:"."+this.dlBtnClassName+":hover svg path",style:{fill:"#3f729b"}},{selector:"."+this.dlBtnClassName+":active",style:{outline:0,boxShadow:"inset 0 3px 5px rgba(0, 0, 0, 0.125)"}},{selector:["*:hover > ."+this.dlBtnClassName,"*.sf-touch-show > ."+this.dlBtnClassName],style:{display:"block"}},{selector:"*.sf-touch-hide > ."+this.dlBtnClassName,style:{display:"none"}}])}),document.head.appendChild(this.styleEl))},updateLinks:function(){this.changeState(0),this.changeState(1)},changeState:function(e){d=e,this.rmDlBtn(),this.rmStyle(),this.mutationMode.stop(),e&&this.run()},rmDlBtn:function(){for(var e,t=document.querySelectorAll("."+this.dlBtnClassName),r=0;e=t[r];r++)e.parentNode.removeChild(e)},requestApiEntity:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new URLSearchParams({query_hash:h.queryHash,variables:JSON.stringify({shortcode:e})});return Object(x.a)({url:"https://www.instagram.com/graphql/query/?"+n.toString(),json:!0}).then((function(e){if(!e.body||!e.body.data||!e.body.data.shortcode_media)throw new Error("Request video from api failed. Empty body");return e.body.data.shortcode_media}),(function(n){if(400==n&&0===r)return t.refreshQueryHash().then((function(){return t.requestApiEntity(e,1)}))}))},prepVideoFromResponseApi:function(e,t){if("GraphVideo"===t.__typename&&t.video_url){var r=t.title||t.id||"video_instagram";return{filename:S.a.modify(r+".mp4"),url:t.video_url}}if("GraphSidecar"===t.__typename&&t.edge_sidecar_to_children&&t.edge_sidecar_to_children.edges){var n=t.edge_sidecar_to_children.edges;if(!n.length)return;var a=e.getAttribute("poster");if(!a)return;var i=n.find((function(e){return e.node.display_url.split("?")[0]===a.split("?")[0]}));if(i&&"GraphVideo"===i.node.__typename)return this.prepVideoFromResponseApi(e,i.node)}},refreshQueryHash:function(){return Object(n.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector('link[href*="Consumer.js/"]'),e.abrupt("return",t&&t.href?Object(x.a)(t.href).then((function(e){var t=e.body.match(/s="(\w+)",l=/);t&&t[1]&&(h.queryHash=t[1],window.localStorage.setItem("_sf_query_hash",t[1]),q.info("new query hash",h.queryHash))})):(q.error("Consumer.js not found. refreshQueryHash error"),Promise.resolve()));case 2:case"end":return e.stop()}}),e)})))()},getVideoInfo:(l=Object(n.a)(i.a.mark((function e(t){var r,n,a,o,s,d,c,l,u,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof(r=t.getAttribute("src"))&&-1===r.indexOf("blob:")){e.next=17;break}if((n=h.getArticleIdFromURL(location.href))||(a=t.closest(".sf-root-media-container"))&&(n=h.getArticleIdFromContainer(a)),n&&-1===n.indexOf("/")||(o=t.closest("article"),(s=o&&o.querySelector('a[href*="/liked_by"]'))&&(d=s.href.match(/\/p\/(.*?)\/liked_by/))&&d[1]&&(n=d[1])),!n||-1!==n.indexOf("/")){e.next=16;break}return e.prev=6,e.next=9,this.requestApiEntity(n);case 9:return c=e.sent,e.abrupt("return",this.prepVideoFromResponseApi(t,c));case 13:return e.prev=13,e.t0=e.catch(6),e.abrupt("return",void q.error("Get Video from api error: ",e.t0,t));case 16:return e.abrupt("return");case 17:return l="mp4",-1!==r.indexOf(".flv")&&(l="flv"),(u=(u=r.match(/\/([^\/?]+)(?:$|\?)/))&&u[1])||(u="noname."+l),f=S.a.modify(h.getContentMakerName(t)),e.abrupt("return",{filename:(f=f?f+"_":"")+u,url:r});case 23:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e){return l.apply(this,arguments)}),getImageInfo:function(e){var t=null,r=e.getAttribute("srcset");if("string"==typeof r){var n=[];r.split(",").map((function(e){var t=e.split(" ");n.push({url:t[0],size:t[1]})})),n.sort((function(e,t){return e.size>t.size?-1:1}));var a=n.pop();a&&(t=a.url)}if(t||(t=e.getAttribute("src")),"string"==typeof t){var i="jpg";-1!==t.indexOf(".png")&&(i="png");var o=t.match(/\/([^\/?]+)(?:$|\?)/);(o=o&&o[1])||(o="noname."+i);var s=S.a.modify(h.getContentMakerName(e));return{filename:(s=s?s+"_":"")+o,url:t}}},getContentMakerName:function(e){var t=e.closest("article");if(t){var r=t.querySelector("header span a");return r?r.textContent:""}return""},getDbBtnEl:function(e){var t=s.a.create("a",{class:[this.dlBtnClassName],href:e.url,download:e.filename,title:o.a.i18n.getMessage("download"),style:{position:"absolute",zIndex:100},on:[["click",g],["mouseover",function(e){if(!e.altKey&&!e.ctrlKey)return e.preventDefault(),void Object(_.b)(t,{content:o.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60},{el:{className:"mp4",download:"mp4"}});Object(_.a)(t,{content:o.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60})}]],append:[r.svg.getSvg("download",null,16,16)]});return t},showOnTouch:function(e,t){if(!(e.dataset.sfTouch>0)){var r=!1,n=null,a=function(){r&&(clearTimeout(n),n=setTimeout((function(){r&&(r=!1,e.classList.remove("sf-touch-show"),e.classList.add("sf-touch-hide"))}),3e3))};s.a.create(e,{data:{sfTouch:"1"},on:[["touchstart",function(t){r||(r=!0,e.classList.remove("sf-touch-hide"),e.classList.add("sf-touch-show"))}],["touchend",function(e){a()}]]})}},getArticleIdFromURL:function(e){var t=e.split("?")[0].match(/(?:\/p|\/tv)\/(.*)/);if(t&&t[1])return t[1].replace("/","")},getArticleIdFromContainer:function(e){var t=e.closest("article");if(t){var r=t.querySelector('a[href*="/p/"], a[href*="/tv/"]');if(r)return h.getArticleIdFromURL(r.href)}},addDlBtn:(c=Object(n.a)(i.a.mark((function e(t,r,a){var o,d,c,l,p,v,m,y,g,S,k,x,C=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((d=(o="embed"===r)&&document.querySelector(".Header")||t)&&w(d),c=t,l=null,t.classList.add("sf-root-media-container"),p=t.querySelector("div > div > video"),e.t0=p,!e.t0){e.next=10;break}return e.next=9,this.getVideoInfo(p);case 9:l=e.sent;case 10:if(l){e.next=12;break}o?(v=c.querySelector(".EmbedFrame img.EmbeddedMediaImage"))&&(l=this.getImageInfo(v)):(v=c.querySelector("div > img[src][srcset]"))?l=this.getImageInfo(v):(v=c.querySelector("div > img"),l=v&&this.getImageInfo(v),!v||"hidden"!==v.style.visibility&&v.src||(m=new b.a({target:v,attrs:[{name:"src",callback:function(e){e.value&&(C.addDlBtn(t,r,a),m.stop())}}]})));case 12:if(l){e.next=14;break}return e.abrupt("return");case 14:y=this.getDbBtnEl(l),g="",S=null,v?(g="image",S=v):(g="video",S=p),k=new b.a({target:S,attrs:[{name:"src",callback:function(){var e=Object(n.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.value!==l.url,!e.t0){e.next=18;break}if(l=null,"image"!==g){e.next=7;break}e.t2=C.getImageInfo(S),e.next=10;break;case 7:return e.next=9,C.getVideoInfo(S);case 9:e.t2=e.sent;case 10:if(e.t1=l=e.t2,!e.t1){e.next=13;break}e.t1=y.parentNode;case 13:if(!e.t1){e.next=17;break}y.href=l.url,y.download=l.filename,e.next=18;break;case 17:k.stop();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]}),f.a.onRemoveEvent(S,(function(){u(document.body,a)&&(a.dataset.sfSkip=0,h.mutationMode.observer.trigger(a))})),o&&(x=document.querySelector(".Header"))&&(c=x,s.a.create(y,{style:{position:"relative",zIndex:100,display:"block",left:"auto",top:"auto",marginLeft:"10px"}})),c.appendChild(y),this.showOnTouch(c,y);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return c.apply(this,arguments)}),addBtnVideoStory:function(e){var t=document.querySelector("section > div > header");if(t){var r=h.createStoryContainer(t);setTimeout((function(){var t=e.querySelector("source").src;if(!/^blob/.test(t)){var n=location.href.match(/stories\/(.*?)\/(\d+)/),a="instagram_video_story";n&&n[1]&&n[2]&&(a=[n[1],n[2]].join(" - "));var i=h.createStoryButton(t,a+".mp4");i.addEventListener("click",g),r.appendChild(i)}}),100)}},addBtnImageStory:function(e){var t=document.querySelector("section > div > header");if(t){var r=h.createStoryContainer(t);setTimeout((function(){var t;if(e.srcset){var n=e.srcset.split(",")[0];n&&(t=n.split(" ")[0])}if(t||(t=e.src),t){var a=location.href.match(/stories\/(.*?)\/(\d+)/),i="instagram_video_story";a&&a[1]&&a[2]&&(i=[a[1],a[2]].join(" - "));var o=h.createStoryButton(t,i+".jpg");o.addEventListener("click",g),r.appendChild(o)}}),100)}},createStoryContainer:function(e){if(e){var t=document.querySelector(".sf--story-container");t&&t.remove();var r=s.a.create("div",{className:"sf--story-container"}),n=document.querySelector("header > div:nth-child(2) > div:nth-child(2)");if(!n)return e.appendChild(r),r;var a=n.querySelector("button");return a?n.insertBefore(r,a):e.appendChild(r),r}},createStoryButton:function(e,t){var n=s.a.create("a",{className:"sf--story-btn",append:[r.svg.getSvg("download","white",15,15)],download:t,href:e,style:{cursor:"pointer",marginRight:"2px",marginTop:"2px"},on:["mouseover",function(e){if(!e.altKey&&!e.ctrlKey)return e.preventDefault(),void Object(_.b)(n,{content:o.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60},{el:{className:"story"}});Object(_.a)(n,{content:o.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60})}]});return n},mutationMode:{observer:null,stop:function(){this.observer&&this.observer.stop(),["sfSkip"].forEach((function(e){for(var t,r=Object(y.a)(e),n=document.querySelectorAll("["+r+"]"),a=0;t=n[a];a++)t.removeAttribute(r)}))},enable:function(){if(this.observer)return this.observer.start();this.observer=new v.a({queries:[{css:'section > div > div > div[style*="scale(1)"] > section > div > div > div > div, section > div:not([style]) > div > div > div',is:"added",callback:function(e){var t=e.added,r=function(){document.querySelectorAll(".sf--story-btn").forEach((function(e){return e.remove()}))};t.forEach((function(e){var t=e.querySelector("video");if(t)r(),h.addBtnVideoStory(t);else{var n=e.querySelector("img");n&&(r(),h.addBtnImageStory(n))}}))}},{css:'div > div > article > div > div:nth-child(2) div[role="button"]',is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)t.dataset.sfSkip>0||(t.dataset.sfSkip="1",h.addDlBtn(t.parentNode,"",t))}},{css:'div > div > article > div > div:nth-child(1) div[role="button"]',is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)t.dataset.sfSkip>0||t.querySelector("ul > li")||(t.dataset.sfSkip="1",h.addDlBtn(t.parentNode,"",t))}},{css:'div > div > article > div > div:nth-child(1) div[style*="height: calc(100% + 1px); position: absolute; width: 100%;"] > div',is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)t.dataset.sfSkip>0||t.querySelector("ul > li")||(t.dataset.sfSkip="1",h.addDlBtn(t.parentNode,"",t))}},{css:".Embed > .Content.EmbedFrame > .EmbedVideo",is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)if(!(t.dataset.sfSkip>0)){t.dataset.sfSkip="1";var n=Object(k.a)(t,".Embed");n&&(n.dataset.sfSkip="1",h.addDlBtn(n,"embed",n))}}},{css:".Embed > .Content.EmbedFrame.EmbedFrameWithSidecar > .EmbedSidecar > div > div > div + div > div > div > div > ul > li > div:nth-child(1) > div:nth-child(1)",is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)if(!(t.dataset.sfSkip>0)){t.dataset.sfSkip="1";var n=Object(k.a)(t,".Embed");if(n&&n.dataset.sfSkip>0){var a=document.querySelector(".Header");a&&w(a)}h.addDlBtn(t.parentNode,"",t)}}},{css:".Embed",is:"added",callback:function(e){for(var t,r=0;t=e.added[r];r++)t.dataset.sfSkip>0||(t.dataset.sfSkip="1",h.addDlBtn(t,"embed",t))}},{css:".".concat(f.a.onRemoveClassName),is:"removed",callback:function(e){for(var t,r=0;t=e.removed[r];r++)f.a.onRemoveListener(t)}}]})}}};function g(e){return e.stopPropagation(),o.a.isFirefox?(e.preventDefault(),function(e,t,r){return t.includes("mp4"),Object(C.a)({action:"ffInstagramDownloadMedia",downloadFileUrl:e,filename:t})}(this.href,this.download)):r.downloadOnClick(e,void 0,{el:this})}function w(e){for(var t,r=e.querySelectorAll("."+h.dlBtnClassName),n=0;t=r[n];n++)t.classList.remove(f.a.onRemoveClassName),t.parentNode.removeChild(t)}}),(function(){return!Object(d.a)()||!!/\/\/[^\/]+\.[^\/]+\/p\//.test(location.href)}))}});