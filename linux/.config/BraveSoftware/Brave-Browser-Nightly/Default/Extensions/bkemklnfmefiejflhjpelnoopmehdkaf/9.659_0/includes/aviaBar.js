!function(e){function t(t){for(var a,o,c=t[0],s=t[1],l=t[2],d=0,p=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,c=1;c<r.length;c++){var s=r[c];0!==n[s]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={1:0},i=[];function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.savefromContentScriptWebpackJsonp=window.savefromContentScriptWebpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;i.push([106,0]),r()}({106:function(e,t,r){"use strict";r.r(t);var a=r(6),n=r(18),i=r(10),o=r(5),c=r(14),s=r(15),l=r(8),u=r(49),d=r(0),p=r(34),f=r(17);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return Object(s.a)(this,r)}}Object(f.a)("aviaBar",(function(){!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);var s={sendMessage:function(e,t){d.a.sendMessage(e,t)},getUILanguage:function(){if("undefined"!=typeof chrome&&chrome.i18n&&chrome.i18n.getUILanguage)return chrome.i18n.getUILanguage()}},l=function(e){Object(c.a)(r,e);var t=h(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).name="CustomError",a}return r}(Object(u.a)(Error)),p={extend:function(){for(var e=arguments[0],t=1,r=arguments.length;t<r;t++){var a=arguments[t];for(var n in a)void 0!==a[n]&&(e[n]=a[n])}return e},param:function(e){if("string"==typeof e)return e;var t=[];for(var r in e)e.hasOwnProperty(r)&&(void 0!==e[r]&&null!==e[r]||(e[r]=""),t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r])));return t.join("&")}};(function(){p.create=function(t,r){var a,n;for(var i in a="object"!=typeof t?document.createElement(t):t,r){var o=r[i];(n=e[i])?n(a,o):a[i]=o}return a};var e={text:function(e,t){e.textContent=t},data:function(e,t){for(var r in t)e.dataset[r]=t[r]},class:function(e,t){if(Array.isArray(t))for(var r=0,a=t.length;r<a;r++)e.classList.add(t[r]);else e.setAttribute("class",t)},style:function(e,t){if("object"==typeof t)for(var r in t){var a=r;"float"===a&&(a="cssFloat");var n=t[r];if(Array.isArray(n))for(var i=0,o=n.length;i<o;i++)e.style[a]=n[i];else e.style[a]=n}else e.setAttribute("style",t)},append:function(e,t){Array.isArray(t)||(t=[t]);for(var r=0,a=t.length;r<a;r++){var n=t[r];(n||0===n)&&("object"!=typeof n&&(n=document.createTextNode(n)),e.appendChild(n))}},on:function(e,t){"object"!=typeof t[0]&&(t=[t]);for(var r=0,a=t.length;r<a;r++){var n=t[r];Array.isArray(n)&&p.on(e,n[0],n[1],n[2])}},onCreate:function(e,t){t.call(e,e)}}})(),p.on=function(e,t,r,a){e.addEventListener(t,r,a)},p.off=function(e,t,r,a){e.removeEventListener(t,r,a)},p.jsLink=function(e,t){var r=e.href,a=function(e){e.preventDefault(),e.stopPropagation(),window.open(r),t&&t()};return e.addEventListener("click",(function(e){a(e)})),e.addEventListener("mouseup",(function(e){(1===e.button||2===e.which)&&a(e)})),e},p.parseUrl=function(e,t){var r,a=null;r=(t=t||{}).paramsRe?t.paramsRe:/[^?]+\?(.+)/;var n=!t.params&&r.exec(e);a=n?n[1]:e;for(var i=t.sep||"&",o=a.split(i),c={},s=0,l=o.length;s<l;s++){var u=o[s].split("="),d=u[0],p=u[1]||"";if(t.noDecode)c[d]=p;else{try{d=decodeURIComponent(d)}catch(e){d=unescape(d)}try{c[d]=decodeURIComponent(p)}catch(e){c[d]=unescape(p)}}}return c},p.debounce=function(e,t){var r=null;return function(){var a=this,n=arguments;clearTimeout(r),r=setTimeout((function(){e.apply(a,n)}),t)}},p.getPageScript=function(e,t){t&&!Array.isArray(t)&&(t=[t]);var r=[];return e.replace(/<script(?:|\s[^>]+[^\/])>/g,(function(a,n){n+=a.length;var i=e.indexOf("<\/script>",n);if(-1!==i){var o=e.substr(n,i-n);t?t.every((function(e){return e.test(o)}))&&r.push(o):r.push(o)}})),r},p.findJson=function(e,t){t&&!Array.isArray(t)&&(t=[t]);for(var r,a=[],n={"{":0,"[":0},i={"}":"{","]":"["},o=/[{}\]\[":0-9.,-]/,c=/[\r\n\s\t]/,s="",l=0;r=e[l];l++)if('"'!==r)o.test(r)?(s+=r,"{"===r||"["===r?(n["{"]||n["["]||(s=r),n[r]++):"}"!==r&&"]"!==r||(n[i[r]]--,n["{"]||n["["]||a.push(s))):"t"===r&&"true"===e.substr(l,4)?(s+="true",l+=3):"f"===r&&"false"===e.substr(l,5)?(s+="false",l+=4):"n"===r&&"null"===e.substr(l,4)?(s+="null",l+=3):c.test(r)||(n["{"]=0,n["["]=0,s="");else{for(var u=l;-1!==u&&(u===l||"\\"===e[u-1]);)u=e.indexOf('"',u+1);-1===u&&(u=e.length-1),s+=e.substr(l,u-l+1),l=u}for(var d,p=[],f=function(e,r){if("{}"!==e&&"[]"!==e)try{t?t.every((function(t){return t.test(e)}))&&p.push(JSON.parse(e)):p.push(JSON.parse(e))}catch(e){}},h=0;d=a[h];h++)f(d);return p},p.style2Text=function(e,t){var r=[];Array.isArray(e)||(e=[e]),t&&!Array.isArray(t)&&(t=[t]);var a=function(e,t){var r=[];for(var a in t){var n=t[a];"cssFloat"===a&&(a="float");var i=a.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}));r.push(i+":"+n)}return r.length?[e.join(","),"{",r.join(";"),"}"].join(""):""},n=function(e,r){if(Array.isArray(r)||(r=[r]),t){var a=[],n=e.join||""===e.join?e.join:" ";t.forEach((function(e){r.forEach((function(t){a.push(e+n+t)}))})),r=a}return r};return e.forEach((function(e){var i=null,o=e.media,c=e.selector,s=e.style,l=e.append;if(o&&l)r.push([o,"{",p.style2Text(l,t),"}"].join(""));else if(c||s)i=n(e,c),r.push(a(i,s)),l&&r.push(p.style2Text(l,i));else for(var u in e)-1===["append","join"].indexOf(u)&&(c=u,(l=(s=e[u]).append)&&delete s.append,i=n(e,c),r.push(a(i,s)),l&&r.push(p.style2Text(l,i)))})),r.join("")},p.styleReset={animation:"none 0s ease 0s 1 normal none running",backfaceVisibility:"visible",background:"transparent none repeat 0 0 / auto auto padding-box border-box scroll",border:"medium none currentColor",borderCollapse:"separate",borderImage:"none",borderRadius:"0",borderSpacing:"0",bottom:"auto",boxShadow:"none",boxSizing:"content-box",captionSide:"top",clear:"none",clip:"auto",color:"inherit",columns:"auto",columnCount:"auto",columnFill:"balance",columnGap:"normal",columnRule:"medium none currentColor",columnSpan:"1",columnWidth:"auto",content:"normal",counterIncrement:"none",counterReset:"none",cursor:"auto",direction:"ltr",display:"inline",emptyCells:"show",float:"none",font:"normal normal normal normal medium/normal inherit",height:"auto",hyphens:"none",left:"auto",letterSpacing:"normal",listStyle:"disc outside none",margin:"0",maxHeight:"none",maxWidth:"none",minHeight:"0",minWidth:"0",opacity:"1",orphans:"0",outline:"medium none invert",overflow:"visible",overflowX:"visible",overflowY:"visible",padding:"0",pageBreakAfter:"auto",pageBreakBefore:"auto",pageBreakInside:"auto",perspective:"none",perspectiveOrigin:"50% 50%",position:"static",right:"auto",tabSize:"8",tableLayout:"auto",textAlign:"inherit",textAlignLast:"auto",textDecoration:"none solid currentColor",textIndent:"0",textShadow:"none",textTransform:"none",top:"auto",transform:"none",transformOrigin:"50% 50% 0",transformStyle:"flat",transition:"none 0s ease 0s",unicodeBidi:"normal",verticalAlign:"baseline",visibility:"visible",whiteSpace:"normal",widows:"0",width:"auto",wordSpacing:"normal",zIndex:"auto",all:"initial"},p.bridge=function(e){e.args=e.args||[],void 0===e.timeout&&(e.timeout=300);var t="sf-bridge-"+parseInt(1e3*Math.random())+"-"+Date.now();window.addEventListener("sf-bridge-"+t,(function r(a){var n;window.removeEventListener("sf-bridge-"+t,r),n=a.detail?JSON.parse(a.detail):void 0,e.cb(n)}));var r='(function(a,b,c,d){const e=document.getElementById(c);e&&e.parentNode.removeChild(e);let f=!1;const g=function(a){if(!f){f=!0;const b=new CustomEvent("sf-bridge-"+c,{detail:JSON.stringify(a)});window.dispatchEvent(b)}};d&&setTimeout(function(){g()},d),b.push(g),a.apply(null,b)})('+[e.func.toString(),JSON.stringify(e.args),JSON.stringify(t),parseInt(e.timeout)].join(",")+");",a=document.createElement("script");a.id=t,a.textContent=r,document.body.appendChild(a)},p.mutationWatcher={getMutationObserver:function(){var e=null;return"undefined"!=typeof MutationObserver?e=MutationObserver:"undefined"!=typeof WebKitMutationObserver?e=WebKitMutationObserver:"undefined"!=typeof MozMutationObserver?e=MozMutationObserver:"undefined"!=typeof JsMutationObserver&&(e=JsMutationObserver),e},isAvailable:function(){return!!this.getMutationObserver()},disconnect:function(e){e.observer.disconnect()},connect:function(e){e.observer.observe(e.target,e.config)},joinMutations:function(e){for(var t,r,a,n,i,o,c=[],s=[],l={};a=e.shift();){for(-1===(o=s.indexOf(a.target))&&(l[o=s.push(a.target)-1]={target:a.target,added:[],removed:[]}),t=l[o],r=void 0,n=0;i=a.addedNodes[n];n++)1===i.nodeType&&(t.added.push(i),r=!0);for(n=0;i=a.removedNodes[n];n++)1===i.nodeType&&(t.removed.push(i),r=!0);void 0!==r&&void 0===t.inList&&(t.inList=!0,c.push(t))}return c},isMatched:null,prepareMatched:function(){if(!this.isMatched){var e=document.createElement("div");"function"==typeof e.matches?this.isMatched=function(e,t){return e.matches(t)}:"function"==typeof e.matchesSelector?this.isMatched=function(e,t){return e.matchesSelector(t)}:"function"==typeof e.webkitMatchesSelector?this.isMatched=function(e,t){return e.webkitMatchesSelector(t)}:"function"==typeof e.mozMatchesSelector?this.isMatched=function(e,t){return e.mozMatchesSelector(t)}:"function"==typeof e.oMatchesSelector?this.isMatched=function(e,t){return e.oMatchesSelector(t)}:"function"==typeof e.msMatchesSelector&&(this.isMatched=function(e,t){return e.msMatchesSelector(t)}),e=null}},match:function(e,t,r){var a,n,i,o,c=this,s=e.queries,l=!1;return["added","removed"].forEach((function(e){var u=r[e];for(o=0;a=u[o];o++)for(n=0;i=s[n];n++)if(void 0===i.is||i.is===e){var d=t[n][e];!0===c.isMatched(a,i.css)?d.push(a):d.push.apply(d,a.querySelectorAll(i.css)),!1===l&&(l=void 0!==d[0])}})),l},filterTarget:function(e,t){var r,a;for(r=0;a=e[r];r++)if(!0===this.isMatched(t,a.css))return!0;return!1},run:function(e){var t=this,r={config:{childList:!0,subtree:!0},target:document.body,filterTarget:[]};p.extend(r,e),r._disconnect=function(){return t.disconnect(r)},r._connect=function(){return t.connect(r)},r._match=function(e,a){return t.match(r,e,a)};for(var a=[],n=0;n<r.queries.length;n++)a.push({added:[],removed:[]});a=JSON.stringify(a),this.prepareMatched();var i=this.getMutationObserver();return r.observer=new i((function(e){var n=t.joinMutations(e);if(0!==n.length){for(var i,o=!1,c=JSON.parse(a);i=n.shift();)!1===t.filterTarget(r.filterTarget,i.target)&&!0===r._match(c,i)&&(o=!0);!0===o&&r.callback(c)}})),r.start=function(){r._disconnect(),r._connect();var e=!1,t=JSON.parse(a),n={added:[r.target],removed:[]};r._match(t,n)&&(e=!0),!0===e&&r.callback(t)},r.stop=function(){r._disconnect()},r.start(),r}},p.request=function(e){"object"!=typeof e&&(e={url:e});var t={0:200,1223:204};return new Promise((function(r,a){var n=new XMLHttpRequest;n.open("GET",e.url,!0),n.onload=function(){var e=t[n.status]||n.status;(e>=200&&e<300||304===e)&&"string"==typeof n.responseText?r({body:n.responseText}):a(new l(n.status+" "+n.statusText))},n.onerror=n.onabort=function(){a(new l(n.status+" "+n.statusText))},n.send()}))},p.tbrExists=function(){return!!document.body.parentNode.dataset.travelBar},p.tbrSetGlobal=function(){return document.body.parentNode.dataset.travelBar="1"},p.isFrame=function(){return document.defaultView.self!==document.defaultView.top},p.isDeny=function(){return/^https?:\/\/(?:[^/]+\.)?(aviasales|search\.hotellook)\.[a-z.]{2,}(?:|\/.*)$/.test(document.referrer)},p.stripStack=function(e){var t=/([^\s(]+\/)([^\/\s]+\.js)/.exec(e);if(t){var r=t[1],a=t[2],n=a;e=(n=(n=(n=n.replace(".lite","l")).replace(".min","m")).replace("travelBar","t"))+":"+e.split(r+a).join("js")}return e.replace(/\r/g,"").replace(/\s*\n\s*/g,">").replace(/\s{2,}/g," ").replace(/https?:\/(?:\/[^\/]+)+\/([^\/]+\.js)/g,"$1")};var f={ru:{weekdaysShort:"Вс_Пн_Вт_Ср_Чт_Пт_Сб".split("_"),months:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),monthsCal:"январе_феврале_марте_апреле_мае_июне_июле_августе_сентябре_октябре_ноябре_декабре".split("_"),monthsShort:"янв._февр._мар._апр._мая_июн._июл._авг._сент._окт._нояб._дек.".split("_"),dateFormat:"d MMMM, E",dateFormatNoWeekdays:"d MMMM",timeFormat:"H:mm",dateTimeFormat:"d MMM, H:mm",dateIntervalFormat:"d — d MMMM",dateMonthIntervalFormat:"d MMM — d MMM"},en:{weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),dateFormat:"MMMM d, E",dateFormatNoWeekdays:"MMMM d",timeFormat:"h:mm a",dateTimeFormat:"MMM d, h:mm a",dateIntervalFormat:"MMMM d — d",dateMonthIntervalFormat:"d MMM — d MMM"},de:{weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),months:"Jänner_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),dateFormat:"E, d. MMMM",dateFormatNoWeekdays:"d. MMMM",timeFormat:"H:mm",dateTimeFormat:"d. MMM, H:mm",dateIntervalFormat:"d. — d. MMMM",dateMonthIntervalFormat:"d. MMM — d. MMM"}},m={USD:{symbol:"$",standard:"¤#,##0.00",details:{symbolRight:!1,symbolSep:"",toFixed:2,round:!1,group:",",decimal:"."}},EUR:{symbol:"€",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!1,group:".",decimal:","}},RUB:{symbol:"₽",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!0,group:" ",decimal:","},getNode:function(){var e=document.querySelector("link.sf-price-font");return e||(e=p.create("link",{class:"sf-price-font",href:"https://fonts.googleapis.com/css?family=PT+Sans:bold",rel:"stylesheet",type:"text/css"}),document.head.appendChild(e)),p.create("span",{text:this.symbol,style:{fontFamily:'"PT Sans", Arial, serif'}})}},BYR:{symbol:"р.",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!0,group:" ",decimal:","}},BYN:{symbol:"р.",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!0,group:" ",decimal:","}},KZT:{symbol:"T",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!0,group:" ",decimal:","}},UAH:{symbol:"₴",standard:"#,##0.00 ¤",details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!0,group:" ",decimal:","}},THB:{symbol:"฿",details:{symbolRight:!1,symbolSep:"",toFixed:2,round:!0,group:",",decimal:"."}}},y=function(e,t,r,a){var n,i={};return e.replace(/([a-zA-Z]+)/g,(function(e,o){var c=null;switch(a?i[o]?c=a:(i[o]=!0,c=r):c=r,o){case"d":return c.getUTCDate();case"MMMM":return t.months[c.getUTCMonth()];case"MMM":return t.monthsShort[c.getUTCMonth()];case"h":return n=c.getUTCHours(),(n%=12)||(n=12),n;case"H":return c.getUTCHours();case"mm":var s=c.getUTCMinutes();return s<10&&(s="0"+s),s;case"a":var l="AM";return(n=c.getUTCHours())>=12&&(l="PM"),l;case"E":return t.weekdaysShort[c.getUTCDay()]}}))},g=function(e){var t=e;return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/.test(e)&&(t=e+"Z"),new Date(t)};p.getCityName=function(e){return k.main.avia.getCityName(e)},p.getDate=function(e,t,r){var a=g(e),n=f[k.language.lang]||f.en,i=n.dateFormat;return t&&(i=n.dateFormatNoWeekdays),r&&(i="d"),i=y(i,n,a)},p.getCalMonth=function(e){var t=g(e),r=f[k.language.lang]||f.en;return(r.monthsCal||r.months)[t.getUTCMonth()]},p.getDateTime=function(e){var t=g(e),r=f[k.language.lang]||f.en,a=r.dateTimeFormat;return a=y(a,r,t)},p.getDateInterval=function(e,t){var r=g(e),a=g(t),n=f[k.language.lang]||f.en,i=null;return i=r.getUTCFullYear()===a.getUTCFullYear()&&r.getUTCMonth()===a.getUTCMonth()?n.dateIntervalFormat:n.dateMonthIntervalFormat,i=y(i,n,r,a)},p.getPriceNode=function(e,t,r){var a=function(e,t){var r=m[e];r||(r={symbol:e,details:{symbolRight:!0,symbolSep:" ",toFixed:2,round:!1,group:",",decimal:"."}});for(var a=r.details,n=(t=a.round?Math.round(t):t.toFixed(a.toFixed)).toString().split("."),i=n[1],o="",c=0;c<a.toFixed;c++)o+="0";i===o&&(i="");var s=n[0];","===(s=(s=(s=s.split("").reverse().join("")).replace(/(\d{3})/g,"$1,")).split("").reverse().join(""))[0]&&(s=s.substr(1)),n=[s=(s=s.split(",")).join(a.group)],i&&n.push(i);var l=n.join(a.decimal),u=[l];return a.symbolRight?(a.symbolSep&&u.push(a.symbolSep),u.push(r.symbol)):(a.symbolSep&&u.unshift(a.symbolSep),u.unshift(r.symbol)),{string:u.join(""),value:l,cultureCcy:r}}(e,t),n=a.cultureCcy,i=n.details,o=function(){return!r&&n.getNode?n.getNode():n.symbol},c=i.symbolSep;" "===c&&(c=String.fromCharCode(160));var s=[a.value];return i.symbolRight?(c&&s.push(c),s.push(o())):(c&&s.unshift(c),s.unshift(o())),p.create(document.createDocumentFragment(),{append:s})},p.waitResponse=function(e,t,r){return new Promise((function(a){var n=p.waitResponse;!function t(i){if(k.log("waitResponse retry",i),n.timer&&clearTimeout(n.timer),!(i<0))return r((function(r){r?n.timer=setTimeout((function(){return n.timer=null,t(--i)}),e):(k.log("waitResponse get response!"),a())}));k.error("waitResponse response is empty!"),a()}(t)}))},p.getParamsFromPage=function(e){return new Promise((function(t){var r=!1;"object"!=typeof e||Array.isArray(e)||(r=Object.keys(e),e=r.map((function(t){return e[t]}))),p.bridge({args:[e],func:'function(a,b){const c=[];return a.forEach(function(a){let b=a,d=null;"string"!=typeof b&&(b=a.path,d=a.args);const e=b.split(".");let f,g,h=window;for(;e.length;){f=h,g=e.shift();try{h=f[g]}catch(a){h=null;break}}if(d)try{h=f[g].apply(f,d)}catch(a){h=null}c.push(h)}),b(c)}',cb:function(e){var a=e;return r&&(a={},e&&e.forEach((function(e,t){a[r[t]]=e}))),t(a)}})}))},p.validatorMap={origin:"validateIataCode",destination:"validateIataCode",pickUpLocationId:"validateIataCode",dropOffLocationId:"validateIataCode",dateStart:"validateDate",dateEnd:"validateDate",dateIn:"validateDate",dateOut:"validateDate",pickUpDate:"validateDateTime",dropOffDate:"validateDateTime",currency:"validateCcy",adults:"validateAdults",price:"validatePrice",oneDayPrice:"validatePrice",minPriceIn:"validatePrice",minPriceOut:"validatePrice",minPriceBoth:"validatePrice",query:"validateQuery",dayCount:"validateNumber",driverAge:"validateNumber"},p.validate=function(e,t){var r=p.validatorMap[e];return r?t=p[r](t):/^extra\./.test(e)||k.error("validator is not found!",e,t),t},p.validateIataCode=function(e){return/^[A-Z]{3}$/.test(e)?e.toUpperCase():(k.error("City validation error!",e),null)},p.validateDate=function(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)||/^\d{4}-\d{2}$/.test(e)?e:(k.error("Date validation error!",e),null)},p.validateDateTime=function(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(e)||(k.error("DateTime validation error!",e),e=null),e},p.validateCcy=function(e){return/^[A-Z]{3}$/.test(e)?e:(k.error("Currency validation error!",e),null)},p.validateNumber=function(e){var t=parseInt(e);return isNaN(t)?(k.error("Number validation error!",e),null):t},p.validateAdults=function(e){var t=p.validateNumber(e);return!t||t<1?(k.error("Adults validation error!",e),null):t},p.validateQuery=function(e){return Array.isArray(e)&&e.length?e:(k.error("Query validation error!",e),null)},p.validatePrice=function(e){return/^\d+(\.\d+)?$/.test(e)?e:(k.error("Price validation error!",e),null)},p.preparePrice=function(e){if(!e)return k.log("Price is empty!",e),null;var t=(e=(e=(e=e.replace(",",".")).replace(/[^\d.]/g,"")).replace(/\.(\d{3,})/,"$1")).match(/(\d+)(\.\d+)?/);return t?(e=t[1],t[2]&&(e+=t[2]),e=parseFloat(e),isNaN(e)?(k.log("Price is NaN!",e),null):e):(k.log("Price is empty 2!",e),null)},p.reFormatDate=function(e,t,r){var a=null,n=t.exec(e);return n&&(a=r.replace(/\$(\d)/g,(function(e,t){return n[t]}))),a},p.normalizeDate=function(e,t,r,a){if(a=a||{},!e&&t&&r){var n,i=new Date,o=i.getFullYear(),c=i.getDate(),s=i.getMonth()+1;n=a.monthMap&&void 0!==a.monthMap[t]?a.monthMap[t]:parseInt(t);var l=parseInt(r);return(s>n||s===n&&l<c)&&(o+=1),n<10&&(n="0"+n),l<10&&(l="0"+l),p.validateDate([o,n,l].join("-"))}return null};var v={USD:"$",EUR:"€",AZN:"₼",GBP:"£",CNY:"¥",GEL:"₾",TRY:"₺",RUB:"₽",UAH:"₴",KZT:"₸",PLN:"zł"},b=null;p.findCurrency=function(e){if(!b){var t=[];for(var r in v)t.push(r,v[r]);b=new RegExp("("+t.join("|").replace(/\$/,"\\$&")+")")}var a=b.exec(e);if(a)for(var n in v)if(n===a[1]||v[n]===a[1])return n;return null},p.getDateAfterDays=function(e,t){var r=new Date(e).getTime(),a=new Date(r+=24*t*60*60*1e3),n=a.getUTCFullYear(),i=a.getUTCMonth()+1,o=a.getUTCDate();return i<10&&(i="0"+i),o<10&&(o="0"+o),p.validateDate([n,i,o].join("-"))},p.getCurrentDate=function(){var e=new Date,t=e.getUTCFullYear(),r=e.getUTCMonth()+1;r<10&&(r="0"+r);var a=e.getUTCDate();return a<10&&(a="0"+a),[t,r,a].join("-")},p.convertTime12to24=function(e){var t=/(\d+):(\d+)\s+(PM|AM)/.exec(e);if(t)return t[1]=parseInt(t[1]),t[2]=parseInt(t[2]),"PM"===t[3]&&t[1]<12&&(t[1]+=12),"AM"===t[3]&&12===t[1]&&(t[1]-=12),t[1]<10&&(t[1]="0"+t[1]),t[2]<10&&(t[2]="0"+t[2]),t[1]+":"+t[2]};var _=p,P={appName:"tbr",appId:"tbr.mono",version:"20200406.083811",language:null,appInfo:{},errorMap:{LOW_PRICE_IS_NOT_FOUND:10,REQUEST_ABORTED:11,CCY_NOT_SUPPORT:42,AVIA_BACK_FAIL:110,HOTEL_BACK_FAIL:120,CARS_BACK_FAIL:160},main:{},error:function(){if(P.appInfo.debug){var e=["tbr"];e.push.apply(e,arguments),console.error.apply(console,e)}},log:function(){if(P.appInfo.debug){var e=["tbr"];e.push.apply(e,arguments),console.log.apply(console,e)}},emit:function(e){if(P.appInfo[e]){var t=[].slice.call(arguments,1);try{s.sendMessage({action:"tbrEvent",type:e,data:t})}catch(e){P.error("Emit error",e)}}},trackError:function(e){}},k=P,x=function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},C=function(e){if("<all_urls>"===e)return"^https?:\\/\\/.+$";var t=/(\*|http|https|file|ftp):\/\/([^\/]+)(?:\/(.*))?/.exec(e);if(!t)throw new Error("Invalid url-pattern");var r=t[1];"*"===r&&(r="https?");var a=t[2],n=["^",r,":\\/\\/",a="*"===a?".+":(a=(a=x(a)).replace(/^\\\*\\\./,"(?:[^/]+\\.)?")).replace(/\\\.\\\*$/g,"\\.[a-z\\.]{2,}")],i=t[3];return i?"*"===i?(i="(?:|/.*)",n.push(i),n.push("$")):i&&(i=(i=x(i="/"+i)).replace(/\\\*/g,".*"),n.push(i),n.push("$")):n.push("$"),n.join("")},w={"*://*.ozon.travel/*":["ozon_travel","OZN"],"*://*.onetwotrip.com/*":["onetwotrip_com","OTT"],"*://*.onetravel.com/*":["onetravel_com","OTR"],"*://*.aeroflot.ru/*":["aeroflot_ru","AFL"],"*://*.momondo.*/*":["momondo_com","MMD"],"*://*.anywayanyday.com/*":["anywayanyday_com","AWA"],"*://*.svyaznoy.travel/*":["svyaznoy_travel","SVZ"],"*://avia.tickets.ru/*":["tickets_ru","ATK"],"*://*.s7.ru/*":["s7_ru","SSV"],"*://*.kupibilet.ru/*":["kupibilet_ru","KPB"],"*://*.trip.ru/*":["trip_ru","TRP.R"],"*://*.trip.com/*":["trip_com","TRP.C"],"*://*.ctrip.com/*":["ctrip_com","CTR"],"*://*.tutu.ru/*":["tutu_ru","TTR"],"*://*.uralairlines.ru/*":["uralairlines_ru","URA"],"*://*.flyredwings.com/*":["flyredwings_com","FRW"],"*://*.airastana.com/*":["airastana_com","AAS"],"*://*.airmoldova.md/*":["airmoldova_md","AMD"],"*://*.sindbad.ru/*":["sindbad_ru","SBD"],"*://*.aviakassa.ru/*":["aviakassa_ru","AKS.R"],"*://*.aviakassa.com/*":["aviakassa_ru","AKS.C"],"*://*.biletix.ru/*":["biletix_ru","BLX"],"*://*.utair.ru/*":["utair_ru","UTR"],"*://*.kayak.*/*":["kayak_com","KYK"],"*://*.orbitz.com/*":["travelocity_com","OBZ"],"*://*.travelocity.com/*":["travelocity_com","TCC.C"],"*://*.travelocity.ca/*":["travelocity_com","TCC.CA"],"*://*.expedia.*/*":["travelocity_com","EXD"],"*://*.expedia-cn.com/*":["travelocity_com","EXP"],"*://*.priceline.com/*":["priceline_com","PRL"],"*://*.airasia.com/*":["airasia_com","ASI"],"*://*.ryanair.com/*":["ryanair_com","RAR"],"*://booking.etihad.com/*":["etihad_com","ETH"],"*://*.booking.*/*":["booking_com","BKG"],"*://*.agoda.*/*":["agoda_com","AGD"],"*://*.hotels.com/*":["hotels_com","HTL"],"*://*.ostrovok.ru/*":["ostrovok_ru","OVK"],"*://*.travel.ru/*":["travel_ru","TVL"],"*://*.oktogo.ru/*":["oktogo_ru","OKT"],"*://*.roomguru.ru/*":["roomguru_ru","RGR"],"*://*.tripadvisor.ru/*":["tripadvisor_ru","TAD"],"*://*.hilton.ru/*":["hilton_com","HTN.R"],"*://*.hilton.com/*":["hilton_com","HTN.C"],"*://*.marriott.com/*":["marriott_com","MTT"],"*://*.hostelworld.com/*":["hostelworld_com","TWD"],"*://*.tiket.com/*":["tiket_com","TKT"],"*://*.hotelsclick.com/*":["hotelsclick_com","HCL"],"*://*.hotelscombined.com/*":["hotelscombined_com","TCB"],"*://*.avis.*/*":["avis_com","AVS"],"*://*.avisrussia.ru/*":["avis_com","AVS"],"*://*.budget.com/*":["budget_com","BDG"],"*://*.wizzair.com/*":["wizzair_com","WZA"],"*://*.emirates.com/*":["emirates_com","EMR"],"*://*.delta.com/*":["delta_com","DLT"],"*://*.hertz.com/*":["hertz_com","HRZ"],"*://*.europcar.com/*":["europcar_com","ERC"],"*://*.skyscanner.*/*":["skyscanner_com","SSC"]},S=w,T={setType:function(e,t){t.page.setType(e)},setParam:function(e,t,r){r.page.set(e,t)},getParam:function(e,t){return t.page.get(e)},setPrice:function(e,t,r){r.page.setPrice(e,t)},pageClear:function(e){e.page.clear()},preparePrice:function(e){return _.preparePrice(e)},getParamsFromPage:function(e){return _.getParamsFromPage(e)},locationCheck:function(e){return Array.isArray(e)||(e=[e]),function(t){return e.some((function(e){return e.test(t)}))}},domWatcher:function(e){return e},details:function(e){var t={};for(var r in e)t[r]="locationCheck"===r?T.locationCheck(e[r]):"formWatcher"===r||"priceWatcher"===r?T.domWatcher(e[r]):e[r];return t},parseUrl:function(e,t,r){return e&&"string"!=typeof e&&(r=t,t=e,e=null),_.parseUrl(e||location.href,{sep:r,paramsRe:t})},matchUrl:function(e){return e.exec(location.href)},testUrl:function(e){return e.test(location.href)},dom:function(e){var t=function(e){var t=this;this.style=function(r,a){return e.forEach((function(e){e.style[r]=a})),t},this.remove=function(r){return(e=e.map((function(e){return e.cloneNode(!0)}))).forEach((function(e){[].slice.call(e.querySelectorAll(r)).forEach((function(e){e.parentNode.removeChild(e)}))})),t},this.filter=function(r){return e.filter(r),t},this.getAll=function(r){return e=[].slice.call(document.querySelectorAll(r)),t},this.get=function(r){e.splice(0);var a=document.querySelector(r);return a&&e.push(a),t},this.wrap=function(r){return r.nodeType?e=[r]:r.length&&(e=[].slice.call(r)),t},this.find=function(r){var a=[];return e.some((function(e){var t=e.querySelector(r);return t&&a.push(t),!0})),e=a,t},this.findAll=function(r){var a=[];return e.some((function(e){return a=[].slice.call(e.querySelectorAll(r)),!0})),e=a,t},this.forEach=function(t){e.forEach(t)},this.some=function(t){return e.some(t)},this.value=function(){var t="";return e.some((function(e){return t=e.value,!0})),t},this.childText=function(){var t=[];return e.forEach((function(e){for(var r,a=0;r=e.childNodes[a];)a++,3===r.nodeType&&t.push(r.textContent)})),t},this.html=function(){var t="";return e.some((function(e){return t=e.innerHTML,!0})),t},this.text=function(){var t="";return e.some((function(e){return t=e.textContent,!0})),t},this.len=function(){return e.length},this.data=function(t){var r;return e.some((function(e){return r=e.dataset[t],!0})),r},this.prop=function(t){var r;return e.some((function(e){return r=e[t],!0})),r},this.attr=function(t){var r;return e.some((function(e){return r=e.getAttribute(t),!0})),r},this.css=function(t){var r,a;return e.some((function(e){return(a=window.getComputedStyle(e))&&void 0!==(r=a.getPropertyValue(t)||a[t])&&(r=""+r),!0})),r},this.end=function(){return e}};return"string"==typeof e?new t([]).get(e):e?new t([]).wrap(e):new t([])},string:function(e){return new function(e){var t=this;"string"!=typeof e&&(e=""),this.replace=function(r,a){return e=e.replace(r,a),t},this.slice=function(r,a){return e=e.slice(r,a),t},this.substr=function(r,a){return e=e.substr(r,a),t},this.trim=function(){return e=e.trim(),t},this.toUpperCase=function(){return e=e.toUpperCase(),t},this.toLowerCase=function(){return e=e.toLowerCase(),t},this.charAt=function(r){return e=e.charAt(r),t},this.search=function(t){return e.search(t)},this.match=function(t){return e.match(t)},this.indexOf=function(t,r){return e.indexOf.apply(e,arguments)},this.lastIndexOf=function(t,r){return e.lastIndexOf.apply(e,arguments)},this.split=function(t,r){return e.split(t,r)},this.charCodeAt=function(t){return e.charCodeAt(t)},this.end=function(){return e},this.len=function(){return e.length}}(e)},array:function(e){return new function(e){var t=this;Array.isArray(e)||(e=null),this.slice=function(r,a){return e&&(e=e.slice(r,a)),t},this.splice=function(r,a){return e&&(e=e.splice.apply(e,arguments)),t},this.filter=function(r){return e&&(e=e.filter(r)),t},this.reverse=function(){return e&&e.reverse(),t},this.sort=function(r){return e&&e.sort(r),t},this.concat=function(){return e&&(e=e.concat.apply(e,arguments)),t},this.map=function(r){return e&&(e=e.map(r)),t},this.pop=function(){var t=null;return e&&(t=e.pop()),t},this.push=function(t){var r=null;return e&&(r=e.push.apply(e,arguments)),r},this.shift=function(){var t=null;return e&&(t=e.shift()),t},this.unshift=function(t){var r=null;return e&&(r=e.unshift.apply(e,arguments)),r},this.forEach=function(t){e&&e.forEach(t)},this.some=function(t){var r=null;return e&&(r=e.some(t)),r},this.every=function(t){var r=null;return e&&(r=e.every(t)),r},this.join=function(t){var r=null;return e&&(r=e.join(t)),r},this.indexOf=function(t,r){var a=null;return e&&(a=e.indexOf.apply(e,arguments)),a},this.lastIndexOf=function(t,r){var a=null;return e&&(a=e.lastIndexOf.apply(e,arguments)),a},this.get=function(t){var r=null;return Array.isArray(e)&&(r=e[t]),r},this.len=function(){var t=null;return e&&(t=e.length),t},this.end=function(){return e}}(e)},object:function(e){return new function(e){"object"!=typeof e&&(e=null),this.keys=function(){if(e&&"object"==typeof e)return Object.keys(e)},this.prop=function(t,r){if(e&&"object"==typeof e)return void 0!==r?(e[t]=r,this):e[t]},this.end=function(){return e}}(e)},matchTemplate:function(e,t,r){return _.reFormatDate(e,t,r)},match:function(e,t){var r=null;return"string"==typeof e&&(r=e.match(t)),r},exec:function(e,t){return t.exec(e)},test:function(e,t){return t.test(e)},normalizeDate:function(e,t,r,a){return _.normalizeDate(e,t,r,a)},closeCurrentBar:function(){k.main.watcher.closeCurrentBar()},log:function(){k.log.apply(null,arguments)},error:function(){k.error.apply(null,arguments)},getPageScript:function(e,t){return _.getPageScript(e,t)},findJson:function(e,t){return _.findJson(e,t)},parseInt:function(e){return parseInt(e)},parseFloat:function(e){return parseFloat(e)},isNaN:function(e){return isNaN(e)},getTitle:function(){return document.title},getUrl:function(){return location.href},getDateAfterDays:function(e,t){return _.getDateAfterDays(e,t)},getCurrentDate:function(){return _.getCurrentDate()},convertTime12to24:function(e){return _.convertTime12to24(e)},jsonParse:function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t},jsonStringify:function(e){return JSON.stringify(e)},findCurrency:function(e){return _.findCurrency(e)}},A={},D={};T.addSite=function(e,t,r){A[e]=r,Array.isArray(t)||(t=[t]),t.forEach((function(e){D[e]=function(){return r}}))},T.getSitePatternObj=function(){return D},T.getSiteIdObj=function(){return A},T.pause=function(e){return new Promise((function(t){setTimeout(t,e)}))},T.waitUntil=function(e,t,r){t||(t=500),r||(r=500);var a=!1,n=setTimeout((function(){a=!0}),t);return function t(){return new Promise((function(t){t(e())})).catch((function(e){k.error("waitUntil condition error",e)})).then((function(e){return e||a?(clearTimeout(n),e):new Promise((function(e){setTimeout(e,r)})).then(t)}))}()},T.getVersion=function(){return 3},T.runFn=function(e,t){return t.constructor.constructor("return "+t)().apply(void 0,Object(n.a)(e))};var O=T,I=function(e){var t={},r={return:function(e,t,r){var a;return t&&(r=t.value),void 0!==r&&(a=o(e,r)),e.return=a},"{}":function(e,t,r){t&&(r=t.prop);var a={};for(var n in r)a[n]=o(e,r[n]);return a},"[]":function(e,t,r){t&&(r=t.values);var a=[];if(r)for(var n=0,i=r.length;n<i;n++)a.push(o(e,r[n]));return a},function:function(e,t,r,a,n){if(t)n=t.statement,r=t.name,a=t.args||[];else{var i=[].slice.call(arguments,2);n=i.pop(),a=i.pop(),r=i.shift()}var o=function(){var t=Object.create(e);t.__parent__scope__=e;for(var r=0,i=a.length;r<i;r++)t[a[r]]=arguments[r];if(c(t,n),t.hasOwnProperty("return"))return t.return};return r&&(e[r]=o),o},var:function(e,r,a,n){return r&&(a=r.name,n=r.value),e[a]=o(e,n),t},raw:function(e,t,r){return t&&(r=t.data),"object"==typeof r?JSON.parse(JSON.stringify({w:r})).w:r},if:function(e,r,a,n,i){r&&(a=r.condition,n=r.then,i=r.else);var s=t;return o(e,a)?s=c(e,n):void 0!==i&&(s=c(e,i)),s},re:function(e,t,r,a){return t&&(r=t.pattern,a=t.flags),new RegExp(r,a)},setType:function(e,t,r,a){t&&(a=t.profile,r=t.param);var n=o(e,a);O.setType(o(e,r),n)},setParam:function(e,t,r,a,n){t&&(n=t.profile,r=t.param,a=t.value);var i=o(e,n);O.setParam(o(e,r),o(e,a),i)},getParam:function(e,t,r,a){t&&(a=t.profile,r=t.param);var n=o(e,a);return O.getParam(o(e,r),n)},setPrice:function(e,t,r,a,n){t&&(n=t.profile,r=t.type,a=t.value);var i=o(e,n);O.setPrice(o(e,r),o(e,a),i)},pageClear:function(e,t,r){t&&(r=t.profile);var a=o(e,r);O.pageClear(a)},preparePrice:function(e,t,r){return t&&(r=t.value),O.preparePrice(o(e,r))},getParamsFromPage:function(e,t,r,a){t&&(r=t.params,a=t.actions),Array.isArray(a)&&"function"!==a[0]||(a=[["then",a]]);for(var n,i,c=a.slice(0),s=O.getParamsFromPage(o(e,r));i=c.shift();)n=s[i[0]].apply(s,i.slice(1).map((function(t){return o(e,t)}))),s=n;return n},locationCheck:function(e,t,r){t&&(r=t.re);var a=r.map((function(t){return o(e,t)}));return O.locationCheck(a)},domWatcher:function(e,t,r){t&&(r=t.prop);var a,n={};for(var i in r)(a=r[i]).cb&&(a.cb=o(e,a.cb)),n[i]=a;return n},details:function(e,t,r){t&&(r=t.prop);var a={};for(var n in r)a[n]=o(e,"locationCheck"===n?{type:"locationCheck",re:r[n]}:"formWatcher"===n||"priceWatcher"===n?{type:"domWatcher",prop:r[n]}:r[n]);return a},parseUrl:function(e,t,r,a,n){var i,c,s;return t&&(r=t.url,a=t.paramsRe,n=t.sep),r&&(i=o(e,r)),a&&(c=o(e,a)),n&&(s=o(e,n)),O.parseUrl(i,c,s)},matchUrl:function(e,t,r){return t&&(r=t.re),O.matchUrl(o(e,r))},testUrl:function(e,t,r){return t&&(r=t.re),O.testUrl(o(e,r))},dom:function(e,t,r,a){if(t)r=t.node,a=t.actions;else{var n=[].slice.call(arguments,2);a=n.pop(),r=n.shift()}var i;r&&(i=o(e,r));for(var c,s,l=a.slice(0),u=O.dom(i);s=l.shift();)c=u[s[0]].apply(null,s.slice(1).map((function(t){return o(e,t)}))),u=c;return c},string:function(e,t,r,a){t&&(r=t.value,a=t.actions);for(var n,i,c=o(e,r),s=a.slice(0),l=O.string(c);i=s.shift();)n=l[i[0]].apply(null,i.slice(1).map((function(t){return o(e,t)}))),l=n;return n},array:function(e,t,r,a){t&&(r=t.value,a=t.actions);for(var n,i,c=o(e,r),s=a.slice(0),l=O.array(c);i=s.shift();)n=l[i[0]].apply(null,i.slice(1).map((function(t){return o(e,t)}))),l=n;return n},object:function(e,t,r,a){t&&(r=t.value,a=t.actions);for(var n,i,c=o(e,r),s=a.slice(0),l=O.object(c);i=s.shift();)n=l[i[0]].apply(null,i.slice(1).map((function(t){return o(e,t)}))),l=n;return n},matchTemplate:function(e,t,r,a,n){t&&(r=t.str,a=t.re,n=t.pattern);var i=o(e,r),c=o(e,a),s=o(e,n);return O.matchTemplate(i,c,s)},match:function(e,t,r,a){return t&&(r=t.value,a=t.re),O.match(o(e,r),o(e,a))},exec:function(e,t,r,a){return t&&(r=t.value,a=t.re),O.exec(o(e,r),o(e,a))},test:function(e,t,r,a){return t&&(r=t.value,a=t.re),O.test(o(e,r),o(e,a))},normalizeDate:function(e,t,r,a,n,i){t&&(r=t.year,a=t.month,n=t.date,i=t.details);var c=o(e,r),s=o(e,a),l=o(e,n),u=o(e,i);return O.normalizeDate(c,s,l,u)},closeCurrentBar:function(){O.closeCurrentBar()},log:function(e,t){var r;r=t?t.args:[].slice.call(arguments).slice(2),O.log.apply(null,r.map((function(t){return o(e,t)})))},error:function(e,t){var r;r=t?t.args:[].slice.call(arguments).slice(2),O.error.apply(null,r.map((function(t){return o(e,t)})))},getPageScript:function(e,t,r,a){return t&&(r=t.str,a=t.re),O.getPageScript(o(e,r),o(e,a))},findJson:function(e,t,r,a){return t&&(r=t.str,a=t.re),O.findJson(o(e,r),o(e,a))},parseInt:function(e,t,r){return t&&(r=t.value),O.parseInt(o(e,r))},parseFloat:function(e,t,r){return t&&(r=t.value),O.parseFloat(o(e,r))},isNaN:function(e,t,r){return t&&(r=t.value),O.isNaN(o(e,r))},getTitle:function(e,t){return O.getTitle()},getUrl:function(e,t){return O.getUrl()},getDateAfterDays:function(e,t,r,a){t&&(r=t.date,a=t.days);var n=o(e,r),i=o(e,a);return O.getDateAfterDays(n,i)},getCurrentDate:function(e,t){return O.getCurrentDate()},convertTime12to24:function(e,t,r){t&&(r=t.value);var a=o(e,r);return O.convertTime12to24(a)},jsonParse:function(e,t,r){t&&(r=t.value);var a=o(e,r);return O.jsonParse(a)},jsonStringify:function(e,t,r){t&&(r=t.value);var a=o(e,r);return O.jsonStringify(a)},findCurrency:function(e,t,r){t&&(r=t.value);var a=o(e,r);return O.findCurrency(a)},pause:function(e,t,r,a){t&&(r=t.time,a=t.actions),Array.isArray(a)&&"function"!==a[0]||(a=[["then",a]]);for(var n,i,c=a.slice(0),s=O.pause(o(e,r));i=c.shift();)n=s[i[0]].apply(s,i.slice(1).map((function(t){return o(e,t)}))),s=n;return n},waitUntil:function(e,t,r,a,n,i){if(t)r=t.condition,a=t.time,n=t.interval,i=t.actions;else{var c=[].slice.call(arguments,2);r=c.shift(),i=c.pop(),a=c.shift(),n=c.shift()}var s=o(e,r),l=o(e,a),u=o(e,n);Array.isArray(i)&&"function"!==i[0]||(i=[["then",i]]);for(var d,p,f=i.slice(0),h=O.waitUntil(s,l,u);p=f.shift();)d=h[p[0]].apply(h,p.slice(1).map((function(t){return o(e,t)}))),h=d;return d},getVersion:function(e,t){return O.getVersion()},runFn:function(e,t,r,a){t&&(r=t.args,a=t.code);var n=o(e,r),i=o(e,a);return O.runFn(n,i)}},a=/^([-+=*/%><!&|^]+|in|instanceof)$/;!function(){var e=function(e,t){for(var r=e;r&&!r.hasOwnProperty(t);)r=r.__parent__scope__;return r},t=r,a={"+":function(e,t,r){return r?+t:e+t},"-":function(e,t,r){return r?-t:e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},"&":function(e,t){return e&t},"|":function(e,t){return e|t},"^":function(e,t){return e^t},"<<":function(e,t){return e<<t},">>":function(e,t){return e>>t},">>>":function(e,t){return e>>>t}};Object.keys(a).forEach((function(e){var r=a[e];t[e]=function(e,t,a,n,i){var c;return t&&(a=t.left,n=t.right,i=t.unary),c=i?[0,o(e,a)]:[o(e,a),o(e,n)],r(c[0],c[1],i)}}));var n={typeof:function(e){return typeof e},void:function(e){},"!":function(e){return!e},"~":function(e){return~e}};Object.keys(n).forEach((function(e){var r=n[e];t[e]=function(e,t,a){return t&&(a=t.left),r(o(e,a))}}));var i={"=":function(e,t,r,a){return e[t]=o(r,a)},"+=":function(e,t,r,a){return e[t]+=o(r,a)},"-=":function(e,t,r,a){return e[t]-=o(r,a)},"*=":function(e,t,r,a){return e[t]*=o(r,a)},"/=":function(e,t,r,a){return e[t]/=o(r,a)},"%=":function(e,t,r,a){return e[t]%=o(r,a)},"<<=":function(e,t,r,a){return e[t]<<=o(r,a)},">>=":function(e,t,r,a){return e[t]>>=o(r,a)},">>>=":function(e,t,r,a){return e[t]>>>=o(r,a)},"&=":function(e,t,r,a){return e[t]&=o(r,a)},"^=":function(e,t,r,a){return e[t]^=o(r,a)},"|=":function(e,t,r,a){return e[t]|=o(r,a)}};Object.keys(i).forEach((function(r){var a=i[r];t[r]=function(t,r,n,i){r&&(n=r.left,i=r.right);var o=e(t,n);return a(o,n,t,i)}}));var c={"++":function(e,t,r){return r?++e[t]:e[t]++},"--":function(e,t,r){return r?--e[t]:e[t]--}};Object.keys(c).forEach((function(r){var a=c[r];t[r]=function(t,r,n,i){r&&(n=r.left,i=r.prefix);var o=e(t,n);return a(o,n,i)}}));var s={in:function(e,t,r){return o(e,t)in o(e,r)},instanceof:function(e,t,r){return o(e,t)instanceof o(e,r)},"&&":function(e,t,r){return o(e,t)&&o(e,r)},"||":function(e,t,r){return o(e,t)||o(e,r)}};Object.keys(s).forEach((function(e){var r=s[e];t[e]=function(e,t,a,n){return t&&(a=t.left,n=t.right),r(e,a,n)}}))}();var n=["Infinity","NaN","undefined"],i=[1/0,NaN,void 0],o=function(e,t){var o,c,s,l,u,d;if("object"==typeof t&&null!==t)if(Array.isArray(t))switch((s=t.length)>1&&"string"==typeof t[1]&&(3===s?a.test(t[1])&&(t=[t[1],t[0],t[2]]):2===s&&"raw"!==t[0]&&a.test(t[1])&&(t=[t[1],t[0],!0])),c=r[t[0]],s){case 1:o=c(e,null);break;case 2:o=c(e,null,t[1]);break;case 3:o=c(e,null,t[1],t[2]);break;case 4:o=c(e,null,t[1],t[2],t[3]);break;case 5:o=c(e,null,t[1],t[2],t[3],t[4]);break;default:o=c.apply(null,[e,null].concat(t.slice(1)))}else o=(c=r[t.type])(e,t);else if("string"==typeof t){var p,f=(u=function(e){for(var t=e[0],r=0;;){if(-1===(r=e.indexOf(t,r+1))){r=e.length;break}if("\\"!==e[r-1])break}var a="";try{a='"'===t?JSON.parse('"'+e.substr(1,r-1)+'"'):JSON.parse('"'+e.substr(1,r-1).replace(/\\'/g,"'").replace(/"/g,'\\"')+'"')}catch(e){}return{data:a,i:r}},d=function(e){for(var t,r,a=[],n="",i=1;r=e[i];i++)if('"'===r||"'"===r)t=u(e.substr(i)),a.push(t.data),i+=t.i;else{if("]"===r)break;n+=r}return n&&a.push(parseFloat(n)),{data:a[0],i:i}},/[\["']/.test(l=t)?function(e){for(var t,r,a=[],n="",i=0;r=e[i];i++)"."===r?(n&&a.push(n),n=""):"["===r?(n&&a.push(n),n="",t=d(e.substr(i)),a.push(t.data),i+=t.i):n+=r;return n&&a.push(n),a}(l):l.split(".")),h=e;if(1===f.length){p=f.shift();var m=n.indexOf(p);o=-1!==m?i[m]:h[p]}else for(;f.length;){if(p=f.shift(),-1===["string","object"].indexOf(typeof h))throw new Error("Prop "+p+" type error!");h=o=h[p]}}else o=t;return o},c=function(e,r){for(var a,n=void 0,i=0,c=r.length;i<c;i++){var s=r[i];if(a=n,(n=o(e,s))===t&&(n=a),e.hasOwnProperty("return"))break}return n};return Array.isArray(e)&&"string"!=typeof e[0]||(e=[e]),c({},e)};O.addSite("skyscanner_com","*://*.skyscanner.*/*",[O.details({locationCheck:[/\/transport\/flights\//,/\/trasporti\/voli\//,/\/transport\/fly\//,/\/tasima\/ucak-bileti\//,/\/transporte\/vuelos\//,/\/transport\/vols\//,/\/transport\/flyg\//,/\/liikennevalineet\/lennot\//],formWatcher:{ctr2:{query:{css:"#app-root",is:"added"},cb:function(e){return O.getParamsFromPage({origin:"__internal.searchParams.originIataCode",destination:"__internal.searchParams.destinationIataCode",dateStart:"__internal.searchParams.outboundDate",dateEnd:"__internal.searchParams.inboundDate",currency:"__internal.culture.currency"}).then((function(t){O.setType("avia",e);var r={MOSC:"MOW"},a=O.object(r).prop(t.origin)||t.origin,n=O.object(r).prop(t.destination)||t.destination;O.setParam("origin",a,e),O.setParam("destination",n,e),O.setParam("dateStart",t.dateStart,e),O.setParam("dateEnd",t.dateEnd,e),O.setParam("currency",t.currency,e)}))}}},priceWatcher:{price:{query:{css:"div[class^=Results_dayViewItems__] div[class^=FlightsTicket_container__] div[class^=Price_mainPriceContainer__]",is:"added"},template:"price"}}})]),O.addSite("momondo_com","*://*.momondo.*/*",[O.details({locationCheck:[/\/aviabilety\//,/\/fluege\//,/\/flybilletter\//,/\/vuelos\//,/\/vluchten\//,/\/lento\//,/\/voos\//,/\/flyg\//],formWatcher:{changePage:{query:{css:".c-flights_result_filters_aside-filter filter-duration",is:"removed"},cb:function(e){O.log("page change!"),O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:[{css:".c-flights_result_filters_aside-filter filter-duration",is:"added"}],cb:function(e){O.setType("avia",e);var t=O.dom(".c-flights_searchform-route .c-flights_searchform-origin input.c-input-element").value(),r=O.dom(".c-flights_searchform-route .c-flights_searchform-destination input.c-input-element").value(),a=O.matchTemplate(t,/\s\(([A-Z]{3})\)/,"$1"),n=O.matchTemplate(r,/\s\(([A-Z]{3})\)/,"$1");O.setParam("origin",a,e),O.setParam("destination",n,e);var i=[],o=O.exec(O.getUrl(),/\/(\d{4}-\d{1,2}-\d{1,2})(?:\/(\d{4}-\d{1,2}-\d{1,2}))?/);o&&(O.array(i).push(o[1]),o[2]&&O.array(i).push(o[2]));var c="",s="";O.array(i).forEach((function(e,t){var r=O.array(O.string(e).split("-")).map((function(e,t){return(1===t||2===t)&&e<10&&(e="0"+e),e})).join("-");0===t?c=r:1===t&&(s=r)})),O.setParam("dateStart",c,e),O.setParam("dateEnd",s,e)}},ccy:{query:{css:".c-flights_result_result_ticket-aside .c-flights_result_result_ticket-aside-price .c-flights_result_result_ticket-aside-price-label",is:"added"},cb:function(e,t){O.array(t.added).some((function(t){var r=O.dom(t).text(),a=O.exec(r,/\s([A-Z]{3})$/);if(a)return O.setParam("currency",a[1],e),!0}))}}},priceWatcher:{price:{query:{css:".c-flights_result_result_ticket-aside .c-flights_result_result_ticket-aside-price .c-flights_result_result_ticket-aside-price-label",is:"added"},template:"price"}},onShow:function(e){O.dom("#mui-header").style("marginTop",e+"px")},onHide:function(){O.dom("#mui-header").style("marginTop",0)}}),O.details({locationCheck:[/\/flight-search\//],formWatcher:{ctr:{query:[{css:"#searchResultsList > div[id]",is:"added"}],cb:function(e){O.setType("avia",e);var t=O.exec(O.getUrl(),/\/flight-search\/([A-Z]{3})-([A-Z]{3})\/(\d{4}-\d{2}-\d{2})(?:\/(\d{4}-\d{2}-\d{2}))?/);return t&&(O.setParam("origin",t[1],e),O.setParam("destination",t[2],e),O.setParam("dateStart",t[3],e),O.setParam("dateEnd",t[4],e)),O.getParamsFromPage({site_currency:"R9.globals.analytics.pixelContext.site_currency"}).then((function(t){O.setParam("currency",t.site_currency,e)}))}}},priceWatcher:{price:{query:{css:".col-price .booking-link .price",is:"added"},template:"price"}},onShow:function(e){O.dom("#mui-header").style("marginTop",e+"px")},onHide:function(){O.dom("#mui-header").style("marginTop",0)}}),O.details({locationCheck:[/\/flightsearch\//],formWatcher:{ctr:{query:[{css:"#flight-list",is:"added"},{css:".results",is:"removed"}],cb:function(e){O.setType("avia",e);var t=O.parseUrl(/[?#](.+)/,/[&#]/);O.setParam("origin",t.SO0,e),O.setParam("destination",t.SD0,e),O.setParam("dateStart",O.matchTemplate(t.SDP0,/(\d{2})-(\d{2})-(\d{4})/,"$3-$2-$1"),e),O.setParam("dateEnd",O.matchTemplate(t.SDP1,/(\d{2})-(\d{2})-(\d{4})/,"$3-$2-$1"),e)}},ccy:{query:{css:".ticketinfo .price .unit",is:"added"},template:"currency"}},priceWatcher:{price:{query:{css:".ticketinfo .price .value",is:"added"},template:"price"}},onShow:function(e){O.dom("#mui-header").style("marginTop",e+"px")},onHide:function(){O.dom("#mui-header").style("marginTop",0)}})]),O.addSite("ozon_travel","*://*.ozon.travel/*",[O.details({locationCheck:[/\/flight\//],formWatcher:{ctr:{query:{css:['.container section[class^="FlightSearchTariff-module__tariffs"]','.container div[class^="FlightSearch2-module__headWrap"]']},cb:function(e){var t=O.matchUrl(/\/search\/(\w{3})(\w{3})(\w{3})?(\w{3})?\/(?:d(\d{4}-\d{2}-\d{2}))(?:d(\d{4}-\d{2}-\d{2}))?/);if(!t)return O.closeCurrentBar(),void O.pageClear(e);var r=t[1],a=t[2];if(!r||!a)return O.error("Origin or destination is empty"),O.pageClear(e);var n=t[3],i=t[4];if(n&&i&&i!==r&&n!==a)return O.error("Unsupported route"),O.pageClear(e);var o=t[5],c=t[6];r=O.string(r).toUpperCase().end(),a=O.string(a).toUpperCase().end(),O.setType("avia",e),O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",o,e),O.setParam("dateEnd",c,e)}},ccy:{query:{css:'span[class^="FlightSearchTariff-module__currency-sign"]',is:"added"},cb:function(e){O.setParam("currency",O.dom(".field-currency .u-input").text(),e)}},ccy_2:{query:{css:'div[class^="FlightSearchTariffSidebar-module__priceValue"]',is:"added"},cb:function(e){O.setParam("currency","RUB",e)}}},priceWatcher:{price:{query:{css:'span[class^="FlightSearchTariff-module__value"]',is:"added"},template:"price"},price_2:{query:{css:'div[class^="FlightSearchTariffSidebar-module__priceValue"]',is:"added"},template:"price"}},onShow:function(e){O.dom("header.main-header").style("marginTop",e+"px")},onHide:function(){O.dom("header.main-header").style("marginTop",0)}})]),O.addSite("onetwotrip_com","*://*.onetwotrip.com/*",[O.details({locationCheck:[/\/f\/#\/search\//],formWatcher:{ctr:{query:[{css:'[data-locator="flights-search-results-container"]',is:"added"}],cb:function(e){O.pageClear(e);var t,r,a,n,i=O.matchUrl(/search\/(\d{2})(\d{2})(\w{3})(\w{3})(\d{2})?(\d{2})?/);i&&(t=i[3],r=i[4],a=O.normalizeDate(null,i[2],i[1]),i[5]&&i[6]&&(n=O.normalizeDate(null,i[6],i[5])),O.setType("avia",e),O.setParam("origin",t,e),O.setParam("destination",r,e),O.setParam("dateStart",a,e),O.setParam("dateEnd",n,e))}},new_ccy:{query:{css:'[data-locator="PriceCalendar--headerDate"] > div > span'},cb:function(e,t){O.array(t.added).some((function(t){var r=O.dom(t).text(),a=O.findCurrency(r);if(a)return O.setParam("currency",a,e),!0}))}}},priceWatcher:{price:{query:{css:'[data-locator="PriceCalendar--headerDate"]'},cb:function(e){var t=O.dom().getAll('[data-locator="flight-variant"] [data-locator="flight-variant-price"] > span').end();O.array(t).forEach((function(t){var r=O.dom(t).text(),a=O.preparePrice(r);O.setPrice("price",a,e)}))}}},bodySelector:"body",styleSelector:"head",onShow:function(e){O.dom("body").style("paddingTop",e+"px")},onHide:function(){O.dom("body").style("paddingTop",0)},getSvgTemplate:function(e,t){if("close"===e)return["svg",{width:t.width||"80",height:t.height||t.width||"80",viewBox:"0 0 80 80"},[["path",{fill:"#000",d:"M56.970 52.729L44.243 40l12.728-12.728-4.242-4.243L40 35.757 27.272 23.029l-4.243 4.243L35.757 40 23.029 52.729l4.243 4.242L40 44.243l12.729 12.728z"}]]]},onAddStyle:function(e,t){e.body&&e.body.backgroundColor&&O.object(e.body).prop("backgroundColor","#fcefb1"),e.suggest&&e.suggest["&:hover"]&&O.object(e.suggest["&:hover"]).prop("backgroundColor","#fcefb1")},onCreateBar:function(e){O.runFn([e],'function(a){const b=a.body.node,c=b.querySelector("a[href=\\"#close\\"]");if(c){const b=a.wDom.get(c);b.removeAttribute("href")}}')},disableFontLink:!0}),O.details({locationCheck:[/\/hotel\//],formWatcher:{new_changePage:{query:{css:"#content > div > div > div > div > div > div:nth-child(4)",is:"removed"},cb:function(e){O.closeCurrentBar(),O.pageClear(e)}},new_ctr:{query:{css:"div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > div:nth-child(1) > h1",is:"added"},cb:function(e){O.setType("hotel",e);var t=O.parseUrl();O.setParam("dateIn",t.date_start,e),O.setParam("dateOut",t.date_end,e);var r=O.parseInt(t["rooms[0]"]);O.setParam("adults",r,e);var a=O.string(O.dom("div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > div:nth-child(1) > h1").text()).trim().end();if(a){var n=[a],i=t.cityName;i&&O.array(n).push(a+" "+i),O.setParam("query",n,e)}else O.error("hotelName is not found")}},new_ccy:{query:{css:"header + div > div > div > div + div > div div:nth-child(3) > div:nth-child(1) > div:nth-child(1) > span > span",is:"added"},cb:function(e,t){O.array(t.added).some((function(t){var r=O.dom(t.parentNode).text();if(r){var a=O.findCurrency(r);if(a)return O.setParam("currency",a,e),!0}}))}}},priceWatcher:{new_price:{query:{css:"header + div > div > div > div + div > div div:nth-child(3) > div:nth-child(1) > div:nth-child(1) > span > span:nth-child(1)",is:"added"},cb:function(e,t){O.array(t.added).forEach((function(t){var r=O.dom(t).text(),a=O.dom(t.parentNode.parentNode.parentNode.parentNode).find("div:nth-child(2)").text();if(r&&a){var n=O.test(a,/ 1 /);n=n?"oneDayPrice":"price",O.setPrice(n,O.preparePrice(r),e)}}))}}},getSvgTemplate:function(e,t){if("close"===e)return["svg",{width:t.width||"80",height:t.height||t.width||"80",viewBox:"0 0 80 80"},[["path",{fill:"#000",d:"M56.970 52.729L44.243 40l12.728-12.728-4.242-4.243L40 35.757 27.272 23.029l-4.243 4.243L35.757 40 23.029 52.729l4.243 4.242L40 44.243l12.729 12.728z"}]]]},onAddStyle:function(e,t){e.body&&e.body.backgroundColor&&O.object(e.body).prop("backgroundColor","#fcefb1"),e.suggest&&e.suggest["&:hover"]&&O.object(e.suggest["&:hover"]).prop("backgroundColor","#fcefb1")},onShow:function(e){O.dom("body").style("paddingTop",e+"px")},onHide:function(){O.dom("body").style("paddingTop",0)}})]),O.addSite("onetravel_com","*://*.onetravel.com/*",[O.details({locationCheck:[/\/fpnext\/air\/Listing\//i],formWatcher:{ctr:{query:{css:"#flight-listings"},cb:function(e){O.pageClear(e);var t=O.dom("input#htxtTripType").value();if("ROUNDTRIP"!==t&&"ONEWAYTRIP"!==t)return O.closeCurrentBar(),void O.pageClear(e);O.setType("avia",e);var r=O.dom("input#htxtOriginCode").value(),a=O.dom("input#htxtDestinationCode").value(),n=O.dom("input#htxtFromDate").value(),i=O.dom("input#htxtToDate").value(),o=O.string(O.dom("span#currencyPicker").data("currentcurrency")).substr(0,3).end();"01/01/0001"===i&&(i=null),O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",O.matchTemplate(n,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$1-$2"),e),O.setParam("dateEnd",O.matchTemplate(i,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$1-$2"),e),O.setParam("currency",o,e)}}},priceWatcher:{price:{query:{css:"#flight-listings .contract-block .fare__amount.is--total"},template:"price"}}})]),O.addSite("kayak_com","*://*.kayak.*/*",[O.details({formWatcher:{ctr:{query:{css:["#resbody","#searchResultsList > div"]},cb:function(e){var t=O.matchUrl(/\/flights\/(\w{3})-(\w{3})\/(\d{4}-\d{2}-\d{2})(?:\/(\d{4}-\d{2}-\d{2}))?(?:\/(\w{3})-\w{3})?/);if(t&&!t[5])return O.getParamsFromPage({origin:"R9.globals.analytics.pixelContext.originCode",destination:"R9.globals.analytics.pixelContext.destinationCode",dateStart:"R9.globals.analytics.pixelContext.departureDate",dateEnd:"R9.globals.analytics.pixelContext.returnDate",currency:"R9.globals.analytics.pixelContext.site_currency",tripType:"R9.globals.analytics.pixelContext.roundTrip",dateStartEn:"R9.globals.analytics.pixelContext.depart_date",dateEndEn:"R9.globals.analytics.pixelContext.return_date"}).then((function(r){if(O.setType("avia",e),t)O.setParam("origin",t[1],e),O.setParam("destination",t[2],e),O.setParam("dateStart",t[3],e),O.setParam("dateEnd",t[4],e);else{O.setParam("origin",r.origin,e),O.setParam("destination",r.destination,e);var a=r.dateStart||r.dateStartEn;a=O.matchTemplate(a,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3"),O.setParam("dateStart",a,e);var n=r.dateEnd||r.dateEndEn;n=O.matchTemplate(n,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3"),O.setParam("dateEnd",n,e)}O.setParam("currency",r.currency,e)}));O.closeCurrentBar(),O.pageClear(e)}}},priceWatcher:{price:{query:{css:[".resultsContainer .booking-link > .price .price-text"]},template:"price"}}})]),O.addSite("travelocity_com",["*://*.travelocity.com/*","*://*.travelocity.ca/*","*://*.orbitz.com/*","*://*.expedia.*/*","*://*.expedia-cn.com/*"],[O.details({locationCheck:[/Hotel-Information/,/Informacion-Hotel/,/Hotellbeskrivning/,/Hotel-Beschreibung/,/Hotelinfo/,/Hotel-Reservas/,/Thong-tin-khach-san/,/hotellitiedot/,/Description-Hotel/,/Informazioni-Hotel/,/Hotellinformasjon/],formWatcher:{ctr:{query:[{css:'h1[data-stid="content-hotel-title"]',is:"added"}],cb:function(e){return O.getParamsFromPage({currency:"__STATE__.context.currency",startDate:"__STATE__.currentHotel.offerSearchData.startDate",endDate:"__STATE__.currentHotel.offerSearchData.endDate",adults:"__STATE__.currentHotel.offerSearchData.adults",name:"__STATE__.currentHotel.hotel.name",region:"__STATE__.currentHotel.hotel.region.name"}).then((function(t){var r=t.name,a=t.region,n=t.currency,i=t.startDate,o=t.endDate,c=O.parseInt(t.adults);O.setType("hotel",e);var s=[r];a&&O.array(s).unshift(r+" "+a),O.setParam("query",s,e),O.setParam("adults",c,e),O.setParam("currency",n,e),O.setParam("dateIn",i,e),O.setParam("dateOut",o,e)}))}}},priceWatcher:{price:{query:{css:'.room__card .price span[data-stid="content-hotel-lead-price"]'},template:"price",key:"oneDayPrice"}}}),O.details({locationCheck:[/\/Flights-Search/],formWatcher:{ctr:{query:{css:"#flightModuleList"},cb:function(e){var t=O.jsonParse(O.dom("#singlePageModel").text());if(!t)return O.getParamsFromPage({origin:"IntentMediaProperties.flight_origin",destination:"IntentMediaProperties.flight_destination",dateStart:"IntentMediaProperties.travel_date_start",dateEnd:"IntentMediaProperties.travel_date_end",currency:"IntentMediaProperties.site_currency",type:"IntentMediaProperties.product_category",tripType:"IntentMediaProperties.trip_type"}).then((function(t){if("flights"===t.type){O.setType("avia",e),O.setParam("origin",t.origin,e),O.setParam("destination",t.destination,e),O.setParam("currency",t.currency,e);var r=O.matchTemplate(t.dateStart,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateStart",r,e);var a=null;"ROUND_TRIP"===t.tripType&&(a=O.matchTemplate(t.dateEnd,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),O.setParam("dateEnd",a,e)}else O.pageClear(e)}));O.setType("avia",e),O.setParam("origin",t.departureAirportCode,e),O.setParam("destination",t.arrivalAirportCode,e),O.setParam("currency",t.currencyCode,e),O.setParam("dateStart",t.departureISODate,e),t.isOneWay||O.setParam("dateEnd",t.arrivalISODate,e)}}},priceWatcher:{price:{query:{css:"#flightModuleList .flight-module.segment .primary-content .full-bold"},template:"price"}}})]),O.addSite("priceline_com","*://*.priceline.com/*",[O.details({locationCheck:[/\/fly(\/#)?\/search\//],formWatcher:{ctr:{query:{css:".fly-search-listings-container"},cb:function(e){var t=O.matchUrl(/\/search\/([^-\/]+)-([^-\/]+)-([^-\/]+)\/(?:([^-\/]+)-([^-\/]+)-([^-\/]+)\/)?/);if(t){O.setType("avia",e);var r=O.array(O.string(t[1]).split(":")).get(0);O.setParam("origin",r,e);var a=O.array(O.string(t[2]).split(":")).get(0);O.setParam("destination",a,e);var n=O.matchTemplate(t[3],/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateStart",n,e);var i=O.matchTemplate(t[6],/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");return O.setParam("dateEnd",i,e),O.getParamsFromPage({currency:"pclntms.dataDictionary.currencyCode"}).then((function(t){O.setParam("currency",t.currency,e)}))}}}},priceWatcher:{oldPrice:{query:{css:".fly-itinerary .details .price"},template:"price"},price:{query:{css:'ul.fly-search-listings li div[data-test="pricing-info"]'},cb:function(e,t){O.array(t.added).forEach((function(t){var r=O.dom(t).remove('span[data-test="rounded-dollars"]').text();O.setPrice("price",O.preparePrice(r),e)}))}}}})]),O.addSite("aeroflot_ru","*://*.aeroflot.ru/*",[O.details({locationCheck:[/\/app\/.+\/search\?/],formWatcher:{change:{query:{css:".frame__container",is:"removed"},cb:function(e){O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:{css:".frame__container"},cb:function(e){var t=O.parseUrl(),r=O.exec(t.routes,/(\w{3})\.(\d{4}\d{2}\d{2})\.(\w{3})(?:-(\w{3})\.(\d{4}\d{2}\d{2})\.(\w{3}))?/);if(!r)return O.closeCurrentBar(),void O.pageClear(e);var a=r[1],n=r[2],i=r[3],o=r[5];if(o&&(i!==r[4]||a!==r[6]))return O.closeCurrentBar(),void O.pageClear(e);O.pageClear(e),O.setType("avia",e),O.setParam("origin",a,e),O.setParam("destination",i,e);var c=O.matchTemplate(n,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");if(O.setParam("dateStart",c,e),o){var s=O.matchTemplate(o,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateEnd",s,e)}var l=O.exec(O.dom(".header__select .header__select-item").text(),/,\s([A-Z]{3})/);l&&O.setParam("currency",l[1],e)}}},priceWatcher:{minPriceOut:{query:{css:".meta__col--center div > .frame:nth-child(1) .frame__container > div > .flight-search .flight-search__price"},template:"price",key:"minPriceOut"},minPriceIn:{query:{css:".meta__col--center div > .frame:nth-child(2) .frame__container > div > .flight-search .flight-search__price"},template:"price",key:"minPriceIn"}}})]),O.addSite("anywayanyday_com","*://*.anywayanyday.com/*",[O.details({locationCheck:[/\/avia\/offers\//],formWatcher:{ctr:{query:{css:".offers-tickets-container"},cb:function(e){var t=O.matchUrl(/\/avia\/offers\/(\d{2})(\d{2})(\w{3})(\w{3})(?:(\d{2})(\d{2})(\w{3})(\w{3}))?/);if(t){O.array(t).shift(),O.setType("avia",e);var r=!t[4];if(r||t[2]===t[7]&&t[3]===t[6]){O.setParam("origin",t[2],e),O.setParam("destination",t[3],e);var a=O.normalizeDate(null,t[1],t[0]);O.setParam("dateStart",a,e);var n=!r&&O.normalizeDate(null,t[5],t[4]);O.setParam("dateEnd",n,e)}else O.error("More one way in URL!",t)}}},ccy:{query:{css:".headerSidebar-currencyBlock .dropdown-selected.dropdown-item"},template:"currency"}},priceWatcher:{price:{query:{css:".offers-tickets-container .fareTickets .b-price"},template:"price"}},onShow:function(e){O.dom("#app").style("top",e+"px"),O.dom("#app .page-top").style("top",e+"px")},onHide:function(){O.dom("#app").style("top",0),O.dom("#app .page-top").style("top",0)}}),O.details({locationCheck:[/hotels\.anywayanyday.+\/offers/],formWatcher:{ctr:{query:[{css:".hotelRooms",is:"added"},{css:".hotelRooms-load",is:"removed"}],cb:function(e){O.setType("hotel",e);var t=O.parseUrl(/[?#](.+)/,/[&#]/),r=O.matchTemplate(t.fromDate,/(\d{2})-(\d{2})-(\d{4})/,"$3-$2-$1"),a=O.matchTemplate(t.toDate,/(\d{2})-(\d{2})-(\d{4})/,"$3-$2-$1");return O.setParam("dateIn",r,e),O.setParam("dateOut",a,e),O.setParam("adults",t.adults||t.adults0,e),O.waitUntil((function(){return O.dom("div.hotelName").len()}),3e4,250).then((function(){var t=O.string(O.dom("div.hotelName").text()).trim().end();if(t){var r=[];O.array(r).push(t);var a=O.parseUrl(),n=O.exec(a.cityId,/(.+)\/(.+)/);n&&(O.array(r).push(t+" "+n[1]),O.array(r).push(t+" "+n[1]+" "+n[2])),O.setParam("query",r,e)}else O.error("Hotel name is not found!")}))}},ccy:{query:{css:".headerSidebar-DropdownCurrency > span"},template:"currency"}},priceWatcher:{price:{query:{css:".hotelOffer-priceValue"},template:"price"}},onShow:function(e){O.dom("#app").style("top",e+"px"),O.dom("#app .page-top").style("top",e+"px")},onHide:function(){O.dom("#app").style("top",0),O.dom("#app .page-top").style("top",0)}})]),O.addSite("svyaznoy_travel","*://*.svyaznoy.travel/*",[O.details({locationCheck:[/\/hotels\//],formWatcher:{changePage:{query:{css:".relative-container",is:"removed"},cb:function(e){O.log("page change!"),O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:{css:".container > .relative-container .hotel__header"},cb:function(e){var t=O.parseUrl(),r=O.string(O.dom(".hotel__title").text()).trim().end();r?t.rooms&&1!=t.rooms?O.error("More one room!"):(O.setType("hotel",e),O.setParam("dateIn",t.checkin,e),O.setParam("dateOut",t.checkout,e),O.setParam("adults",t.adults,e),r&&O.setParam("query",[r],e)):O.error("Hotel name is not found!")}},ccy:{query:{css:".rates__body .rate__section .rate__price .icon-rub"},cb:function(e,t){t.added.length&&O.setParam("currency","RUB",e)}}},priceWatcher:{price:{query:{css:".rates__body .rate__section .rate__price"},template:"price"}}}),O.details({formWatcher:{ctr:{query:[{css:".result_best_price .result__price"}],cb:function(e){if(O.dom(".searchbox__nav-item_avia.active").len()){var t=O.dom(".searchbox__waybox_from .searchbox__waydesc").text(),r=O.dom(".searchbox__waybox_to .searchbox__waydesc").text(),a=O.dom("#dateFrom").attr("value"),n=O.dom("#dateTo").attr("value"),i=O.matchTemplate(a,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1"),o=O.matchTemplate(n,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setType("avia",e),O.setParam("origin",t,e),O.setParam("destination",r,e),O.setParam("dateStart",i,e),O.setParam("dateEnd",o,e),O.dom("._rur").len()&&O.setParam("currency","RUB",e)}else O.pageClear(e)}},ccy:{query:{css:".i-icon._rub",is:"added"},cb:function(e,t){t.added.length&&O.setParam("currency","RUB",e)}}},priceWatcher:{price:{query:[{css:".result_best_price .result__price"}],template:"price"}}})]),O.addSite("tickets_ru","*://avia.tickets.ru/*",[O.details({locationCheck:[/\/search\/results/],formWatcher:{ctr:{query:{css:".result_block"},cb:function(e){return O.getParamsFromPage({origin:"avia_form_search_params.from_code",destination:"avia_form_search_params.to_code",dateStart:"avia_form_search_params.departure_date",dateEnd:"avia_form_search_params.departure_date1",fromCode1:"avia_form_search_params.from_code1",toCode1:"avia_form_search_params.to_code1",type:"cur_domain_name"}).then((function(t){if("avia"!==t.type)return O.error("Is not avia page!"),void O.pageClear(e);if(O.setType("avia",e),!t.dateEnd||t.origin===t.toCode1&&t.destination===t.fromCode1){O.setParam("origin",t.origin,e),O.setParam("destination",t.destination,e);var r=O.matchTemplate(t.dateStart,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateStart",r,e);var a=O.matchTemplate(t.dateEnd,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateEnd",a,e)}else O.error("More one way",t)}))}},ccy:{query:{css:".currency-select_wrapper .chosen-single span"},template:"currency",currencyMap:{RUR:"RUB"}}},priceWatcher:{price:{query:{css:"#offers_table .item-block .price-block strong[class]:not(.hidden)"},template:"price"}}})]),O.addSite("s7_ru","*://*.s7.ru/*",[O.details({locationCheck:[/\/air\?/],formWatcher:{ctr:{query:[{css:"#expandSearchForm"}],cb:function(e){O.pageClear(e)}}},priceWatcher:{priceOut:{query:{css:'#exact_outbound_section .select-flights span[data-qa="amount"]'},template:"price",key:"minPriceOut"},priceIn:{query:{css:'#exact_inbound_section .select-flights span[data-qa="amount"]'},template:"price",key:"minPriceIn"},travelWithPriceOut:{query:{css:'#exact_outbound_flight_table .select-tariff span[data-qa="amount"]'},template:"price",key:"minPriceOut"},travelWithPriceIn:{query:{css:'#exact_inbound_flight_table .select-tariff span[data-qa="amount"]'},template:"price",key:"minPriceIn"}},onShow:function(e){O.dom("body").style("marginTop",e+"px")},onHide:function(){O.dom("body").style("marginTop",0)}})]),O.addSite("kupibilet_ru","*://*.kupibilet.ru/*",[O.details({formWatcher:{ctr:{query:[{css:'div[class^="styled__SearchWrapper-"]'}],cb:function(e){var t=O.matchUrl(/\/search\/(?:\w\d{3})(\d{2})(\w{3})(\w{3})(\w{3})(?:(\d{2})(\w{3})(\w{3})?)?/);if(t)if(O.array(t).shift(),t[6])O.error("More two way!",t);else{var r=!t[4];O.setType("avia",e),O.setParam("origin",t[2],e),O.setParam("destination",t[3],e);var a={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},n=O.normalizeDate(null,t[1],t[0],{monthMap:a});O.setParam("dateStart",n,e);var i=!r&&O.normalizeDate(null,t[5],t[4],{monthMap:a});O.setParam("dateEnd",i,e)}}},ccy:{query:{css:'div[class^="styled__TicketContainer-"] span[class^="styled__StyledButtonText-sc-"]',is:"added"},cb:function(e,t){O.array(t.added).some((function(t){if(O.test(t.textContent,/₽/))return O.setParam("currency","RUB",e),!0}))}}},priceWatcher:{price:{query:{css:'div[class^="styled__TicketContainer-"] span[class^="styled__StyledButtonText-sc-"] span:last-child',is:"added"},template:"price"}},bodySelector:"#app",onCreateBar:function(e){O.runFn([e],'function(a){const b=a.body.node;if(b){const c=a.wDom.get(b);c.setStyle("position","")}const c=b.querySelector("a[href=\\"#close\\"]");if(c){const b=a.wDom.get(c);b.removeAttribute("href")}const d=b.querySelector("[href*=\\"hydra.aviasales\\"]");if(d){const b=a.wDom.get(d);b.removeAttribute("href")}}')}})]),O.addSite("trip_ru","*://*.trip.ru/*",[O.details({locationCheck:[/\/choose-your-flight/],formWatcher:{ctr:{query:{css:"#airResultContent"},cb:function(e){return O.getParamsFromPage({dataLayer:"dataLayer",origin:"from_airport_iataCode__2",destination:"to_airport_iataCode__2",startDate:"startDate",endDate:"endDate"}).then((function(t){var r=null;O.array(t.dataLayer).some((function(e){if(e.startDate&&e.originCityCode&&e.cityCode)return r=e,!0})),r?(O.setType("avia",e),O.setParam("origin",r.originCityCode,e),O.setParam("destination",r.cityCode,e),O.setParam("dateStart",r.startDate,e),O.setParam("dateEnd",r.endDate,e),O.setParam("currency",r.siteCurrency,e)):O.error("dataLayer is not found")}))}}},priceWatcher:{price:{query:{css:".tripItemTable .tripItemPricePerPersonValue"},template:"price"}}})]),O.addSite("trip_com","*://*.trip.com/*",[O.details({locationCheck:[/\/flights\/[^\/]+\/tickets-.+/],formWatcher:{ctr:{query:{css:".m-main-list .m-result-list"},cb:function(e){var t=O.parseUrl();O.setType("avia",e);var r=t.flighttype;if("rt"===r||"d"===r||"s"===r||"ow"===r){var a=O.string(t.dcity).toUpperCase().end();O.setParam("origin",a,e);var n=O.string(t.acity).toUpperCase().end();O.setParam("destination",n,e);var i=null;if("rt"===r||"d"===r){i=t.ddate||t.startdate,O.setParam("dateStart",i,e);var o=t.rdate||t.returndate;O.setParam("dateEnd",o,e)}else i=t.ddate||t.startdate;O.setParam("dateStart",i,e);var c=O.dom(".mc-hd__currency .mc-hd__dropdown-cur").text();c&&O.setParam("currency",c,e)}else O.pageClear(e),O.closeCurrentBar()}}},priceWatcher:{price:{query:{css:".m-main-list .m-result-list .result-item .o-price-flight"},template:"price"}}})]),O.addSite("ctrip_com","*://*.ctrip.com/*",[O.details({locationCheck:[/flights\.ctrip\.com\/itinerary\//],formWatcher:{ctr:{query:{css:".searchresult_content .cabinV2"},cb:function(e){O.pageClear(e);var t=O.exec(O.getUrl(),/\/itinerary\/(roundtrip|oneway)\/(\w{3})-(\w{3})/);if(!t)return O.closeCurrentBar(),void O.error("Match url error");var r=t[1],a=O.string(t[2]).toUpperCase().end(),n=O.string(t[3]).toUpperCase().end(),i=O.parseUrl(),o=O.string(i.date).split(","),c=O.array(o).get(0),s=O.array(o).get(1);O.setType("avia",e),O.setParam("origin",a,e),O.setParam("destination",n,e),O.setParam("dateStart",c,e),"roundtrip"===r&&O.setParam("dateEnd",s,e),O.setParam("currency","CNY",e)}}},priceWatcher:{price:{query:{css:".searchresult_content .search_box .price .base_price02"},template:"price"}}}),O.details({locationCheck:[/flights\.ctrip\.com\/international\//],formWatcher:{ctr:{query:{css:".result-wrapper .flight-list"},cb:function(e){return O.getParamsFromPage({flightSegments:"GlobalSearchCriteria.flightSegments",flightWayEnum:"GlobalSearchCriteria.flightWayEnum"}).then((function(t){if(!t.flightSegments||O.array(t.flightSegments).len()<1||O.array(t.flightSegments).len()>2)return O.error("flightSegments problems"),O.pageClear(e),void O.closeCurrentBar();var r=O.array(t.flightSegments).get(0),a=O.array(t.flightSegments).get(1);if(r&&a&&(r.departureCityCode!==a.arrivalCityCode||a.departureCityCode!==r.arrivalCityCode))return O.error("departureCityCode and arrivalCityCode is not same"),O.pageClear(e),void O.closeCurrentBar();O.setType("avia",e);var n=r.departureCityCode;O.setParam("origin",n,e);var i=r.arrivalCityCode;O.setParam("destination",i,e);var o=r.departureDate;if(O.setParam("dateStart",o,e),a){var c=a.departureDate;O.setParam("dateEnd",c,e)}O.setParam("currency","CNY",e)}))}}},priceWatcher:{price:{query:{css:".result-wrapper .flight-list .flight-item .price"},template:"price"}}})]),O.addSite("sindbad_ru","*://*.sindbad.ru/*",[O.details({formWatcher:{ctr:{query:[{css:".trips"},{css:".wait_loop"}],cb:function(e){return O.getParamsFromPage({origin:"App.searchModel.attributes.request.src",destination:"App.searchModel.attributes.request.dst",dateStart:"App.searchModel.attributes.request.date_out",dateEnd:"App.searchModel.attributes.request.date_in"}).then((function(t){O.setType("avia",e),O.setParam("origin",t.origin,e),O.setParam("destination",t.destination,e),O.setParam("dateStart",t.dateStart,e),O.setParam("dateEnd",t.dateEnd,e),O.dom(".ruble").len()&&O.setParam("currency","RUB",e)}))}}},priceWatcher:{price:{query:{css:".trips .trip-worth .trip-worth__price",is:"added"},template:"price"}}})]),O.addSite("aviakassa_ru",["*://*.aviakassa.ru/*","*://*.aviakassa.com/*"],[O.details({formWatcher:{ctr:{query:[{css:".AviaResultList__Groups"}],cb:function(e){var t=O.getUrl(),r=O.test(t,/\/avia\/results\//),a=O.exec(t,/(RT|OW)\w\d+(\w{3})(\w{3})(\d{4})(\d{2})(\d{2})(?:(\w{3})(\w{3})(\d{4})(\d{2})(\d{2}))?/);if(!r||!a)return O.pageClear(e),void O.closeCurrentBar();O.array(a).shift();var n=a[1],i=a[2];if("RT"===a[0]&&(n!==a[7]||i!==a[6]))return O.pageClear(e),void O.closeCurrentBar();var o=O.array([a[3],a[4],a[5]]).join("-"),c=null;a[8]&&a[9]&&a[10]&&(c=O.array([a[8],a[9],a[10]]).join("-")),O.setType("avia",e),O.setParam("origin",n,e),O.setParam("destination",i,e),O.setParam("dateStart",o,e),O.setParam("dateEnd",c,e)}},ccy:{query:{css:".AviaResultList__Groups .Card .Price__Value"},cb:function(e){O.dom(".Price__Value").some((function(t){var r=t.parentNode;if(r){var a=O.dom(r).text();return O.test(a,/руб/)||O.test(a,/RUR/)?(O.setParam("currency","RUB",e),!0):void 0}}))}}},priceWatcher:{price:{query:{css:".AviaResultList__Groups .Card .Price__Value"},template:"price"}}})]),O.addSite("biletix_ru","*://*.biletix.ru/*",[O.details({formWatcher:{ctr:{query:[{css:".flights"},{css:".progress-ajax-border"}],cb:function(e){return O.getParamsFromPage({origin:"xcnt_transport_from",destination:"xcnt_transport_to",dateStart:"xcnt_transport_depart_date",dateEnd:"xcnt_transport_return_date",type:"APRT_DATA.searchTickets.type"}).then((function(t){if("avia"===t.type){O.setType("avia",e),O.setParam("origin",t.origin,e),O.setParam("destination",t.destination,e);var r=O.matchTemplate(t.dateStart,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateStart",r,e);var a=O.matchTemplate(t.dateEnd,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateEnd",a,e);var n=O.dom('#currency_form .selected input[name="currency"]').value();"RUR"===n&&(n="RUB"),O.setParam("currency",n,e)}else O.pageClear(e)}))}}},priceWatcher:{price:{query:{css:".offers .offer .price .caption"},template:"price"}}})]),O.addSite("utair_ru","*://*.utair.ru/*",[O.details({formWatcher:{ctr:{query:[{css:".FlightRow-Cell"}],cb:function(e){var t=O.matchUrl(/\/booking\/search\/!\/(\w{3})\/(\w{3})\/(\d{2}.\d{2}.\d{4})\+?(\d{2}.\d{2}.\d{4})?/);if(!t)return O.closeCurrentBar(),void O.pageClear(e);var r=t[1],a=t[2];if(!r||!a)return O.error("Origin or destination is empty"),O.pageClear(e);var n=t[3],i=t[4];n&&(n=O.matchTemplate(n,/(\d{2}).(\d{2}).(\d{4})/,"$3-$2-$1")),i&&(i=O.matchTemplate(i,/(\d{2}).(\d{2}).(\d{4})/,"$3-$2-$1")),O.setType("avia",e),O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",n,e),O.setParam("dateEnd",i,e),O.setParam("currency","RUB",e)}}},priceWatcher:{price:{query:[{css:".OfferControlBody-Text_style_link",is:"added"},{css:".OfferControlBody-Text_style_selected",is:"added"}],template:"price"}}})]),O.addSite("booking_com","*://*.booking.*/*",[O.details({locationCheck:[/\/hotel\//],formWatcher:{ctr:{query:{css:"#hotelTmpl"},cb:function(e){var t=O.array(O.string(O.dom("#hp_hotel_name").text()).trim().match(/\n?(.*)$/)).pop();if(t)return O.getParamsFromPage({city:"B.env.b_city_name",dateIn:"B.env.b_checkin_date",dateOut:"B.env.b_checkout_date",currency:"B.env.b_hotel_currencycode",adults:"B.env.b_occupancy.adults",old_city:"utag_data.city_name",country:"utag_data.country_name",old_dateIn:"utag_data.date_in",old_dateOut:"utag_data.date_out",old_currency:"utag_data.currency",old_adults:"utag_data.adults"}).then((function(r){O.setType("hotel",e);var a=r.city||r.old_city,n=r.country,i=r.dateIn||r.old_dateIn,o=r.dateOut||r.old_dateOut,c=r.currency||r.old_currency,s=r.adults||r.old_adults,l=[t];a&&n?O.array(l).unshift(t+" "+a+" "+n):a?O.array(l).unshift(t+" "+a):n&&O.array(l).unshift(t+" "+n),O.setParam("query",l,e),O.setParam("dateIn",i,e),O.setParam("dateOut",o,e),O.setParam("currency",c,e),O.setParam("adults",s,e)}))}}},priceWatcher:{price:{query:{css:["#available_rooms .hprt-price-block .bui-price-display__value",".booking_summary .roomPrice strong.rooms-table-room-price"]},template:"price"}}})]),O.addSite("agoda_com","*://*.agoda.*/*",[O.details({locationCheck:[/\/hotel\//],formWatcher:{ctr:{query:[{css:"#roomGridContent",is:"added"}],cb:function(e){return O.setType("hotel",e),O.getParamsFromPage({checkIn:"propertyPageParams.hotelSearchCriteria.checkInDate",checkOut:"propertyPageParams.hotelSearchCriteria.checkOutDate",adults:"propertyPageParams.hotelSearchCriteria.adults",children:"propertyPageParams.hotelSearchCriteria.children",rooms:"propertyPageParams.hotelSearchCriteria.rooms",name:"propertyPageParams.hotelInfo.name",city:"propertyPageParams.hotelInfo.address.cityName",currency:"propertyPageParams.currencyInfo.code"}).then((function(t){if(1===t.rooms){O.setParam("dateIn",t.checkIn,e),O.setParam("dateOut",t.checkOut,e),O.setParam("adults",t.adults,e);var r=t.name,a=O.exec(r,/\((.+)\)$/);(a=a&&a[1])&&(r=O.string(r).replace("("+a+")","").end());var n=[r];a&&O.array(n).push(a),t.city&&(a&&O.array(n).unshift(a+" "+t.city),O.array(n).unshift(r+" "+t.city)),O.setParam("query",n,e);var i=t.currency;i||(i=O.dom(".header-menu__item.currency.selected a[data-value]").attr("data-value")),O.setParam("currency",i,e)}else O.error("rooms is not one")}))}}},priceWatcher:{price:{query:{css:["#roomGrid .PriceDisplay .pd-price"]},template:"price",key:"oneDayPrice"}}})]),O.addSite("hotels_com","*://*.hotels.com/*",[O.details({locationCheck:[/\/hotel\/|\/ho\d+\//],formWatcher:{ctr:{query:{css:"#property-details"},cb:function(e){var t=O.string(O.dom('.vcard h1[itemprop="name"]').text()).trim().end();return O.getParamsFromPage({dateIn:"commonDataBlock.search.checkinDate",dateOut:"commonDataBlock.search.checkoutDate",name:"commonDataBlock.property.hotelName",country:"commonDataBlock.property.country",city:"commonDataBlock.property.city",currency:"commonDataBlock.property.featuredPrice.currency",rooms:"commonDataBlock.search.numRooms",searchRooms:"commonDataBlock.search.rooms"}).then((function(r){if(1==r.rooms&&1===O.array(r.searchRooms).len()){O.setType("hotel",e),t===r.name&&(t=null);var a=[];r.name&&O.array(a).push(r.name),t&&O.array(a).push(t),O.array(a).slice(0).forEach((function(e){if(e){var t;(t=O.getVersion()<=1?O.array([r.city,r.country]).filter((function(e){return!!e})):O.array([r.city,r.country]).filter((function(e){return!!e})).end()).length&&O.array(a).unshift(O.array([e,O.array(t).join(" ")]).join(" "))}})),O.setParam("query",a,e),O.setParam("dateIn",r.dateIn,e),O.setParam("dateOut",r.dateOut,e),O.setParam("currency",r.currency,e);var n=r.searchRooms[0].numAdults;O.setParam("adults",n,e)}}))}}},priceWatcher:{price:{query:{css:"#rooms-and-rates .current-price"},template:"price"}}})]),O.addSite("ostrovok_ru","*://*.ostrovok.ru/*",[O.details({formWatcher:{ctr:{query:{css:[".zen-roomspage-calltoaction-roomtypes-price-value",".rate-pricevalue",".zen-roomspagerate-price-value",".hotel-metaroom-rate-pricevalue"]},cb:function(e){if(O.matchUrl(/(?:b2b|card|club|corp|newb2b)\.ostrovok\.ru/))O.pageClear(e);else{var t=O.testUrl(/\/v?rooms\//),r=O.testUrl(/\/v?hotel\//);if(t||r){var a=O.dom("h1.zen-roomspage-title-name").text();if(!a){var n=O.dom("h1.hotel-header-title").remove(".preferred").text();a=O.string(n).trim().end()}return a?O.getParamsFromPage({dateIn:"qubit_event.page_checkin_date",dateOut:"qubit_event.page_checkout_date",city:"qubit_event.page_city",country:"qubit_event.page_country",adults:"qubit_event.page_adults",currency:"qubit_event.product_currency"}).then((function(t){O.setType("hotel",e);var r=[a];t.city&&t.country?O.array(r).unshift(a+" "+t.city+" "+t.country):t.city?O.array(r).unshift(a+" "+t.city):t.country&&O.array(r).unshift(a+" "+t.country),O.setParam("query",r,e),O.setParam("adults",t.adults,e),O.setParam("currency",t.currency,e);var n=O.matchTemplate(t.dateIn,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateIn",n,e);var i=O.matchTemplate(t.dateOut,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");O.setParam("dateOut",i,e)})):void 0}O.pageClear(e)}}},changePage:{query:{css:"h1.zen-roomspage-title-name",is:"removed"},cb:function(e){O.log("page change!"),O.closeCurrentBar(),O.pageClear(e)}}},priceWatcher:{price:{query:{css:[".zen-roomspage-calltoaction-roomtypes-price-value",".rate-pricevalue",".zen-roomspagerate-price-value",".hotel-metaroom-rate-pricevalue"]},cb:function(e,t){O.array(t.added).forEach((function(t){O.array(O.dom(t).childText()).forEach((function(t){O.setPrice("price",O.preparePrice(O.string(t).replace("тыс.","000").end()),e)}))}))}}}})]),O.addSite("travel_ru","*://*.travel.ru/*",[O.details({locationCheck:[/\/hotels\?.+&hotelId=/],formWatcher:{ctr:{query:{css:[".hotel_page .hotel_page-info .hotel_page-hotel_name"]},cb:function(e){return O.getParamsFromPage({currency:"TPWLCONFIG.currency"}).then((function(t){var r=O.parseUrl(),a=O.string(t.currency||r.currency).toUpperCase().end(),n=O.string(O.dom(".hotel_page-info .hotel_page-hotel_name").remove("span").text()).trim().end();if(n||(n=r.hotelName),a&&n){O.setType("hotel",e);var i=O.matchTemplate(r.checkIn,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3");O.setParam("dateIn",i,e);var o=O.matchTemplate(r.checkOut,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3");O.setParam("dateOut",o,e);var c=[n],s=r.hotelName;s&&n!==s&&O.array(c).push(s),O.setParam("query",c,e);var l=O.dom('input[name="adults"]').value();O.setParam("adults",l,e),O.setParam("currency",a,e)}}))}}},priceWatcher:{price:{query:{css:[".hotel_page-proposals-group-list__item .hotel_proposal-price_text .currency_font"]},template:"price"}}}),O.details({locationCheck:[/\/hotel\//],formWatcher:{ctr:{query:{css:".b-av .b-av-rate_price_rub"},cb:function(e){var t=O.exec(O.dom(".b-currency-trigger button").text(),/([A-Z]{3})/);t=t&&t[1];var r=O.string(O.dom("h1.b-hotel_title").text()).trim().end();if(t&&r){var a=O.parseUrl();O.setType("hotel",e);var n=O.matchTemplate(a.in,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateIn",n,e);var i=O.matchTemplate(a.out,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateOut",i,e);var o=[r],c=O.dom(".breadcrumb > li.active > span[title]").attr("title");c&&O.array(o).push(c),O.setParam("query",o,e),O.setParam("adults",a.occ,e),O.setParam("currency",t,e)}}}},priceWatcher:{price:{query:{css:".b-av .b-av-rate_price_rub"},template:"price"}}})]),O.addSite("oktogo_ru","*://*.oktogo.ru/*",[O.details({formWatcher:{ctr:{query:{css:'.priceContainer *[data-price="period-price"] span.rub'},cb:function(e){return O.getParamsFromPage({name:"APRT_DATA.currentProduct.name",dateIn:"APRT_DATA.searchTickets.dateFrom",dateOut:"APRT_DATA.searchTickets.dateTill",adults:"APRT_DATA.searchTickets.count",currency:"currency",type:"APRT_DATA.searchTickets.type",country:"APRT_DATA.searchTickets.country",city:"APRT_DATA.searchTickets.dest"}).then((function(t){var r=O.string(t.name).trim().end();if("hotel"===t.type&&r){O.setType("hotel",e);var a=[r];t.city&&t.country?O.array(a).unshift(r+" "+t.city+" "+t.country):t.city?O.array(a).unshift(r+" "+t.city):t.country&&O.array(a).unshift(r+" "+t.country),O.setParam("query",a,e),O.setParam("currency",t.currency,e);var n=O.parseUrl();if(n.in&&n.out){var i=O.matchTemplate(n.in,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateIn",i,e);var o=O.matchTemplate(n.out,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");O.setParam("dateOut",o,e)}else O.setParam("dateIn",t.dateIn,e),O.setParam("dateOut",t.dateOut,e);n.occ?O.setParam("adults",n.occ,e):O.setParam("adults",t.adults,e)}}))}}},priceWatcher:{price:{query:{css:'.priceContainer *[data-price="period-price"] span.rub'},template:"price"}}})]),O.addSite("roomguru_ru","*://*.roomguru.ru/*",[O.details({locationCheck:[/\/hotels\//],formWatcher:{ctr:{query:{css:".Hotels-Details-HotelDetailsHeader"},cb:function(e){var t=O.exec(O.getUrl(),/\/hotels\/.+details\/(\d{4}-\d{2}-\d{2})\/(\d{4}-\d{2}-\d{2})\/(\d+)adults(?:\?|$)/),r=null,a=null,n=null;if(t&&(r=t[1],a=t[2],n=t[3]),n)return O.getParamsFromPage({country1:"R9.globals.analytics.pixelContext.destination.country",cityName1:"R9.globals.analytics.pixelContext.destination.cityName",hotelName:"R9.globals.analytics.pixelContext.hotelName",checkinDate:"R9.globals.analytics.pixelContext.checkinDate",checkoutDate:"R9.globals.analytics.pixelContext.checkoutDate",site_currency:"R9.globals.analytics.pixelContext.site_currency",cityName:"R9.globals.analytics.pixelContext.cityName",country:"R9.globals.analytics.pixelContext.country"}).then((function(t){if(O.setType("hotel",e),t.hotelName){var i=[t.hotelName],o=t.cityName1||t.cityName1;if(o){O.array(o).unshift(t.hotelName+" "+o);var c=t.country||t.country1;c&&O.array(o).unshift(t.hotelName+" "+o+" "+c)}O.setParam("query",i,e),O.setParam("adults",n,e);var s=t.checkinDate||r,l=t.checkoutDate||a;O.setParam("dateIn",s,e),O.setParam("dateOut",l,e),O.setParam("currency",t.site_currency,e)}else O.error("hotelName is empty")}));O.error("adults is empty")}}},priceWatcher:{price:{query:{css:".content-section .keel-grid .col-rates .rate-grid .booking-price"},template:"price"}}})]),O.addSite("tripadvisor_ru","*://*.tripadvisor.ru/*",[O.details({locationCheck:[/\/CheapFlightsSearchResults/],formWatcher:{ctr:{query:[{css:'[class^="flights-search-results-FlightList__recommendedList"] [class^="flights-search-results-itinerary-card-components-RightCTAColumn__price"]'}],cb:function(e){var t=O.parseUrl(),r=O.matchUrl(/airport0\.(\w{3}).*airport1\.(\w{3}).*date0\.(\d{8})(?:.*date1\.(\d{8}))?/);if(!t)return O.closeCurrentBar(),void O.pageClear(e);var a=t.airport0||r[1],n=t.airport1||r[2];if(!a||!n)return O.error("Origin or destination is empty"),O.pageClear(e);var i=t.date0||r[3],o=t.date1||r[4];i&&(i=O.matchTemplate(i,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),o&&(o=O.matchTemplate(o,/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3")),O.setType("avia",e),O.setParam("origin",a,e),O.setParam("destination",n,e),O.setParam("dateStart",i,e),O.setParam("dateEnd",o,e)}},ccy:{query:{css:'[class^="flights-search-results-itinerary-card-components-RightCTAColumn__price"]',is:"added"},cb:function(e){var t=O.dom(".footer_section .picker-label span:last-child").text();O.setParam("currency",t,e)}}},priceWatcher:{price:{query:[{css:'[class^="flights-search-results-itinerary-card-components-RightCTAColumn__price"]'}],template:"price"}}})]),O.addSite("hilton_com",["*://*.hilton.com/*","*://*.hilton.ru/*"],[O.details({locationCheck:[/\/reservation\//],formWatcher:{ctr:{query:{css:"#roomViewRegularView"},cb:function(e){var t=O.string(O.dom("h1.hotelNameNoLink").text()).trim().end(),r=O.string(O.dom(".sumOccupancy").text()).trim().end(),a=O.dom("select#changeCurrency").value();if(t&&r&&a)return O.getParamsFromPage({dateInfo:"digitalData.page.attributes.propertySearchDateInfo"}).then((function(n){if(n.dateInfo){O.setType("hotel",e);var i=[t];if(O.setParam("query",i,e),(r=O.match(r,/(\d+)/g))&&"1"==r[0]){O.setParam("adults",r[1],e),O.setParam("currency",a,e);var o=O.string(n.dateInfo).split(":"),c=o&&o[1];c=O.matchTemplate(c,/(\d{2})(\d{2})(\d{4})/,"$3-$1-$2"),O.setParam("dateIn",c,e);var s=o&&o[2];s=O.matchTemplate(s,/(\d{2})(\d{2})(\d{4})/,"$3-$1-$2"),O.setParam("dateOut",s,e)}}}))}}},priceWatcher:{price:{query:{css:".priceamount-wrapper .priceamount"},cb:function(e,t){O.array(t.added).forEach((function(t){var r=O.dom(t).remove("del").text();O.setPrice("oneDayPrice",O.preparePrice(r),e)}))}}}})]),O.addSite("marriott_com","*://*.marriott.com/*",[O.details({locationCheck:[/\/reservation\//],formWatcher:{ctr:{query:{css:".results-container"},cb:function(e){return O.getParamsFromPage({dataLayer:"dataLayer"}).then((function(t){if(t.dataLayer&&!(t.dataLayer.numRooms>1)){O.setType("hotel",e);var r=t.dataLayer.prop_name,a=[r];t.dataLayer.prop_address_city&&O.array(a).unshift(r+" "+t.dataLayer.prop_address_city),O.setParam("query",a,e);var n=t.dataLayer.search_number_guest;O.setParam("adults",n,e);var i=null;i||(i=(i=O.exec(O.dom(".m-pricing-block span.t-nightly").text(),/([A-Z]{3})\//))&&i[1]),i||(i=(i=O.exec(O.dom("head").html(),/tm_currency_type\s*:\s*"(\w{3})"/))&&i[1]),i||(i=t.dataLayer.prop_currency_type),O.setParam("currency",i,e);var o=t.dataLayer.chckInDat;o=O.matchTemplate(o,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$1-$2"),O.setParam("dateIn",o,e);var c=t.dataLayer.chckOutDate;c=O.matchTemplate(c,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$1-$2"),O.setParam("dateOut",c,e),O.setParam("dayCount",t.dataLayer.res_stay_length,e)}}))}}},priceWatcher:{price:{query:{css:".results-container .t-price"},template:"price",key:"oneDayPrice"}}})]),O.addSite("hostelworld_com","*://*.hostelworld.com/*",[O.details({locationCheck:[/\/hosteldetails/],formWatcher:{ctr:{query:{css:"#availability"},cb:function(e){return O.getParamsFromPage({dataLayer:"dataLayer",currency:"AppState.currency.browsingCurrency"}).then((function(t){if(O.array(t.dataLayer).len()){var r=O.array(t.dataLayer).filter((function(e){return e&&"production"===e.gtmApplicationEnv})).pop(),a=r.gtmPropertyName,n=O.dom('input[name="city"]').value(),i=O.dom('input[name="country"]').value(),o=[];n&&i?O.array(o).push(O.array([a,n,i]).join(" ")):n?O.array(o).push(O.array([a,n]).join(" ")):i&&O.array(o).push(O.array([a,i]).join(" ")),O.array(o).push(a),O.setParam("dateIn",r.gtmArrivalDate,e),O.setParam("dateOut",r.gtmDepartureDate,e),O.setParam("adults",r.gtmTotalGuestCount,e),O.setParam("dayCount",r.gtmTotalGuestCount,e),O.setType("hotel",e),O.setParam("query",o,e),O.setParam("currency",t.currency,e)}}))}}},priceWatcher:{price:{query:{css:".table-availability tr > td .average-price .rate-type-price"},template:"price",key:"oneDayPrice"}}})]),O.addSite("tiket_com","*://*.tiket.com/*",[O.details({locationCheck:[/\/hotel\//],formWatcher:{ctr:{query:{css:["#hotel-detail"]},cb:function(e){return O.getParamsFromPage({hotelName:"__INITIAL_STATE__.hotel.detail.result.data.name",hotelCity:"__INITIAL_STATE__.hotel.detail.result.data.city.name"}).then((function(t){O.setType("hotel",e);var r=O.parseUrl(),a=r.room;if(1===O.parseInt(a)){var n=t.hotelName;n||(n=O.string(O.dom(".hotel-summary-review h1").text()).trim().end());var i=[n],o=t.hotelCity;o&&O.array(i).unshift(n+" "+o),O.setParam("query",i,e);var c=r.checkin||t.hotel.checkinDate;O.setParam("dateIn",c,e);var s=r.checkout||t.hotel.checkoutDate;O.setParam("dateOut",s,e);var l=r.adult;O.setParam("adults",l,e),"total_price"===O.dom("input.tix-d-none").value()?O.setParam("dayCount",1,e):O.setParam("dayCount",0,e)}}))}},ccy:{query:{css:"#room-list .rc-price .tix-text-orange"},cb:function(e,t){O.array(t.added).some((function(t){var r=O.dom(t).text(),a=O.exec(r,/^([A-Z]{3})\s/);if(a)return O.setParam("currency",a[1],e),!0}))}}},priceWatcher:{price:{query:{css:"#room-list .rc-price .tix-text-orange"},template:"price",key:"oneDayPrice"}}})]),O.addSite("hotelsclick_com","*://*.hotelsclick.com/*",[O.details({formWatcher:{ctr:{query:{css:"#minpricetop .tot",is:"added"},cb:function(e){var t=O.dom('select[name="roomtype"]').value(),r=O.dom('input[name="rooms"]').value()||1,a=O.object({DBC:3,DBL:2,EXTRA:1,JRS:2,QUD:4,SGL:1,STR:2,TRC:4,TRP:3,TSU:1,TWC:3,TWN:2}).prop(t);if(a&&1==r){var n=O.dom('.sidebar input[name="from"]').value(),i=O.dom('.sidebar input[name="to"]').value();O.setType("hotel",e);var o=[],c=O.string(O.dom('.title_cnt .name h1 span[itemprop="name"]').text()).trim().end();if(c){O.array(o).push(c);var s=O.string(O.dom(".title_cnt .address > a").text()).trim().end();if(s){var l=O.array(O.string(s).split("-")).slice(-1).get(0);l&&O.array(o).unshift(c+" "+l)}}var u=O.dom('input[name="currency"]').value();O.setParam("query",o,e),O.setParam("dateIn",n,e),O.setParam("dateOut",i,e),O.setParam("adults",a,e),O.setParam("currency",u,e)}}}},priceWatcher:{price:{query:{css:"#minpricetop .tot"},template:"price"}}})]),O.addSite("hotelscombined_com","*://*.hotelscombined.com/*",[O.details({locationCheck:[/\/Hotel\//],formWatcher:{ctr:{query:{css:".hc-ratesmatrix"},cb:function(e){var t=O.string(O.dom("h1.hc_htl_intro_name").text()).trim().end();if(t||(t=O.string(O.dom("h1.hc-hotelheading__name").text()).trim().end()),t){var r=O.parseUrl(),a=r.adults_1,n=O.exec(r.destination,/place:(.+)/);n=n&&O.string(n[1]).trim().end();var i=[t];return n&&O.array(i).unshift(t+" "+n),O.getParamsFromPage({fields:"HC.Common.fields",gCurrencyCode:"gCurrencyCode"}).then((function(t){var r=t.fields,n=t.gCurrencyCode;r&&n&&(O.setType("hotel",e),O.setParam("query",i,e),O.setParam("adults",a,e),O.setParam("dateIn",r.checkin,e),O.setParam("dateOut",r.checkout,e),O.setParam("currency",n,e))}))}}}},priceWatcher:{price:{query:{css:".hc-ratesmatrix .hc-ratesmatrix__dealsrow .hc-ratesmatrix__pricecol  .hc-ratesmatrix__roomrate"},template:"price"}}})]),O.addSite("airasia_com","*://*.airasia.com/*",[O.details({locationCheck:[/airasia\.com\/select\//],formWatcher:{ctr:{query:{css:".booking-summary-content .amount-text"},cb:function(e){var t=O.matchUrl(/\/select\/[^\/]+\/[^\/]+\/([A-Z]{3})\/([A-Z]{3})\/(\d{4}-\d{2}-\d{2})\/(?:(\d{4}-\d{2}-\d{2})|N)\/\d\/\d\/\d\/[A-Z]\/[A-Z]\/([A-Z]{3})\/[A-Z]+/);if(!t)return O.closeCurrentBar(),void O.pageClear(e);O.setType("avia",e);var r=t[1],a=t[2],n=t[3],i=t[4],o=t[5];O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",n,e),O.setParam("dateEnd",i,e),O.setParam("currency",o,e)}}},priceWatcher:{minPriceOut:{query:{css:"#flight-0 .airasia-flight-schedule .fare-amount"},template:"price",key:"minPriceOut"},minPriceIn:{query:{css:"#flight-1 .airasia-flight-schedule .fare-amount"},template:"price",key:"minPriceIn"}}}),O.details({locationCheck:[/flybeyond\.airasia\.com/],formWatcher:{ctr:{query:{css:".transition-results"},cb:function(e){return O.getParamsFromPage({currency:"__INITIAL_STATE__.staticData.languageInfo.currency",searchForm:{path:"window.eval",args:['var node = document.querySelector("div[class^=SimpleFormWrapperstyled__SimpleFormWrapper-sc-]");var key = Object.keys(node).filter(v=>v.indexOf("__reactInternalInstance") === 0)[0];var result = Object.assign({}, node[key].child.pendingProps.searchForm);var formatDate = function(date) {return [date.getFullYear(), date.getMonth() + 1, date.getDate()].map(function(i) {return (i < 10 ? "0" : "") + i; }).join("-")};result.outboundDate = {from: formatDate(result.outboundDate.from)};result.inboundDate.to && (result.inboundDate = {to: formatDate(result.inboundDate.to)});result;']}}).then((function(t){var r=O.string(t.currency).toUpperCase().end(),a=t.searchForm,n=null;a.outboundDate&&(n=a.outboundDate.from);var i=null;a.inboundDate&&(i=a.inboundDate.to);var o=null;if(a.origin&&a.origin.places&&1===a.origin.places.length){var c=O.array(a.origin.places).get(0);c.value&&(o=c.value.code)}var s=null;if(a.destination&&a.destination.places&&1===a.destination.places.length){var l=O.array(a.destination.places).get(0);l.value&&(s=l.value.code)}O.setType("avia",e),O.setParam("origin",o,e),O.setParam("destination",s,e),O.setParam("dateStart",n,e),O.setParam("dateEnd",i,e),O.setParam("currency",r,e)}))}}},priceWatcher:{minPriceOut:{query:{css:".transition-results span[class^=ResultCardstyled__Discount] .length-5"},template:"price"}}})]),O.addSite("ryanair_com","*://*.ryanair.com/*",[O.details({formWatcher:{changePage:{query:{css:".flight-list",is:"removed"},cb:function(e){O.log("page change!"),O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:{css:"journey flight-list"},cb:function(e){var t=O.parseUrl();O.setType("avia",e),O.setParam("origin",t.originIata,e),O.setParam("destination",t.destinationIata,e),O.setParam("dateStart",t.dateOut,e),O.setParam("dateEnd",t.dateIn,e),O.setParam("extra.ref",O.getUrl(),e);var r=O.string(O.dom(".price__symbol").text()).trim().end(),a=O.findCurrency(r);O.setParam("currency",a,e)}}},priceWatcher:{minPriceOut:{query:{css:"journey-container[outbound] flight-card .price-value"},template:"price",key:"minPriceOut"},minPriceIn:{query:{css:"journey-container[inbound] flight-card .price-value"},template:"price",key:"minPriceIn"}}})]),O.addSite("avis_com",["*://*.avis.*/*","*://*.avisrussia.ru/*"],[O.details({locationCheck:[/\/car-results/],formWatcher:{ctr:{query:{css:".car-result-module .actions a.continue",is:"added"},cb:function(e){var t=O.string(O.dom(".car-result-module .actions a.continue").attr("href")).trim().end(),r=O.parseUrl(t);if(!r)return O.closeCurrentBar(),void O.pageClear(e);var a=r.pickupLocation,n=r.returnLocation||a,i=O.matchTemplate(r.pickupDateTime,/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5"),o=O.matchTemplate(r.returnDateTime,/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5"),c=O.array(O.string(O.dom(".header .car-results-from").text()).trim().match(/[A-Z]{3}/)).get(0);O.setType("cars",e),O.setParam("pickUpLocationId",a,e),O.setParam("pickUpDate",i,e),O.setParam("dropOffLocationId",n,e),O.setParam("dropOffDate",o,e),O.setParam("driverAge",30,e),O.setParam("currency",c,e)}}},priceWatcher:{price:{query:{css:".car-result-module .price .forPNPL"},template:"price"}},onShow:function(e){O.dom(".navbar.navbar-fixed-top").style("top",e+"px")},onHide:function(){O.dom(".navbar.navbar-fixed-top").style("top",0)}}),O.details({locationCheck:[/\/car-extras/],formWatcher:{ctr:{query:{css:".basket-item.totals .total-price b",is:"added"},cb:function(e){var t=O.parseUrl();if(!t)return O.closeCurrentBar(),void O.pageClear(e);var r=t.pickupLocation,a=t.returnLocation||r,n=O.matchTemplate(t.pickupDateTime,/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5"),i=O.matchTemplate(t.returnDateTime,/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5"),o=O.string(O.dom(".extras-custom-selectbox").attr("data-currency")).trim().end();O.setType("cars",e),O.setParam("pickUpLocationId",r,e),O.setParam("pickUpDate",n,e),O.setParam("dropOffLocationId",a,e),O.setParam("dropOffDate",i,e),O.setParam("driverAge",30,e),O.setParam("currency",o,e)}}},priceWatcher:{price:{query:{css:".basket-item.totals .total-price b"},template:"price"}},onShow:function(e){O.dom(".navbar.navbar-fixed-top").style("top",e+"px")},onHide:function(){O.dom(".navbar.navbar-fixed-top").style("top",0)}})]),O.addSite("budget_com","*://*.budget.com/*",[O.details({locationCheck:[/\/home\.ex|\/reservation/],formWatcher:{ctr:{query:{css:".row.available-car-box"},cb:function(e){return O.setType("cars",e),O.getParamsFromPage({reservationModel:"sessionStorage.ngStorage-reservationModel"}).then((function(t){var r=O.jsonParse(t.reservationModel);if(r){if(O.setParam("pickUpLocationId",r.pickInfo,e),O.setParam("dropOffLocationId",r.dropInfo||r.pickInfo,e),r.personalInfoRQ&&O.setParam("driverAge",r.personalInfoRQ.age,e),r.userSelectedCurrency)O.setParam("currency",r.userSelectedCurrency,e);else{var a=O.dom('a[ng-bind="vm.userCurrency"]').text();O.setParam("currency",a,e)}var n=O.convertTime12to24(r.pickUpTime),i=r.pickUpDate;i&&n&&O.setParam("pickUpDate",i+"T"+n,e);var o=O.convertTime12to24(r.dropTime),c=r.dropDate;o&&c&&O.setParam("dropOffDate",c+"T"+o,e)}else O.pageClear(e)}))}}},priceWatcher:{price:{query:{css:".row.available-car-box .payamntr"},template:"price"}}})]),O.addSite("wizzair_com","*://*.wizzair.com/*",[O.details({formWatcher:{ctr:{query:{css:"#booking-flow-step-select-flight",is:"added"},cb:function(e){O.setType("avia",e);var t=O.matchUrl(/\/booking\/select-flight\/([A-Z]{3})\/([A-Z]{3})\/(\d{4}-\d{2}-\d{2})\/(\d{4}-\d{2}-\d{2}|null)\/(\d+)\/(\d+)\/(\d+)/);if(t){O.setParam("origin",t[1],e),O.setParam("destination",t[2],e),O.setParam("dateStart",t[3],e);var r=t[4];"null"===r&&(r=null),O.setParam("dateEnd",r,e)}}},ccy:{query:{css:".flight-select__flight-date-picker__day__price",is:"added"},cb:function(e,t){var r=null;O.array(t.added).some((function(e){return r=O.findCurrency(e.textContent)})),r&&O.setParam("currency",r,e)}},changePage:{query:{css:"#booking-flow-step-select-flight",is:"removed"},cb:function(e){O.log("page change!"),O.closeCurrentBar(),O.pageClear(e)}}},priceWatcher:{priceOut:{query:{css:"#outbound-fare-selector .fare-type-button__title"},template:"price",key:"minPriceOut"},priceIn:{query:{css:"#return-fare-selector .fare-type-button__title"},template:"price",key:"minPriceIn"}},onShow:function(e){O.dom("aside.booking-flow__itinerary").style("top",e+"px"),O.dom("div.booking-flow__sticky-header").style("top",e+"px")},onHide:function(){O.dom("aside.booking-flow__itinerary").style("top",0),O.dom("div.booking-flow__sticky-header").style("top",0)}})]),O.addSite("emirates_com","*://*.emirates.com/*",[O.details({locationCheck:[/\/SelectPrice\.aspx/],formWatcher:{ctr:{query:{css:"#ctl00_c_dvOBBResult"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({dataLayer:"dataLayer",dateStart:"flightDateOutIBE",dateEnd:"flightDateBackIBE"}).then((function(t){var r=null;if(O.array(t.dataLayer).some((function(e){if(e.flightRoute)return r=e,!0})),r){if(O.array(O.string(r.flightRoute).split("-")).len()>3)return;var a=t.dateEnd;t.dateStart===a&&(a=null),O.setParam("origin",r.originSearchIBE,e),O.setParam("destination",r.destinationSearchIBE,e),O.setParam("dateStart",t.dateStart||r.flightDepartureDate,e),O.setParam("dateEnd",a||r.flightReturnDate,e),O.setParam("currency",r.posCurrencyCode,e)}}))}}},priceWatcher:{minPriceOut:{query:{css:".ts-fbr-flight-list.outbound-list .flights-row .ts-fbr-option__price-detail .ts-fbr-option__price[data-from]"},template:"price",key:"minPriceOut"},minPriceIn:{query:{css:".ts-fbr-flight-list.inbound-list .flights-row .ts-fbr-option__price-detail .ts-fbr-option__price[data-from]"},template:"price",key:"minPriceIn"}}})]),O.addSite("delta_com","*://*.delta.com/*",[O.details({locationCheck:[/\/flight-search\/search-results/],formWatcher:{ctr:{query:{css:".flightResultTable"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({segments:"delta.shoppingLite.searchCriteria.request.segments",tripType:"delta.shoppingLite.searchCriteria.request.tripType",shopType:"delta.shoppingLite.searchCriteria.request.shopType",pageName:"delta.shoppingLite.searchCriteria.request.pageName",currencyCode:"delta.shoppingLite.currencyCode"}).then((function(t){if("FLIGHT_SEARCH"!==t.pageName)return O.log("Unsupported pageName"),void O.closeCurrentBar();if("MONEY"!==t.shopType)return O.log("Unsupported shopType"),void O.closeCurrentBar();if(-1===O.array(["ROUND_TRIP","ONE_WAY"]).indexOf(t.tripType))return O.log("Unsupported tripType"),void O.closeCurrentBar();var r=t.segments[0];r&&(O.setParam("origin",r.origin,e),O.setParam("destination",r.destination,e),O.setParam("dateStart",r.departureDate,e),O.setParam("dateEnd",r.returnDate,e)),O.setParam("currency",t.currencyCode,e)}))}}},priceWatcher:{price:{query:{css:".flightResultTableHolder .flightResultTable .priceHolder"},template:"price"}}}),O.details({locationCheck:[/\/flight-search-2\/search-results/,/\/flight-search-2\/search-shop/],formWatcher:{ctr:{query:{css:".flightcardtable"},cb:function(e){return O.setType("avia",e),O.waitUntil((function(){return O.getParamsFromPage({pageName:"idp.shoppingLite.searchCriteria.request.pageName"}).then((function(e){return"FLIGHT_SEARCH"===e.pageName}))})).then((function(){return O.getParamsFromPage({segments:"idp.shoppingLite.searchCriteria.request.segments",tripType:"idp.shoppingLite.searchCriteria.request.tripType",shopType:"idp.shoppingLite.searchCriteria.request.shopType",pageName:"idp.shoppingLite.searchCriteria.request.pageName",currencyCode:"idp.shoppingLite.currencyCode"}).then((function(t){if("FLIGHT_SEARCH"!==t.pageName)return O.log("Unsupported pageName"),void O.closeCurrentBar();if("MONEY"!==t.shopType)return O.log("Unsupported shopType"),void O.closeCurrentBar();if(-1===O.array(["ROUND_TRIP","ONE_WAY"]).indexOf(t.tripType))return O.log("Unsupported tripType"),void O.closeCurrentBar();var r=t.segments[0];r&&(O.setParam("origin",r.origin,e),O.setParam("destination",r.destination,e),O.setParam("dateStart",r.departureDate,e),O.setParam("dateEnd",r.returnDate,e)),O.setParam("currency",t.currencyCode,e)}))}))}}},priceWatcher:{price:{query:{css:".flightcardContainer .farecellitem .farecellinkcontainer"},template:"price"}}})]),O.addSite("etihad_com","*://booking.etihad.com/*",[O.details({locationCheck:[/\/webqtrip\.html/],formWatcher:{ctr:{query:{css:".flight-list .flc-table"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({journey:"digitalData.flightSearchData.airSearchCriteria.journey",itineraryAirportPairs:"digitalData.flightSearchData.airSearchCriteria.itineraryAirportPairs"}).then((function(t){if(!t.itineraryAirportPairs||O.array(t.itineraryAirportPairs).len()<1||O.array(t.itineraryAirportPairs).len()>2)return O.closeCurrentBar(),void O.pageClear(e);var r,a=O.array(t.itineraryAirportPairs).get(0),n=O.array(t.itineraryAirportPairs).get(1);if(a&&n&&(a.arrivalCode!==n.departureCode||n.arrivalCode!==a.departureCode))return O.pageClear(e),void O.closeCurrentBar();O.setType("avia",e);var i=a.arrivalCode,o=a.departureCode,c=O.matchTemplate(a.date,/(\d{4})\/(\d{2})\/(\d{2})/,"$1-$2-$3");n&&(r=O.matchTemplate(n.date,/(\d{4})\/(\d{2})\/(\d{2})/,"$1-$2-$3"));var s=O.dom("#dtcontainer-bundled .flc-table .prices-currency").text();O.setParam("origin",i,e),O.setParam("destination",o,e),O.setParam("dateStart",c,e),O.setParam("dateEnd",r,e),O.setParam("currency",s,e)}))}}},priceWatcher:{price:{query:{css:".flight-list .flc-table .prices-amount"},template:"price"}}})]),O.addSite("tutu_ru","*://*.tutu.ru/*",[O.details({locationCheck:[/avia\.tutu\.ru\/offers\//],formWatcher:{clearPage:{query:{css:".l-result_list",is:"removed"},cb:function(e){O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:{css:".l-result_list"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({from:"params.page.searchData.from",to:"params.page.searchData.to",date:"params.page.searchData.date",currency:"exchangeParams.currency"}).then((function(t){if(!t.date||O.array(t.date).len()<1||O.array(t.date).len()>2)return O.log("Unsupported tripType"),O.closeCurrentBar(),void O.pageClear(e);var r=O.array(t.from).get(0),a=O.array(t.from).get(1),n=O.array(t.to).get(0),i=O.array(t.to).get(1);if(r&&n&&a&&i&&(r.code!==i.code||a.code!==n.code))return O.pageClear(e),void O.closeCurrentBar();var o=r.code,c=n.code,s=O.array(t.date).get(0);s=O.matchTemplate(s,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");var l=O.array(t.date).get(1);l=O.matchTemplate(l,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1"),O.setParam("origin",o,e),O.setParam("destination",c,e),O.setParam("dateStart",s,e),O.setParam("dateEnd",l,e),O.setParam("currency",t.currency,e)}))}}},priceWatcher:{price:{query:{css:".l-result_list .rm-rzlt_block .rzlt_bott .rm-title"},template:"price"}},bodySelector:".l-wrapper",onAddStyle:function(e,t){e.layer&&O.object(e.layer).prop("zIndex","2147483645"),e.body&&O.object(e.body).prop("zIndex","2147483645")}})]),O.addSite("uralairlines_ru","*://*.uralairlines.ru/*",[O.details({locationCheck:[/book\.uralairlines\.ru\//],formWatcher:{ctr:{query:{css:".flight-select-container #flight-to"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({flightModelJson:"sessionStorage.vuejs__booking:flight-model",currentCurrencyJson:"sessionStorage.vuejs__config:currentCurrency"}).then((function(t){var r=null,a=null,n=O.jsonParse(t.flightModelJson),i=O.jsonParse(t.currentCurrencyJson);if(n&&i&&(a=n.value,r=i.value),!a||!a.to||!a.from)return O.closeCurrentBar(),void O.pageClear(e);var o=a.to.departure,c=a.to.arrival,s=a.to.selectedDate;s=O.matchTemplate(s,/^(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3");var l=a.from.selectedDate;l&&(l=O.matchTemplate(l,/^(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3")),O.setParam("origin",o,e),O.setParam("destination",c,e),O.setParam("dateStart",s,e),O.setParam("dateEnd",l,e),O.setParam("currency",r,e)}))}}},priceWatcher:{priceTo:{query:{css:".flight-select-container #flight-to ~ .flights-list-container .flight .price"},template:"price",key:"minPriceOut"},priceFrom:{query:{css:".flight-select-container #flight-from ~ .flights-list-container .flight .price"},template:"price",key:"minPriceIn"}}})]),O.addSite("flyredwings_com","*://*.flyredwings.com/*",[O.details({locationCheck:[/avia\.flyredwings\.com\/avia\/result\//],formWatcher:{ctr:{query:{css:".results .results-flight"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({results:{path:"window.eval",args:['var node = document.querySelector(".results");var key = Object.keys(node).filter(v=>v.indexOf("__reactInternalInstance") === 0)[0];var result = node[key].return.pendingProps;result;']}}).then((function(t){var r=t.results;if(!r)return O.error("results is empty"),O.pageClear(e),void O.closeCurrentBar();var a=null,n=null,i=null,o=null,c=r.searchSegment;c&&(a=c.departure,n=c.arrival,i=O.matchTemplate(c.departureDate,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3"),c.returnDate&&(o=O.matchTemplate(c.returnDate,/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-$3")));var s=null;r.variants&&O.array(r.variants).some((function(e){if(e.total_price)return s=e.total_price.currency,!0})),O.setParam("origin",a,e),O.setParam("destination",n,e),O.setParam("dateStart",i,e),O.setParam("dateEnd",o,e),O.setParam("currency",s,e)}))}}},priceWatcher:{price:{query:{css:".results__flight-thither .card .results-brands-button__price .price"},template:"price"}}})]),O.addSite("airastana_com","*://*.airastana.com/*",[O.details({locationCheck:[/booking\.airastana\.com\//],formWatcher:{ctr:{query:[{css:"#tpl3_bound0-bound-table"},{css:"#tpl3_calendar-matrix"}],cb:function(e){return O.getParamsFromPage({city_search_out:"eBaDataLayer.city_search_out",city_search_in:"eBaDataLayer.city_search_in",date_search_out:"eBaDataLayer.date_search_out",date_search_in:"eBaDataLayer.date_search_in",currency:"eBaDataLayer.currency"}).then((function(t){var r=t.city_search_out,a=t.city_search_in,n=O.matchTemplate(t.date_search_out,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1"),i=null;t.date_search_in&&(i=O.matchTemplate(t.date_search_in,/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1"));var o=t.currency;O.setType("avia",e),O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",n,e),O.setParam("dateEnd",i,e),O.setParam("currency",o,e)}))}}},priceWatcher:{price:{query:{css:"#tpl3_bound0-bound-table .availability-group-cell-price"},template:"price"},priceReco:{query:{css:"#tpl3_bound0-bound-table .bound-table-flightline .cell-reco-price"},template:"price"},priceCal:{query:{css:"#tpl3_calendar-matrix .calendarmatrix-inner-cell.selected .calendarmatrix-price .price-amount"},template:"price"}}})]),O.addSite("airmoldova_md","*://*.airmoldova.md/*",[O.details({locationCheck:[/airmoldova\.md\//],formWatcher:{ctr:{query:{css:".tickets-container"},cb:function(e){return O.setType("avia",e),O.getParamsFromPage({origin:"search.originCode",destination:"search.destinCode",dateStart:"search.departure",dateEnd:"search.return",currency:"prices.currency",numJourneys:"search.numJourneys"}).then((function(t){var r=t.origin,a=t.destination,n=t.dateStart;n=O.matchTemplate(n,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1");var i=null;2===t.numJourneys&&t.dateEnd&&(i=t.dateEnd,i=O.matchTemplate(i,/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1")),O.setParam("origin",r,e),O.setParam("destination",a,e),O.setParam("dateStart",n,e),O.setParam("dateEnd",i,e),O.setParam("currency",t.currency,e)}))}}},priceWatcher:{priceOut:{query:{css:".flight-container:nth-child(1) .tickets-container .ticket .price-value"},template:"price",key:"minPriceOut"},priceIn:{query:{css:".flight-container:nth-child(1) ~ .flight-container .tickets-container .ticket .price-value"},template:"price",key:"minPriceIn"}}})]),O.addSite("hertz_com","*://*.hertz.com/*",[O.details({locationCheck:[/\/rentacar\/reservation\//],formWatcher:{changePage:{query:[{css:"#itn-location",is:"added"}],cb:function(e){O.closeCurrentBar(),O.pageClear(e)}},ctr:{query:{css:"#res-vehicles-page"},cb:function(e){return O.setType("cars",e),O.getParamsFromPage({pickup_date:"htz.homepage.json.data.model.formData.pickupDay",pickup_time:"htz.homepage.json.data.model.formData.pickupTime",return_date:"htz.homepage.json.data.model.formData.dropoffDay",return_time:"htz.homepage.json.data.model.formData.dropoffTime",pickup_location:"htz.homepage.json.data.model.formData.pickupHiddenEOAG",return_location:"htz.homepage.json.data.model.formData.dropoffHiddenEOAG",age:"htz.homepage.json.data.model.formData.ageSelector",militaryClock:"htz.homepage.json.data.model.formData.militaryClock"}).then((function(t){O.setParam("pickUpLocationId",O.string(t.pickup_location).substr(0,3).end(),e);var r=t.pickup_date+"T"+t.pickup_time,a=t.return_date+"T"+t.return_time;t.militaryClock?(r=O.matchTemplate(r,/(\d{2})\/(\d{2})\/(\d{4})T(\d{2}):(\d{2})/,"$3-$2-$1T$4:$5"),a=O.matchTemplate(a,/(\d{2})\/(\d{2})\/(\d{4})T(\d{2}):(\d{2})/,"$3-$2-$1T$4:$5")):(r=O.matchTemplate(r,/(\d{2})\/(\d{2})\/(\d{4})T(\d{2}):(\d{2})/,"$3-$1-$2T$4:$5"),a=O.matchTemplate(a,/(\d{2})\/(\d{2})\/(\d{4})T(\d{2}):(\d{2})/,"$3-$1-$2T$4:$5")),O.setParam("pickUpDate",r,e);var n=t.return_location;n||(n=t.pickup_location),O.setParam("dropOffLocationId",O.string(n).substr(0,3).end(),e),O.setParam("dropOffDate",a,e),O.setParam("driverAge",t.age,e)}))}},ccy:{query:{css:"#res-vehicles-page .price-wrapper",is:"added"},cb:function(e,t){!O.getParam("currency",e)&&O.array(t.added).some((function(t){var r=O.dom(t).find(".price + span").text();if(r)return O.setParam("currency",r,e),!0}))}}},priceWatcher:{price:{query:{css:"#res-vehicles-page .price-wrapper",is:"added"},cb:function(e,t){O.array(t.added).forEach((function(t){var r,a=O.dom(t).find(".rate").len(),n=O.dom(t).find(".approx-total-price").text();r=a&&n?O.preparePrice(n):O.preparePrice(O.dom(t).find(".price").text());var i=O.dom(t).find(".price + span").text();r&&i&&O.getParam("currency",e)===i&&O.setPrice("price",r,e)}))}}}})]),O.addSite("europcar_com","*://*.europcar.com/*",[O.details({locationCheck:[/\/DotcarClient\/step2\.action/],formWatcher:{ctr:{query:{css:"#contents .main-content",is:"added"},cb:function(e){return O.setType("cars",e),O.getParamsFromPage({pickup_date:"tc_vars.select_checkout_date",pickup_time:"tc_vars.select_checkout_time",return_date:"tc_vars.select_checkin_date",return_time:"tc_vars.select_checkin_time",pickup_location:"tc_vars.select_checkout_station_code",return_location:"tc_vars.select_checkin_station_code"}).then((function(t){O.setParam("pickUpLocationId",O.string(t.pickup_location).substr(0,3).end(),e);var r=O.matchTemplate(t.pickup_date+"T"+t.pickup_time,/(\d{4})(\d{2})(\d{2})T(\d{2})h(\d{2})/,"$1-$2-$3T$4:$5");O.setParam("pickUpDate",r,e);var a=t.return_location;a||(a=t.pickup_location),O.setParam("dropOffLocationId",O.string(a).substr(0,3).end(),e);var n=O.matchTemplate(t.return_date+"T"+t.return_time,/(\d{4})(\d{2})(\d{2})T(\d{2})h(\d{2})/,"$1-$2-$3T$4:$5");O.setParam("dropOffDate",n,e);var i=O.dom('select[name="driverAge"]').value();i>26&&(i=26),O.setParam("driverAge",i,e);var o=null;O.dom().getAll(".vehicle-block .price-info .price").some((function(e){var t=O.exec(O.dom(e).text(),/([A-Z]{3})/);if(t)return o=t[1],!0})),O.setParam("currency",o,e)}))}}},priceWatcher:{price:{query:{css:"#contents .main-content ul .vehicle-block .price-info .price"},template:"price"}}})]);var N,E,L,R,q,W,M,B=function(e,t){var r;if(t)r=I(t);else{var a=O.getSitePatternObj(),n=e.pattern,i=a[n];if(!i)throw k.error("Template is not found!",n),new l("Template is not found!");r=i()}Array.isArray(r)||(r=[r]);var o=null;return r.some((function(e){return e.locationCheck?e.locationCheck(location.href)?(o=e,!0):void 0:(o=e,!0)})),o},$=("uk"===(N=function(){var e="";return s.getUILanguage&&(e=s.getUILanguage()),e||(e=navigator.language),e&&"string"==typeof e||(e="en"),e.toLowerCase().substr(0,2)}())&&(N="ru"),(E={ru:{lang:"ru",foundOneWay:"Найден билет дешевле",foundTwoWay:"Билеты дешевле",view:"Посмотреть",origin:"Туда:",destination:"Обратно:",close:"Закрыть",foundHotel:"Найдена лучшая цена",aroundHotel:"Рядом есть отель лучше",checkIn:"Дата заезда:",checkOut:"Дата отъезда:",inMonth:"в %month%",calLabel:"Выгодное предложение!",suggests:"Ещё отели",foundCars:"Забронируй со скидкой!",carsView:"Сэкономить",e1_foundOneWay:"Есть билеты дешевле",e1_view:"Сэкономить",e2_foundHotel:"Хотите сэкономить?",e2_pricePre:"за",e2_view:"Забронировать дешевле"},en:{lang:"en",foundOneWay:"Found a better price",foundTwoWay:"Better price",view:"Learn more",origin:"Depart:",destination:"Return:",close:"Close",foundHotel:"Found a better price",aroundHotel:"Found a better hotel around",checkIn:"Check-in:",checkOut:"Check-out:",inMonth:"in %month%",calLabel:"Get a better deal!",suggests:"More hotels",foundCars:"Get discount on booking!",carsView:"Book now!"}})[N]||E.en),F=function(e){var t=!1,r={};for(var a in e){var n=/^extra\.(.+)$/.exec(a);n&&(t=!0,r[n[1]]=e[a])}return t?r:null},U=function(){var e=k.main,t={},r=function(e,t){var r=null;return t.price?r=t.price:t.minPriceOut&&t.minPriceIn?r=t.minPriceOut+t.minPriceIn:t.minPriceOut?r=t.minPriceOut:t.minPriceIn&&(r=t.minPriceIn),r},a=function(t){return function(e){var t={origin:e.origin,destination:e.destination,depart_date:e.dateStart,return_date:e.dateEnd,currency:e.currency,locale:k.language.lang,partnerId:k.appInfo.id};return e.extra&&(t.extra=e.extra),_.request({url:"https://api.travelbar.tools/v1/avia/prices?"+_.param(t)}).then((function(e){var t=JSON.parse(e.body);if(!(t&&t.success&&t.currency&&Array.isArray(t.data)))throw k.error("API is not success!",e.body),new l("AVIA_BACK_FAIL");return t}))}(t).then((function(r){return(a=r.data,n=r.currency,i=t.currency,o=n.toUpperCase(),c=i.toUpperCase(),o===c?Promise.resolve():e.currency.load().then((function(){if(!e.currency.exists(c)||!e.currency.exists(o))throw k.error("Currency is not support!",c,o),new l("CCY_NOT_SUPPORT");a.forEach((function(t){t.converted_value=e.currency.convert(t.value,o,c)}))}))).then((function(){return r}));var a,n,i,o,c}))};return{getCityName:function(e){return Promise.all([t.cityMap?Promise.resolve():_.request({url:"https://api.travelbar.tools/v1/tp/data/cities.json?"+_.param({partnerId:k.appInfo.id})}).then((function(e){var r=JSON.parse(e.body),a={};r.forEach((function(e){e.code&&e.name&&(a[e.code]={name:e.name,name_translations:e.name_translations})})),t.cityMap=a})),t.airportCityCodeMap?Promise.resolve():_.request({url:"https://api.travelbar.tools/v1/tp/data/airports.json?"+_.param({partnerId:k.appInfo.id})}).then((function(e){var r=JSON.parse(e.body),a={};r.forEach((function(e){e.code&&e.city_code&&(a[e.code]=e.city_code)})),t.airportCityCodeMap=a}))]).then((function(){var r=null,a=t.cityMap[e];return a||(e=t.airportCityCodeMap[e],a=t.cityMap[e]),a&&(r=a.name_translations&&a.name_translations[k.language.lang]||a.name),r}))},onGetData:function(t){if(k.log("Info",t),t.barRequestData)k.log("Data from API was requested, before. Skip");else{t.barRequestData=!0;var r=e.bar.current;r&&e.watcher.clearInfoObj(t),k.emit("track",{cd:"flightrequestdata",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"requestData",el:k.siteTag,cd:"flightrequestdata",t:"event"});e.bar.isAborted=!1,a(t).then((function(r){if(e.bar.isAborted)throw new l("REQUEST_ABORTED");var a,n,i=(a=r.data,n=null,a.forEach((function(e){var t=e.converted_value||e.value;(null===n||n>t)&&(n=t)})),n);if(null===i)throw k.error("Low price is not found!",t.price),new l("LOW_PRICE_IS_NOT_FOUND");k.emit("track",{cd:"flightresponsedata",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"responseData",el:k.siteTag,cd:"flightresponsedata",t:"event"}),e.bar.aviaBarSaveInHistory(t,r);var o=i>=t.price;if(o&&k.log("Has lower price!",i,t.price),k.appInfo.debug&&(o=!1),o)throw new l("betterPrice");return e.bar.create({type:"avia",prices:r,pageInfo:t})})).catch((function(e){e instanceof l?k.log(e.message):(k.error(e),k.trackError(e)),r&&r.close(),function(e){var t="discard",r=e.message;"betterPrice"===r&&(t=r),k.emit("track",{ec:"cheapflight",ea:t,el:k.siteTag,t:"event"})}(e)}))}},page:{getData:function(e,t){var a={origin:e.origin,destination:e.destination,dateStart:e.dateStart,dateEnd:e.dateEnd,currency:e.currency,price:r(0,t)},n=F(e);return n&&(a.extra=JSON.stringify(n)),["origin","destination","dateStart","currency","price"].every((function(e){return!!a[e]}))?a:null},getPriceId:function(e){var t=[];return["origin","destination","dateStart","dateEnd","currency"].every((function(r){var a=e[r];return t.push(a),"dateEnd"===r||!!a}))?t.join(";"):null}}}},j=function(){var e=k.main,t=function(e,t){var r=null;if(t.price)r=t.price;else if(t.oneDayPrice&&e.dayCount)r=t.oneDayPrice*e.dayCount;else if(t.oneDayPrice&&e.dateIn&&e.dateOut){var a=new Date(e.dateIn),n=new Date(e.dateOut),i=Math.round((n.getTime()-a.getTime())/24/60/60/1e3);r=t.oneDayPrice*i}return r},r=function(e){var t=Promise.reject(),r=null;return e.query.forEach((function(a,n){t=t.catch((function(){return function(e,t){var r={hotel_name:e.query[t],checkIn:e.dateIn,checkOut:e.dateOut,adults:e.adults,currency:e.currency,locale:k.language.lang,partnerId:k.appInfo.id};return e.extra&&(r.extra=e.extra),_.request({url:"https://api.travelbar.tools/v1/hotel/prices?"+_.param(r)}).then((function(e){var t=JSON.parse(e.body);if(!(t&&t.success&&t.currency&&Array.isArray(t.data)))throw k.error("API is not success!",e.body),new l("HOTEL_BACK_FAIL");return t}))}(e,n).then((function(e){if(!e.hasTarget)throw r=e,new Error("Target is not exists!");return e}))}))})),t=t.catch((function(e){if(!r)throw e;return r}))},a=function(t){return r(t).then((function(r){return(a=r.data,n=r.currency,i=t.currency,o=n.toUpperCase(),c=i.toUpperCase(),o===c?Promise.resolve():e.currency.load().then((function(){if(!e.currency.exists(c)||!e.currency.exists(o))throw k.error("Currency is not support!",c,o),new l("CCY_NOT_SUPPORT");a.forEach((function(t){t.converted_value=e.currency.convert(t.value,o,c)}))}))).then((function(){return r}));var a,n,i,o,c}))};return{onGetData:function(t){if(k.log("Info",t),t.barRequestData)k.log("Data from API was requested, before. Skip");else{t.barRequestData=!0;var r=e.bar.current;r&&e.watcher.clearInfoObj(t);k.emit("track",{cd:"hotelrequestdata",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"requestData",el:k.siteTag,cd:"hotelrequestdata",t:"event"}),e.bar.isAborted=!1,a(t).then((function(r){if(e.bar.isAborted)throw new l("REQUEST_ABORTED");k.emit("track",{cd:"hotelresponsedata",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"responseData",el:k.siteTag,cd:"hotelresponsedata",t:"event"});var a,n,i,o=(a=r.data,n=null,i=null,a.forEach((function(e){var t=e.converted_value||e.value;e.isSuggest?(null===i||t<i)&&(i=t):(null===n||t<n)&&(n=t)})),[n,i]),c=o[0],s=o[1],u=t.price+.2*t.price,d=c&&c<t.price,p=!1,f=!1;if(d||(f=p=s&&s<u),d||f||k.log("Has low price!",o,t.price),k.appInfo.debug&&(c?d=!0:f&&(f=p=!0)),!d&&!f)throw new l("betterPrice");return e.bar.create({type:"hotel",showSuggestPrice:p,prices:r,pageInfo:t})})).catch((function(e){e instanceof l?k.log(e.message):(k.error(e),k.trackError(e)),r&&r.close(),function(e){var t="discard",r=e.message;"betterPrice"===r&&(t=r),k.emit("track",{ec:"hotel",ea:t,el:k.siteTag,t:"event"})}(e)}))}},page:{getData:function(e,r){var a={query:e.query,dateIn:e.dateIn,dateOut:e.dateOut,currency:e.currency,adults:e.adults,price:t(e,r)},n=F(e);return n&&(a.extra=JSON.stringify(n)),["query","dateIn","dateOut","currency","adults","price"].every((function(e){return!!a[e]}))?a:null},getPriceId:function(e){var t=[];return["dateIn","dateOut","currency","adults"].every((function(r){var a=e[r];return t.push(a),!!a}))?t.join(";"):null}}}},z=function(){var e=k.main,t=function(e,t){var r=null;return t.price&&(r=t.price),r},r=function(t){return function(e){var t={pickUpLocationId:e.pickUpLocationId,pickUpDate:e.pickUpDate,dropOffLocationId:e.dropOffLocationId,dropOffDate:e.dropOffDate,driverAge:e.driverAge,currency:e.currency,locale:k.language.lang,partnerId:k.appInfo.id};return e.extra&&(t.extra=e.extra),_.request({url:"https://api.travelbar.tools/v1/cars/prices?"+_.param(t)}).then((function(e){var t=JSON.parse(e.body);if(!(t&&t.success&&t.currency&&Array.isArray(t.data)))throw k.error("API is not success!",e.body),new l("CARS_BACK_FAIL");return t}))}(t).then((function(r){return(a=r.data,n=r.currency,i=t.currency,o=n.toUpperCase(),c=i.toUpperCase(),o===c?Promise.resolve():e.currency.load().then((function(){if(!e.currency.exists(c)||!e.currency.exists(o))throw k.error("Currency is not support!",c,o),new l("CCY_NOT_SUPPORT");a.forEach((function(t){t.converted_value=e.currency.convert(t.value,o,c)}))}))).then((function(){return r}));var a,n,i,o,c}))};return{onGetData:function(t){if(k.log("Info",t),t.barRequestData)k.log("Data from API was requested, before. Skip");else{t.barRequestData=!0;var a=e.bar.current;a&&e.watcher.clearInfoObj(t);k.emit("track",{cd:"carsrequestdata",t:"screenview"}),k.emit("track",{ec:"cars",ea:"requestData",el:k.siteTag,cd:"carsrequestdata",t:"event"}),e.bar.isAborted=!1,r(t).then((function(r){if(e.bar.isAborted)throw new l("REQUEST_ABORTED");var a,n,i=(a=r.data,n=null,a.forEach((function(e){var t=e.converted_value||e.value;(null===n||n>t)&&(n=t)})),n);if(null===i)throw k.error("Low price is not found!",t.price),new l("LOW_PRICE_IS_NOT_FOUND");k.emit("track",{cd:"carsresponsedata",t:"screenview"}),k.emit("track",{ec:"cars",ea:"responseData",el:k.siteTag,cd:"carsresponsedata",t:"event"});var o=i>=t.price;if(o&&k.log("Has lower price!",i,t.price),k.appInfo.debug&&(o=!1),o)throw new l("betterPrice");return e.bar.create({type:"cars",prices:r,pageInfo:t})})).catch((function(e){e instanceof l?k.log(e.message):(k.error(e),k.trackError(e)),a&&a.close(),function(e){var t="discard",r=e.message;"betterPrice"===r&&(t=r),k.emit("track",{ec:"cars",ea:t,el:k.siteTag,t:"event"})}(e)}))}},page:{getData:function(e,r){var a={pickUpLocationId:e.pickUpLocationId,pickUpDate:e.pickUpDate,dropOffLocationId:e.dropOffLocationId,dropOffDate:e.dropOffDate,driverAge:e.driverAge,currency:e.currency,price:t(0,r)},n=F(e);return n&&(a.extra=JSON.stringify(n)),["pickUpLocationId","pickUpDate","dropOffLocationId","dropOffDate","driverAge","currency","price"].every((function(e){return!!a[e]}))?a:null},getPriceId:function(e){var t=[];return["pickUpLocationId","pickUpDate","dropOffLocationId","dropOffDate","driverAge","currency"].every((function(r){var a=e[r];return t.push(a),!!a}))?t.join(";"):null}}}},H=[].slice,J=function(e,t){var r,a,n=document.createElement(e);for(var i in t)a=t[i],(r=G[i])?r(n,a):n[i]=a;return n},G={class:function(e,t){t.forEach((function(t){e.classList.add(t)}))},style:function(e,t){for(var r in t){var a=t[r];"float"===r&&(r="cssFloat"),e.style[r]=a}}},V=function(){function e(t,r){Object(o.a)(this,e);var a;this.wDom=t,this.node=r,this.refNode=r.cloneNode(!1),this.events=[],this.customStyle={},this.inlineStyle={},this.cssStyle=null,this.nativeStyle={},this.checkStyles=[],this.fixLimits={};for(var n,i=0;n=r.childNodes[i];i++)a=this.wDom.wGet(n),this.refNode.appendChild(a.refNode)}return Object(a.a)(e,[{key:"setCheckStyles",value:function(e){this.checkStyles=e}},{key:"addCheckStyles",value:function(e){-1===this.checkStyles.indexOf(e)&&this.checkStyles.push(e)}},{key:"removeCheckStyles",value:function(e){var t=this.checkStyles.indexOf(e);-1!==t&&this.checkStyles.splice(t,1)}},{key:"appendChild",value:function(e){var t=this.wDom.wGet(e);this.refNode.appendChild(t.refNode),this.node.appendChild(t.node)}},{key:"insertBefore",value:function(e,t){var r=this.wDom.wGet(e),a=this.wDom.get(t);this.refNode.insertBefore(r.refNode,a.refNode),this.node.insertBefore(r.node,a.node)}},{key:"removeChild",value:function(e){var t=this.wDom.get(e);if(!t)throw new Error("wNode is not found!");this.refNode.removeChild(t.refNode),this.node.removeChild(t.node)}},{key:"setText",value:function(e){this.refNode.textContent="",this.node.textContent="",this.appendChild(document.createTextNode(e))}},{key:"setTextContent",value:function(e){this.refNode.textContent=e,this.node.textContent=e}},{key:"addEventListener",value:function(e,t,r){this.node.addEventListener(e,t,r),r=!!r,this.events.push({type:e,listener:t,useCapture:r})}},{key:"removeEventListener",value:function(e,t,r){this.node.removeEventListener(e,t,r);var a=-1;r=!!r,this.events.some((function(n,i){if(n.type===e&&n.useCapture===r&&n.listener===t)return a=i,!0})),-1!==a&&this.events.splice(a,1)}},{key:"setStyle",value:function(e,t){this.refNode.style[e]=t,this.node.style[e]=t,""===t?delete this.inlineStyle[e]:this.inlineStyle[e]=t}},{key:"setAttribute",value:function(e,t){this.refNode.setAttribute(e,t),this.node.setAttribute(e,t)}},{key:"removeAttribute",value:function(e){this.refNode.removeAttribute(e),this.node.removeAttribute(e)}},{key:"setStyleProperty",value:function(e,t,r){if(this.refNode.style.setProperty){var a=Z(e);this.refNode.style.setProperty(a,t,r),this.node.style.setProperty(a,t,r),""===t?delete this.inlineStyle[e]:this.inlineStyle[e]=t}else this.setStyle(e,t)}},{key:"addClass",value:function(e){this.refNode.classList.add(e),this.node.classList.add(e)}},{key:"removeClass",value:function(e){this.refNode.classList.remove(e),this.node.classList.remove(e)}},{key:"checkChildList",value:function(){var e=this.fixLimits,t=!0;void 0===e.checkChildList&&(e.checkChildList=50);var r,a,n,i,o=!1;for(r=0;n=this.refNode.childNodes[r];r++)a=this.wDom.getByRef(n).node,(i=this.node.childNodes[r])!==a&&(e.checkChildList>0?(i?this.node.insertBefore(a,i):this.node.appendChild(a),o=!0,k.log("Fix checkChildList insert node",a)):(t=!1,k.error("Fix checkChildList insert limited")));var c=this.refNode.childNodes.length,s=H.call(this.node.childNodes,c);if(s.length)if(e.checkChildList>0)for(r=0;a=s[r];r++)a.parentNode&&(a.parentNode.removeChild(a),o=!0,k.log("Fix checkChildList remove node",a));else t=!1,k.error("Fix checkChildList remove limited");return o&&e.checkChildList--,t}},{key:"checkAttributes",value:function(e){var t=this.fixLimits,r="checkAttributes_"+e;void 0===t[r]&&(t[r]=50);var a=!0,n=this.node.getAttribute(e),i=this.refNode.getAttribute(e);return i!==n&&(t[r]-- >0?(null===i?this.node.removeAttribute(e):this.node.setAttribute(e,i),k.log("Fix attributes",e,n,">",i)):(a=!1,k.error("Fix attributes limited"))),a}},{key:"checkCharacterData",value:function(){var e=this.fixLimits,t="checkCharacterData";void 0===e[t]&&(e[t]=50);var r=!0,a=this.node.textContent,n=this.refNode.textContent;return a!==n&&(e[t]-- >0?(this.node.textContent=this.refNode.textContent,k.log("Fix characterData",a,">",n)):(r=!1,k.error("Fix characterData limited"))),r}},{key:"fixStyleProperty",value:function(e,t,r){var a=this,n=a.fixLimits,i="fixStyleProperty"+e,o=!0;return n[i]?(o=!1,k.error("Fix styleProperty limited")):(n[i]=!0,r.forEach((function(n){a.setStyleProperty(e,n,"important"),k.log("Fix styleProperty",e,t,">",r)}))),o}},{key:"getNode",value:function(){return this.node}},{key:"buildNode",value:function(){var e,t,r,a=this.refNode.cloneNode(!1);for(e=0;r=this.refNode.childNodes[e];e++)t=this.wDom.getByRef(r),a.appendChild(t.buildNode());return this.events.forEach((function(e){a.addEventListener(e.type,e.listener,e.useCapture)})),a}}]),e}(),Z=function(e){return"cssFloat"===e&&(e="float"),e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))},Y=function(){function e(){Object(o.a)(this,e);this.wElements=[],this.refElements=[],this.elements=[]}return Object(a.a)(e,[{key:"createElement",value:function(e,t,r){for(var a,n=this,i=J(e,t),o=H.call(arguments,2),c=0;a=o[c];c++)"object"!=typeof a&&(a=document.createTextNode(a)),i.appendChild(a);return n.wGet(i)}},{key:"get",value:function(e){var t=null,r=this.elements.indexOf(e);return-1!==r&&(t=this.wElements[r]),t}},{key:"getByRef",value:function(e){var t=null,r=this.refElements.indexOf(e);return-1!==r&&(t=this.wElements[r]),t}},{key:"wrap",value:function(e){return new V(this,e)}},{key:"wGet",value:function(e){var t=this.get(e);return null===t&&(t=this.wrap(e),this.addWNode(t)),t}},{key:"addWNode",value:function(e){this.elements.push(e.node),this.refElements.push(e.refNode),this.wElements.push(e)}},{key:"removeWNode",value:function(e){var t=this.wElements.indexOf(e);-1!==t&&(this.elements.splice(t,1),this.refElements.splice(t,1),this.wElements.splice(t,1))}},{key:"destroy",value:function(){this.elements.splice(0),this.refElements.splice(0),this.wElements.splice(0)}}]),e}(),K=function(){k.log.apply(null,arguments)},Q=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},X={},ee=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=10,r="t";do{t--;for(var a=0;a<21;a++)r+=e.charAt(Math.floor(Math.random()*e.length))}while(X[r]&&t>0);return X[r]=1,r},te=(L=function(){function e(t,r,a){for(var n in Object(o.a)(this,e),this.type="conditional",this.selector=t,this.options=a,this.rules=new se(Q({},a,{parent:this})),r)this.rules.add(n,r[n]);this.rules.process()}return Object(a.a)(e,[{key:"getRule",value:function(e){return this.rules.get(e)}},{key:"indexOf",value:function(e){return this.rules.indexOf(e)}},{key:"addRule",value:function(e,t,r){var a=this.rules.add(e,t,r);return this.options.jss.plugins.onProcessRule(a),a}},{key:"toString",value:function(){var e=this.rules.toString();return e?this.selector+"{"+e+"}":""}}]),e}(),{onCreateRule:function(e,t,r){return/^@media/.test(e)?new L(e,t,r):null}}),re=(R=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},{onProcessStyle:function(e,t,r){return e.extend?function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"==typeof t.extend){if(a){var i=a.getRule(t.extend);if(i)if(i===r)K("[JSS] A rule tries to extend itself \r\n",r);else if(i.options.parent){var o=i.options.parent.rules.raw[t.extend];e(o,r,a,n)}}}else if(Array.isArray(t.extend))for(var c=0;c<t.extend.length;c++)e(t.extend[c],r,a,n);else for(var s in t.extend)"extend"===s?e(t.extend.extend,r,a,n):R(t.extend[s])?(n[s]||(n[s]={}),e(t.extend[s],r,a,n[s])):(n.hasOwnProperty(s)&&delete n[s],n[s]=t.extend[s]);for(var l in t)if("extend"!==l)if("fallbacks"===l&&n[l]){Array.isArray(n[l])||(n[l]=[n[l]]);var u=t[l];Array.isArray(u)||(u=[u]),n[l]=n[l].concat(JSON.parse(JSON.stringify(u)))}else R(n[l])&&R(t[l])?e(t[l],r,a,n[l]):R(t[l])?n[l]=e(t[l],r,a):(n.hasOwnProperty(l)&&delete n[l],n[l]=t[l]);return n}(e,t,r):e}}),ae=function(){var e=/\s*,\s*/g,t=/&/g,r=/\$([\w-]+)/g;function a(e){return function(t,r){var a=e.getRule(r);return a?a.selector:(K("[JSS] Could not find the referenced rule "+r+". \r\n",a),r)}}var n=function(e){return-1!==e.indexOf("&")};function i(r,a){for(var i=a.split(e),o=r.split(e),c="",s=0;s<i.length;s++)for(var l=i[s],u=0;u<o.length;u++){var d=o[u];c&&(c+=", "),c+=n(d)?d.replace(t,l):l+" "+d}return c}function o(e,t,r){if(r)return Q({},r,{index:r.index+1});var a=e.options.nestingLevel;return a=void 0===a?1:a+1,Q({},e.options,{nestingLevel:a,index:t.indexOf(e)+1})}return{onProcessStyle:function(e,t){if("regular"!==t.type)return e;var c=t.options.parent,s=void 0,l=void 0;for(var u in e){var d=n(u),p="@"===u[0];if(d||p){if(s=o(t,c,s),d){var f=i(u,t.selector);l||(l=a(c)),f=f.replace(r,l),c.addRule(f,e[u],Q({},s,{selector:f}))}else if(p){var h={};h[t.name]=e[u],c.addRule(u,h,s)}delete e[u]}}return e}}}(),ne=(q=/([A-Z])/g,W=function(e){return"-"+e.toLowerCase()},M=function e(t){var r={};for(var a in t){var n=t[a];"cssFloat"===a&&(a="float"),r[a=a.replace(q,W)]=n}return t.fallbacks&&(Array.isArray(t.fallbacks)?r.fallbacks=t.fallbacks.map(e):r.fallbacks=e(t.fallbacks)),r},{onProcessStyle:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)e[t]=M(e[t]);return e}return M(e)}}),ie=function(){function e(t,r,a){Object(o.a)(this,e),this.type="regular";var n=a.generateClassName;this.name=t,this.className="",this.options=a,this.style=r,a.className?this.className=a.className:n&&(this.className=n(this,a.sheet)),this.selector=a.selector||"."+this.className}return Object(a.a)(e,[{key:"toString",value:function(){return ce(this.selector,this.style)}}]),e}(),oe=function e(t){return Array.isArray(t)?Array.isArray(t[0])?e(t.map((function(e){return e.join(" ")}))):t.join(", "):t},ce=function(e,t){var r=t.fallbacks,a="";if(r)if(Array.isArray(r))for(var n=0;n<r.length;n++){var i=r[n];for(var o in i){var c=i[o];null!=c&&(a+=o+": "+oe(c)+";")}}else for(var s in r){var l=r[s];null!=l&&(a+=s+": "+oe(l)+";")}for(var u in t){var d=t[u];"function"==typeof d&&(d=t["$"+u]),null!=d&&"fallbacks"!==u&&(a+=u+": "+oe(d)+";")}return a?a=e+" {"+a+"}":a},se=function(){function e(t){Object(o.a)(this,e),this.map={},this.raw={},this.index=[],this.options=t,this.classes=t.classes}return Object(a.a)(e,[{key:"add",value:function(e,t,r){var a=this.options,n=a.parent,i=a.sheet,o=a.jss,c=a.Renderer,s=a.generateClassName;(r=Q({classes:this.classes,parent:n,sheet:i,jss:o,Renderer:c,generateClassName:s},r)).className||(r.className=this.classes[e]),this.raw[e]=t;var l=le(e,t,r);this.register(l);var u=void 0===r.index?this.index.length:r.index;return this.index.splice(u,0,l),l}},{key:"get",value:function(e){return this.map[e]}},{key:"indexOf",value:function(e){return this.index.indexOf(e)}},{key:"process",value:function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)}},{key:"register",value:function(e){e.name&&(this.map[e.name]=e),e.className&&e.name&&(this.classes[e.name]=e.className),e.selector&&(this.map[e.selector]=e)}},{key:"toString",value:function(){for(var e="",t=0;t<this.index.length;t++){var r=this.index[t].toString();r&&(e+=r)}return e}}]),e}(),le=function(e,t,r){var a=r.jss,n=function e(t){if(null==t)return t;var r=typeof t;if("string"===r||"number"===r)return t;if(Array.isArray(t))return t.map(e);var a={};for(var n in t){var i=t[n];a[n]="object"==typeof i?e(i):i}return a}(t);if(a){var i=a.plugins.onCreateRule(e,n,r);if(i)return i}return e&&"@"===e[0]&&K("[JSS] Unknown at-rule",e),new ie(e,n,r)},ue=function(){function e(t){Object(o.a)(this,e);var r="number"==typeof t.index?t.index:0;this.classes={},this.options=Q({sheet:this,parent:this,classes:this.classes,index:r},t),this.rules=new se(this.options)}return Object(a.a)(e,[{key:"addRule",value:function(e,t,r){var a=this.rules.add(e,t,r);return this.options.jss.plugins.onProcessRule(a),a}},{key:"add",value:function(e,t){return this.addRules(e,t)}},{key:"addRules",value:function(e,t){this.options.jss.onBeforeAddHooks.forEach((function(r){r(e,t)}));var r=[];for(var a in e)r.push(this.addRule(a,e[a],t));return r}},{key:"getRule",value:function(e){return this.rules.get(e)}},{key:"indexOf",value:function(e){return this.rules.indexOf(e)}},{key:"toString",value:function(){return this.rules.toString()}},{key:"sync",value:function(){this.options.jss.onChange()}}]),e}(),de=function(){function e(){Object(o.a)(this,e),this.hooks={onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[]}}return Object(a.a)(e,[{key:"onCreateRule",value:function(e,t,r){for(var a=0;a<this.hooks.onCreateRule.length;a++){var n=this.hooks.onCreateRule[a](e,t,r);if(n)return n}return null}},{key:"onProcessRule",value:function(e){if(!e.isProcessed){for(var t=e.options.sheet,r=0;r<this.hooks.onProcessRule.length;r++)this.hooks.onProcessRule[r](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}}},{key:"onProcessStyle",value:function(e,t,r){for(var a=0;a<this.hooks.onProcessStyle.length;a++)t.style=e=this.hooks.onProcessStyle[a](e,t,r)}},{key:"onProcessSheet",value:function(e){for(var t=0;t<this.hooks.onProcessSheet.length;t++)this.hooks.onProcessSheet[t](e)}},{key:"onChangeValue",value:function(e,t,r){for(var a=e,n=0;n<this.hooks.onChangeValue.length;n++)a=this.hooks.onChangeValue[n](a,t,r);return a}},{key:"use",value:function(e){for(var t in e)this.hooks[t]?this.hooks[t].push(e[t]):K("[JSS] Unknown hook",t)}}]),e}(),pe=function(){function e(){Object(o.a)(this,e),this.sheets=[],this.onBeforeAddHooks=[],this.plugins=new de,this.plugins.use(te),this.plugins.use(re),this.plugins.use(ae),this.plugins.use(ne)}return Object(a.a)(e,[{key:"getSheet",value:function(){var e=new ue({jss:this,generateClassName:ee});return this.sheets.push(e),e}},{key:"toString",value:function(){var e=[];return this.sheets.forEach((function(t){e.push(t.toString())})),e.join("")}},{key:"getStyleBySelector",value:function(e){var t={};return this.sheets.some((function(r){var a=r.rules.map[e];if(a)return t=a.style,!0})),fe(t)}},{key:"onChange",value:function(){}}]),e}(),fe=function(e){var t,r,a={},n=e.fallbacks;for(t in n&&(Array.isArray(n)||(n=[n]),n.forEach((function(e){for(var t in e)a[t]||(a[t]=[]),a[t].push(e[t])}))),e)"fallbacks"!==t&&(r=e[t],a[t]?(Array.isArray(a[t])||(a[t]=[a[t]]),a[t].push(r)):a[t]=r);return a},he=pe,me=function(){function e(t,r){Object(o.a)(this,e),this.onChange=r,this.destroyed=!1,this.bar=t,this.timer=null}return Object(a.a)(e,[{key:"start",value:function(){var e=this,t=function(){e.destroyed||(e.check(),r())},r=function(){e.stop(),e.timer=setTimeout(t,5e3)};t(),r()}},{key:"stop",value:function(){clearTimeout(this.timer)}},{key:"check",value:function(){var e=this,t=this.bar,r=this.bar.wDom,a=this.bar.wSheets;!function(t){if(t.parentNode){var n=r.get(t);if(n){var i=n.checkStyles;if(i.length){var o=ve(a,n),c=getComputedStyle(t);i.forEach((function(t){var r=c[t],a=o[t];void 0!==a&&void 0!==r&&-1===a.indexOf(r)&&e.onChange(n,t,c[t],a)}))}}else k.error("wNode is not found",t)}}(t.body.node)}},{key:"destroy",value:function(){this.destroyed=!0,this.stop()}}]),e}(),ye=function(e){var t=/(.+)!important/.exec(e);return t&&(e=t[1].trim()),e},ge=function(e){return"float"===e&&(e="cssFloat"),e.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))},ve=function(e,t){var r,a,n=null;if(!t.cssStyle){var i=t.refNode,o=i.classList[0];i&&o&&(n=e.getStyleBySelector("."+o)),t.cssStyle=n||{}}var c=[];c.unshift(t.customStyle),c.unshift(t.inlineStyle),c.unshift(t.cssStyle),c.unshift(t.nativeStyle);for(var s={};n=c.shift();)for(r in n)a=n[r],r=ge(r),Array.isArray(a)||(a=[a]),a=a.map(ye),s[r]=a;return s},be=me,_e=function(e,t){var r=new(_.mutationWatcher.getMutationObserver())((function(e){for(var r,a=0;r=e[a];a++)("attributes"===r.type||"characterData"===r.type||"childList"===r.type)&&t(r)})),a={childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0};this.disconnect=function(){r.disconnect()},this.connect=function(){r.observe(e,a)},this.start=function(){this.connect()},this.destroy=function(){this.disconnect()}},Pe=function(e,t){var r=[].slice,a=new(_.mutationWatcher.getMutationObserver())((function(a){for(var n,i=0;n=a[i];i++)if(n.removedNodes.length&&-1!==r.call(n.removedNodes).indexOf(e)){t(n);break}})),n={childList:!0};this.disconnect=function(){a.disconnect()},this.connect=function(){if(!e.parentNode)return k.error("RemoveWatcher parent is null",e);a.observe(e.parentNode,n)},this.start=function(){this.connect()},this.destroy=function(){this.disconnect()}},ke=function(){var e=k.main,t={},r=function(e,r){var a=e.wDom.wGet(e.body.node),n=document.body.parentNode;if(r){t.marginTop=n.style.marginTop,t.transition=n.style.transition,n.style.transition="margin-top 0.2s",a.removeCheckStyles("marginTop"),a.setStyle("marginTop","-55px"),a.setStyle("transition","margin-top 0.2s"),setTimeout((function(){n.style.marginTop="55px",a.setStyle("marginTop",""),n.style.setProperty&&n.style.setProperty("margin-top","55px","important"),setTimeout((function(){n.style.transition=t.transition,a.setStyle("transition","");document.addEventListener("mousemove",(function e(){document.removeEventListener("mousemove",e),setTimeout((function(){a.addCheckStyles("marginTop")}),250)}))}),250)}),0);var i=k.currentProfile.onShow;i&&i(55)}else{n.style.marginTop=t.marginTop;var o=k.currentProfile.onHide;o&&o()}},n=function(e){var t,r,a=(t=0,r=100,Math.floor(Math.random()*(r-t))+t),n=100/e,i=0;if(e>0&&n>0)for(;a>n;)a-=n,i++;return i},c=function(){function t(e){Object(o.a)(this,t);var r=this;this.hostname=k.hostname,this.siteTag=k.siteTag,this.type=e.type,this.details=e,this.isClosed=!1,this.isRemoved=!1,this.disableFontLink=!!k.currentProfile.disableFontLink,this.onBarChangeLimit=5,this.onBarChangeFired=1,this.onBarChangeStyleFired=1,this.onBarChangeStyleLimit={},this.onBarRemoveFired=1,this.container=document.createDocumentFragment(),this.styleWatcher=new be(this,(function(e,t,a,n){r.onBarChangeStyle(e,t,a,n)})),this.wDom=new Y,this.wSheets=new he,k.currentProfile.onAddStyle&&this.wSheets.onBeforeAddHooks.push((function(){var e;(e=k.currentProfile).onAddStyle.apply(e,arguments)})),this.barContent=this.getBarContent(),this.body=this.getBody(),this.content=this.getContent(),this.wDom.wGet(this.body.content).appendChild(this.content.node),this.style=this.getStyle(),k.currentProfile.onCreateBar&&k.currentProfile.onCreateBar(this),this.container.appendChild(this.body.node),this.container.appendChild(this.style.node),this.wDom.wGet(this.container),this.wDom.wGet(this.style.node);var a=function(e){r.onBarChange(e)};this.body.changeWatcher=new _e(this.body.node,a),this.body.changeWatcher.start(),this.style.changeWatcher=new _e(this.style.node,a),this.style.changeWatcher.start();var n=function(e){r.onBarRemove(e)};this.body.removeWatcher=new Pe(this.body.node,n),this.style.removeWatcher=new Pe(this.style.node,n)}return Object(a.a)(t,[{key:"onBarChange",value:function(e){var t=e.type,r=e.target,a=null,n=this.wDom.get(r);if(n){try{"attributes"===t?a=n.checkAttributes(e.attributeName):"characterData"===t?a=n.checkCharacterData():"childList"===t&&(a=n.checkChildList())}catch(e){k.error(e),k.trackError(e)}a||k.error(t,e)}else k.error("wEl not found",e)}},{key:"onBarChangeStyle",value:function(e,t,r,a){e.fixStyleProperty(t,r,a)||k.error("onBarChangeStyle",t,r,a,e)}},{key:"onBarRemove",value:function(e){k.error("removed",e),k.main.watcher.closeCurrentBar(),this.onBarRemoveFired--}},{key:"trackByVendor",value:function(e){var t=this.barContent.vendor,r={aviasales:"as",skyscanner:"sc"}[t];return r?(e.ec+="-"+r,k.emit("track",e)):k.error("Prefix is not found!",t)}},{key:"getAviaBarContent",value:function(){var e=this,t=this.details,r=t.pageInfo,a=e.wSheets.getSheet(),i=t.prices,o=i.data[function(e){var t=null,r=null;e.forEach((function(e){var a=/(\d{4}.\d{2}.\d{2})/.exec(e.depart_date);if(a){var n=a[1];(null===t||t>n)&&(t=n,r=null),n===t&&(null===r||e.value<r.value)&&(r=e)}}));var a=e.indexOf(r);return k.log("Bar item",a,r),k.log("Result prices",e),a}(i.data)];if(!o)return k.error("Bar item is not found!",t),null;var c,s=!!o.monthPrice,u=!r.dateEnd,d={value:o.converted_value||o.value,currency:r.currency,origin:o.origin,originName:o.originName,destination:o.destination,destinationName:o.destinationName,dateStart:o.depart_date,dateEnd:o.return_date,open:k.language.view,monthPrice:!!o.monthPrice,vendor:o.vendor||"aviasales",url:o.url,isCalendar:s,isOneWay:u};if(d.priceText=s?_.getPriceNode(d.currency,d.value,e.disableFontLink):_.create(document.createDocumentFragment(),{append:(c=[],r.price>d.value?(a.add({redPrice:{textDecoration:"line-through",color:"#F44336"}}),c.push(_.create("span",{class:a.classes.redPrice,append:[_.getPriceNode(d.currency,r.price,e.disableFontLink)]})),c.push(String.fromCharCode(160))):k.error("Red price is hidden",r.price,d.value),c.push(_.getPriceNode(d.currency,d.value,e.disableFontLink)),c)}),s?(d.barTitle=k.language.calLabel,d.dateText=k.language.inMonth.replace("%month%",_.getCalMonth(d.dateStart))):u?(d.barTitle=k.language.foundOneWay,d.dateText=_.getDate(d.dateStart,!0)):(d.barTitle=k.language.foundTwoWay,d.dateText=_.getDateInterval(d.dateStart,d.dateEnd)),!d.originName||!d.destinationName)throw k.error("City name is not found!",d.origin,d.destination),new l("City name is not found!");return function(e,t){if(!t.isCalendar){var r=[""];"ru"===k.language.lang&&r.push((function(){t.barTitle=k.language.e1_foundOneWay,t.open=k.language.e1_view}));var a=r[n(r.length)];a&&a()}}(0,d),d}},{key:"getHotelBarContent",value:function(){var e=this,t=this.details,r=t.pageInfo,a=function(e){var r=null,a=!!t.showSuggestPrice;e.data.filter((function(e){return a===!!e.isSuggest})).forEach((function(e){(null===r||r.value>e.value)&&(r=e)}));var n=[];return e.data.forEach((function(e){e.isSuggest&&e!==r&&n.push(e)})),{barItem:r,suggestItemList:n}}(t.prices),i=a.barItem;if(!i)return k.error("Bar item is not found!",t),null;var o=function(t){var a=!!t.isSuggest;("number"!=typeof t.stars||t<0||t.stars>5)&&(t.stars=0);var n={name:t.name,stars:t.stars,value:t.converted_value||t.value,currency:r.currency,dateIn:r.dateIn,dateOut:r.dateOut,open:k.language.view,url:t.deeplink,isSuggest:a};return n.priceText=_.getPriceNode(n.currency,n.value,e.disableFontLink),n.barTitle=a?k.language.aroundHotel:k.language.foundHotel,n.dateText=_.getDateInterval(n.dateIn,n.dateOut),n},c=o(i);return c.suggestList=a.suggestItemList.map(o),c.suggestList.sort((function(e,t){return e.value<t.value?-1:1})),function(e,t,r){if(!t.isSuggest){var a=[""];"ru"===k.language.lang&&a.push((function(){t.barTitle=k.language.e2_foundHotel,t.priceText=_.create(document.createDocumentFragment(),{append:[k.language.e2_pricePre+" ",_.getPriceNode(t.currency,t.value,r.disableFontLink)]}),t.open=k.language.e2_view}));var i=a[n(a.length)];i&&i()}}(0,c,this),c}},{key:"getCarsBarContent",value:function(){var e=this,t=this.details,r=t.pageInfo,a=t.prices,n=e.wSheets.getSheet(),i=function(e){var t=null;return e.forEach((function(e){(!t||t.value>e.value)&&(t=e)})),t}(a.data);if(!i)return k.error("Bar item is not found!",t),null;var o,c={value:i.converted_value||i.value,currency:r.currency,vehicleName:i.vehicleName,pickUpLocName:i.pickUpLocName,pickUpLocCode:i.pickUpLocCode,pickUpDate:i.pickUpDate,dropOffLocName:i.dropOffLocName,dropOffLocCode:i.dropOffLocCode,dropOffDate:i.dropOffDate,url:i.url};return c.priceText=_.create(document.createDocumentFragment(),{append:(o=[],r.price>c.value?(n.add({redPrice:{textDecoration:"line-through",color:"#F44336"}}),o.push(_.create("span",{class:n.classes.redPrice,append:[_.getPriceNode(c.currency,r.price,e.disableFontLink)]})),o.push(String.fromCharCode(160))):k.error("Red price is hidden",r.price,c.value),o.push(_.getPriceNode(c.currency,c.value,e.disableFontLink)),o)}),c.pickUpText=c.pickUpLocName,c.pickUpLocCode&&(c.pickUpText+=", "+c.pickUpLocCode),c.dropOffText=c.dropOffLocName,c.dropOffLocCode&&(c.dropOffText+=", "+c.dropOffLocCode),c.isOnePoint=c.pickUpText===c.dropOffText,c.isOnePoint?c.dateText=_.getDateInterval(c.pickUpDate,c.dropOffDate):(c.pickUpDateText=_.getDate(c.pickUpDate,!0),c.dropOffDateText=_.getDate(c.dropOffDate,!0)),c.barTitle=k.language.foundCars,c.open=k.language.carsView,c}},{key:"getBarContent",value:function(){return"avia"===this.type?this.getAviaBarContent():"hotel"===this.type?this.getHotelBarContent():"cars"===this.type?this.getCarsBarContent():void 0}},{key:"insertAviaBar",value:function(){var e=this,t=e.wSheets.getSheet(),r=this.barContent,a=document.createDocumentFragment();t.add({cell:{fallbacks:{display:"inline-block"}}}),t.add({title:{extend:"cell",fontSize:"20px",fontWeight:"bold",margin:"auto 10px",lineHeight:"23px",verticalAlign:"middle"},"@media only screen and (max-width: 1150px)":{title:{fontSize:"18px"}},"@media only screen and (max-width: 1050px)":{title:{fontSize:"14px",marginLeft:"5px",marginRight:"5px"}}}),a.appendChild(_.create("div",{class:t.classes.title,append:[r.barTitle]})),t.add({flightInfoCell:{extend:"cell",fallbacks:{display:"-webkit-flex",WebkitFlexGrow:2},display:"flex",flexGrow:2,verticalAlign:"middle",overflow:"hidden"}});var n=_.create("div",{class:t.classes.flightInfoCell});a.appendChild(n),t.add({info:{extend:"cell",fallbacks:{display:"-webkit-flex"},display:"flex",height:"38px",border:"1px solid rgba(0,0,0,0.10)",margin:"auto 10px",borderRadius:"19px",padding:"0 15px",overflow:"hidden"},"@media only screen and (max-width: 1050px)":{info:{marginLeft:"5px",marginRight:"5px",paddingLeft:"5px",paddingRight:"5px"}}});var i=_.create("div",{class:t.classes.info});n.appendChild(i),t.add({point:{display:"inline-block",verticalAlign:"middle",margin:"auto 0",textOverflow:"ellipsis",color:"#000",fontWeight:"bold",fontSize:"14px",overflow:"hidden"}});var o=function(e){return _.create("div",{class:t.classes.point,title:e,text:e})};t.add({flightWrapper:{extend:"cell",fallbacks:{display:"-webkit-flex"},display:"flex",verticalAlign:"middle",overflow:"hidden",margin:"auto 0",lineHeight:"36px"}});var c=_.create("div",{class:t.classes.flightWrapper});i.appendChild(c),c.appendChild(o(r.originName)),t.add({wayIcon:{display:"inline-block",verticalAlign:"middle",margin:"auto 6px","& svg":{display:"block",opacity:"0.4"}}});var s;s=r.isOneWay?this.getOneWaySvg():this.getTwoWaySvg(),c.appendChild(_.create("div",{class:t.classes.wayIcon,append:s})),c.appendChild(o(r.destinationName)),t.add({dates:{extend:"cell",verticalAlign:"middle",margin:"auto 0 auto 10px",fontSize:"14px",color:"#978f6c"},"@media only screen and (max-width: 1050px)":{dates:{marginLeft:"5px",marginRight:"5px"}}});var l=_.create("div",{class:t.classes.dates});i.appendChild(l),l.appendChild(document.createTextNode(r.dateText)),t.add({price:{verticalAlign:"middle",fontSize:"20px",fontWeight:"bold",margin:"auto 10px",lineHeight:"23px",color:"#4b9f00","& *":{fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit"}},"@media only screen and (max-width: 1050px)":{price:{fontSize:"16px",marginLeft:"5px",marginRight:"5px"}}}),a.appendChild(_.create("div",{class:t.classes.price,append:[r.priceText]})),t.add({openBtn:{extend:"cell",verticalAlign:"middle",fontSize:"16px",fontWeight:"bold",color:"#FFF !important",margin:"auto 10px",padding:"10px 25px",backgroundColor:"#4b9f00 !important",borderRadius:"19px",textDecoration:"none !important","&:hover":{backgroundColor:"#66ad26 !important",color:"#FFF !important"}},"@media only screen and (max-width: 1050px)":{openBtn:{fontSize:"14px",marginLeft:"5px",marginRight:"5px",paddingLeft:"10px",paddingRight:"10px"}}});var u=_.create("a",{class:t.classes.openBtn,href:r.url,target:"_blank",append:[r.open]});_.jsLink(u,(function(t){e.content.onClick()}));return a.appendChild(u),{node:a,moreBtn:u,moreBtnClick:function(){window.open(r.url),e.content.onClick()},onAppend:function(){k.emit("track",{cd:"flightshow",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"show",el:e.siteTag,cd:"flightshow",t:"event"}),r.isCalendar?k.emit("track",{cd:"flight_calendar_show",t:"screenview"}):(e.trackByVendor({ec:"cheapflight",ea:"show",el:e.siteTag,cd:"flightshow",t:"event"}),k.emit("track",{cd:"flight_betterprice_show",t:"screenview"}))},onReplace:function(){k.emit("track",{ec:"cheapflight",ea:"update",el:e.siteTag,t:"event"}),r.isCalendar?k.emit("track",{cd:"flight_calendar_update",t:"screenview"}):(e.trackByVendor({ec:"cheapflight",ea:"update",el:e.siteTag,t:"event"}),k.emit("track",{cd:"flight_betterprice_update",t:"screenview"}))},onShow:function(){r.isCalendar&&k.emit("track",{ec:"cheapflight",ea:"calendarPrice",el:e.siteTag,t:"event"})},onClick:function(){k.emit("track",{cd:"flightclick",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"click",el:e.siteTag,cd:"flightclick",t:"event"}),r.isCalendar?(k.emit("track",{cd:"flight_calendar_click",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"calendarclick",el:e.siteTag,cd:"flight_calendar_click",t:"event"})):(k.emit("track",{cd:"flight_betterprice_click",t:"screenview"}),k.emit("track",{ec:"cheapflight",ea:"betterpriceclick",el:e.siteTag,cd:"flight_betterprice_click",t:"event"}),e.trackByVendor({ec:"cheapflight",ea:"betterpriceclick",el:e.siteTag,cd:"flight_betterprice_click",t:"event"}))},onClose:function(){k.emit("track",{ec:"cheapflight",ea:"close",el:e.siteTag,t:"event"}),e.trackByVendor({ec:"cheapflight",ea:"close",el:e.siteTag,t:"event"})}}}},{key:"insertCarsBar",value:function(){var e=this,t=e.wSheets.getSheet(),r=this.barContent,a=document.createDocumentFragment();t.add({cell:{fallbacks:{display:"inline-block"},verticalAlign:"middle",margin:"auto 5px"}}),t.add({title:{extend:"cell",fontSize:"20px",margin:"auto 10px"},"@media only screen and (max-width: 1150px)":{title:{fontSize:"18px"}},"@media only screen and (max-width: 1050px)":{title:{fontSize:"14px",fontWeight:"bold",marginLeft:"5px",marginRight:"5px"}}}),a.appendChild(_.create("div",{class:t.classes.title,append:[r.barTitle]})),t.add({pointCell:{extend:"cell",fallbacks:{display:"-webkit-flex",WebkitFlexDirection:"column"},display:"flex",flexDirection:"column"}}),r.isOnePoint?(t.add({lineDateCell:{color:"#666"}}),a.appendChild(_.create("div",{class:t.classes.pointCell,append:[_.create("div",{text:r.pickUpText}),_.create("div",{class:t.classes.lineDateCell,text:r.dateText})]}))):(a.appendChild(_.create("div",{class:t.classes.pointCell,append:[_.create("div",{text:r.pickUpText}),_.create("div",{text:r.dropOffText})]})),t.add({dateCellPoint:{extend:"cell",fallbacks:{display:"-webkit-flex",WebkitFlexDirection:"column"},display:"flex",flexDirection:"column",marginLeft:0,color:"#666"}}),a.appendChild(_.create("div",{class:t.classes.dateCellPoint,append:[_.create("div",{text:r.pickUpDateText}),_.create("div",{text:r.dropOffDateText})]}))),t.add({carCell:{extend:"cell",fallbacks:{WebkitFlexGrow:1},flexGrow:1,margin:"auto 10px",fontWeight:"bold",fontSize:"18px",overflow:"hidden","& span":{textOverflow:"ellipsis",overflow:"hidden"}},"@media only screen and (max-width: 1050px)":{carCell:{fontSize:"14px",marginLeft:"5px",marginRight:"5px"}}});var n=_.create("div",{class:t.classes.carCell,append:[_.create("span",{text:r.vehicleName})]});a.appendChild(n),t.add({price:{extend:"cell",fontSize:"20px",fontWeight:"bold",color:"#4b9f00","& *":{fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit"}},"@media only screen and (max-width: 1050px)":{price:{fontSize:"16px"}}}),a.appendChild(_.create("div",{class:t.classes.price,append:[r.priceText]})),t.add({openBtn:{extend:"cell",fontSize:"16px",color:"#FFF !important",padding:"10px 20px",backgroundColor:"#4b9f00 !important",borderRadius:"19px",textDecoration:"none !important","&:hover":{backgroundColor:"#66ad26 !important",color:"#FFF !important"}},"@media only screen and (max-width: 1050px)":{openBtn:{fontSize:"14px",paddingLeft:"10px",paddingRight:"10px"}}});var i=_.create("a",{class:t.classes.openBtn,href:r.url,target:"_blank",append:[r.open]});_.jsLink(i,(function(t){e.content.onClick()}));return a.appendChild(i),{node:a,moreBtn:i,moreBtnClick:function(){window.open(r.url),e.content.onClick()},onAppend:function(){k.emit("track",{cd:"carsshow",t:"screenview"}),k.emit("track",{ec:"cars",ea:"show",el:e.siteTag,cd:"carsshow",t:"event"})},onReplace:function(){k.emit("track",{ec:"cars",ea:"update",el:e.siteTag,t:"event"})},onShow:function(){},onClick:function(){k.emit("track",{cd:"carsclick",t:"screenview"}),k.emit("track",{ec:"cars",ea:"click",el:e.siteTag,cd:"carsclick",t:"event"})},onClose:function(){k.emit("track",{ec:"cars",ea:"close",el:e.siteTag,t:"event"})}}}},{key:"getHotelSuggests",value:function(e){var t=this,r=t.wDom,a=function(a){var n=t.wSheets.getSheet(),i=function(){var e=function(e){var t,r=(t=e.getBoundingClientRect(),{top:Math.round(t.top),left:Math.round(t.left+window.pageXOffset)}),a=function(e){return{width:e.offsetWidth,height:e.offsetHeight}}(e),n=r.top+a.height;return{width:720,height:480,right:10,top:n+=18}}(a),t=r.wGet(o);t.setStyle("width",e.width+"px"),t.setStyle("maxHeight",e.height+"px"),t.setStyle("right",e.right+"px"),t.setStyle("top",e.top+"px")};n.add({layer:{display:"block",backgroundColor:"#fff",padding:"30px 0",margin:0,overflow:"auto",boxSizing:"border-box",border:"1px solid #ccc",boxShadow:"0 10px 20px rgba(0,0,0,.4)",position:"fixed",zIndex:"2147483647",cursor:"default"}});var o=_.create("div",{class:n.classes.layer,on:["click",function(e){e.stopPropagation()}]});n.add({layerClose:{display:"block",position:"absolute",top:"5px",right:"5px",opacity:"0.3","&:hover":{opacity:"0.7"}}}),o.appendChild(_.create("a",{class:n.classes.layerClose,href:"#tbr-suggests-close",title:k.language.close,append:[_.create(t.getCloseSvg("20"))],on:["click",function(e){e.preventDefault(),e.stopPropagation(),e.isTrusted&&p()}]}));var c=o.appendChild(_.create("div"));n.add({suggest:{display:"table",width:"100%",height:"40px",fontSize:"15px",padding:"0 30px",boxSizing:"border-box",cursor:"pointer","&:hover":{backgroundColor:"#fcefb4"}},suggestCell:{display:"table-cell",width:"100px",verticalAlign:"middle",padding:"0 5px",textAlign:"center"},suggestName:{extend:"suggestCell",width:"auto",textAlign:"left"},suggestStars:{extend:"suggestCell",width:"90px",paddingTop:"2px"},suggestDate:{extend:"suggestCell",width:"150px",fontSize:"14px",color:"#4a4a4a"},suggestPrice:{extend:"suggestCell",fontWeight:"bold"},suggestOpenBtn:{padding:"6px 15px",color:"#fff !important",backgroundColor:"#4b9f00",borderRadius:"3px",textDecoration:"none",fontWeight:"normal",whiteSpace:"pre","&:hover":{backgroundColor:"#66ad26 !important"}}}),e.slice(0,6).forEach((function(e){for(var r,a=_.create("span"),i=0;i<e.stars;i++)a.appendChild((r=void 0,r={},void 0&&(r.verticalAlign="text-bottom"),_.create(t.getStarSvg("#F0BE22","16"),{style:r})));c.appendChild(_.create("div",{class:n.classes.suggest,on:["click",function(t){t.stopPropagation(),t.preventDefault(),window.open(e.url),l()}],append:[_.create("div",{class:n.classes.suggestName,text:e.name}),_.create("div",{class:n.classes.suggestStars,append:[a]}),_.create("div",{class:n.classes.suggestDate,text:e.dateText}),_.create("div",{class:n.classes.suggestPrice,append:[e.priceText]}),_.create("div",{class:n.classes.suggestCell,append:[_.jsLink(_.create("a",{class:n.classes.suggestOpenBtn,target:"_blank",href:e.url,text:e.open}),(function(e){l()}))]})]}))}));var s=document.createDocumentFragment();s.appendChild(o),r.wGet(t.body.node).appendChild(s);var l=function(){k.emit("track",{cd:"hotelclick",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"suggestClick",el:t.siteTag,cd:"hotelclick",t:"event"})},u=function e(){document.body.removeEventListener("click",e),p()},d=function(){f.show=!0,document.body.addEventListener("click",u),r.wGet(o).setStyle("display","block"),i(),k.emit("track",{ec:"hotel",ea:"suggestsShow",el:t.siteTag,cd:"hotelshow",t:"event"})},p=function(){f.show=!1,r.wGet(o).setStyle("display","none"),clearTimeout(h)},f={show:!0,toggle:function(){"none"===o.style.display?d():p()}};n.sync(),d();var h=null;return function(e){e.addEventListener("mouseenter",(function(){clearTimeout(h)})),e.addEventListener("mouseleave",(function(){clearTimeout(h),h=setTimeout((function(){f.show&&p()}),1500)}))}(o),f};return function(){var e=t.wSheets.getSheet();e.add({cell:{fallbacks:{display:"inline-block"}}}),e.add({moreBtn:{extend:"cell",verticalAlign:"middle",fontSize:"14px",fontWeight:"normal !important",color:"#000 !important",margin:"auto 5px",padding:"8px 18px",backgroundColor:"rgba(255, 255, 255, 0.30) !important",borderRadius:"19px",boxShadow:"0 0 1px rgba(0,0,0,0.40)",textDecoration:"none !important","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.70) !important",color:"#000 !important"}},"@media only screen and (max-width: 1050px)":{moreBtn:{fontSize:"12px",marginLeft:"2px",marginRight:"2px",paddingLeft:"7px",paddingRight:"7px"}}});var r,n=null,i=!1,o=function(){n?i||n.toggle():n=a(c)},c=_.create("a",{class:e.classes.moreBtn,href:"#tbr-suggests",append:[k.language.suggests],on:["click",function(e){e.preventDefault(),e.stopPropagation(),clearTimeout(s),o()}]}),s=null;return(r=c).addEventListener("mouseenter",(function(){clearTimeout(s),s=setTimeout((function(){n&&n.show||(o(),clearTimeout(i),i=setTimeout((function(){i=!1}),500))}),250)})),r.addEventListener("mouseleave",(function(){clearTimeout(s)})),c}()}},{key:"insertHotelBar",value:function(){var e=this,t=e.wSheets.getSheet(),r=this.barContent,a=document.createDocumentFragment();t.add({cell:{fallbacks:{display:"inline-block"}}}),t.add({title:{extend:"cell",fontSize:"20px",fontWeight:"bold",margin:"auto 10px",lineHeight:"23px",verticalAlign:"middle"},"@media only screen and (max-width: 1150px)":{title:{fontSize:"18px"}},"@media only screen and (max-width: 1050px)":{title:{fontSize:"14px",marginLeft:"5px",marginRight:"5px"}}}),a.appendChild(_.create("div",{class:t.classes.title,append:[r.barTitle]})),t.add({hotelInfoCell:{extend:"cell",fallbacks:{display:"-webkit-flex",WebkitFlexGrow:2},display:"flex",flexGrow:2,verticalAlign:"middle",overflow:"hidden"}});var n=_.create("div",{class:t.classes.hotelInfoCell});a.appendChild(n);var i=function(t){var r={};return t&&(r.verticalAlign="text-bottom"),_.create(e.getStarSvg(null,"16"),{style:r})};t.add({starsFull:{display:"inline-block",verticalAlign:"middle",margin:"auto 0",marginTop:"3px"},"@media only screen and (max-width: 1050px)":{starsFull:{display:"none"}}});for(var o=_.create("span",{class:t.classes.starsFull}),c=0;c<r.stars;c++)o.appendChild(i());t.add({info:{extend:"cell",fallbacks:{display:"-webkit-flex"},display:"flex",height:"38px",border:"1px solid rgba(0,0,0,0.10)",margin:"auto 10px",borderRadius:"19px",padding:"0 15px",boxSizing:"border-box",lineHeight:"36px",overflow:"hidden"},hotel:{textOverflow:"ellipsis",margin:"auto",color:"#000",fontWeight:"bold",fontSize:"14px",overflow:"hidden"},"@media only screen and (max-width: 1050px)":{info:{marginLeft:"5px",marginRight:"5px",paddingLeft:"5px",paddingRight:"5px"}}});var s=_.create("div",{class:t.classes.info,append:[_.create("span",{class:t.classes.hotel,title:r.name+function(){for(var e="",t=0;t<r.stars;t++)e+=String.fromCharCode(9733);return e&&(e=" "+e),e}(),text:r.name})]});if(n.appendChild(s),s.appendChild(o),r.stars>0){t.add({starsShort:{display:"none",verticalAlign:"middle",margin:"auto 0 auto 5px"},"@media only screen and (max-width: 1050px)":{starsShort:{display:"inline-block"}}});var l=_.create("span",{class:t.classes.starsShort,append:[r.stars,i(!0)]});s.appendChild(l)}t.add({dates:{extend:"cell",verticalAlign:"middle",margin:"auto 0 auto 10px",fontSize:"14px",color:"#978f6c"},"@media only screen and (max-width: 1050px)":{dates:{marginLeft:"5px",marginRight:"5px"}}});var u=_.create("div",{class:t.classes.dates,text:r.dateText});s.appendChild(u),t.add({price:{extend:"cell",verticalAlign:"middle",fontSize:"20px",fontWeight:"bold",margin:"auto 10px",lineHeight:"23px",color:"#4b9f00","& *":{fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit"}},"@media only screen and (max-width: 1050px)":{price:{fontSize:"16px",marginLeft:"5px",marginRight:"5px"}}}),a.appendChild(_.create("div",{class:t.classes.price,append:[r.priceText]})),t.add({openBtn:{extend:"cell",verticalAlign:"middle",fontSize:"16px",fontWeight:"bold",color:"#FFF !important",margin:"auto 10px",padding:"10px 25px",backgroundColor:"#4b9f00 !important",borderRadius:"19px",textDecoration:"none","&:hover":{backgroundColor:"#66ad26 !important",color:"#FFF !important"}},"@media only screen and (max-width: 1050px)":{openBtn:{fontSize:"14px",marginLeft:"5px",marginRight:"5px",paddingLeft:"10px",paddingRight:"10px"}}});var d=_.create("a",{class:t.classes.openBtn,href:r.url,target:"_blank",append:[r.open]});_.jsLink(d,(function(t){e.content.onClick()}));if(a.appendChild(d),r.suggestList.length){var p=e.getHotelSuggests(r.suggestList);a.appendChild(p)}return{node:a,moreBtn:d,moreBtnClick:function(){window.open(r.url),e.content.onClick()},onAppend:function(){k.emit("track",{cd:"hotelshow",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"show",el:e.siteTag,cd:"hotelshow",t:"event"}),e.barContent.isSuggest&&(k.emit("track",{cd:"hotelNearbyShow",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"nearbyShow",el:e.siteTag,cd:"hotelNearbyShow",t:"event"}))},onReplace:function(){k.emit("track",{ec:"hotel",ea:"update",el:e.siteTag,t:"event"}),e.barContent.isSuggest&&(k.emit("track",{cd:"hotelNearbyUpdate",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"nearbyUpdate",el:e.siteTag,cd:"hotelNearbyUpdate",t:"event"}))},onShow:function(){},onClick:function(){k.emit("track",{cd:"hotelclick",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"click",el:e.siteTag,cd:"hotelclick",t:"event"}),e.barContent.isSuggest&&(k.emit("track",{cd:"hotelNearbyClick",t:"screenview"}),k.emit("track",{ec:"hotel",ea:"nearbyClick",el:e.siteTag,cd:"hotelNearbyClick",t:"event"}))},onClose:function(){k.emit("track",{ec:"hotel",ea:"close",el:e.siteTag,t:"event"})}}}},{key:"getContent",value:function(){return"hotel"===this.type?this.insertHotelBar():"avia"===this.type?this.insertAviaBar():"cars"===this.type?this.insertCarsBar():void 0}},{key:"getStyle",value:function(){var e=this,t=e.wDom.createElement("style",{},e.wSheets.toString());return e.wSheets.onChange=function(){t.setText(e.wSheets.toString())},{node:t.getNode()}}},{key:"getProfileSvg",value:function(e,t,r,a){if(k.currentProfile.getSvgTemplate){var n=k.currentProfile.getSvgTemplate(e,{width:t,height:r,color:a});if(n){return function e(t,r){var a=Object(i.a)(t,3),n=a[0],o=a[1],c=void 0===o?{}:o,s=a[2],l=void 0===s?[]:s,u=document.createElementNS(r,n);for(var d in c)u.setAttribute(d,c[d]);return l.forEach((function(t){u.appendChild(e(t,u.namespaceURI))})),u}(n,"http://www.w3.org/2000/svg")}}}},{key:"getCloseSvg",value:function(e,t){var r=this.getProfileSvg("close",e,t);if(r)return r;var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=a.namespaceURI;a.setAttribute("width",e||"80"),a.setAttribute("height",t||e||"80"),a.setAttribute("viewBox","0 0 80 80");var i=document.createElementNS(n,"path");return a.appendChild(i),i.setAttribute("fill","#000"),i.setAttribute("d","M56.971 52.729L44.243 40l12.728-12.728-4.242-4.243L40 35.757 27.272 23.029l-4.243 4.243L35.757 40 23.029 52.729l4.243 4.242L40 44.243l12.729 12.728z"),a}},{key:"getOneWaySvg",value:function(){var e=this.getProfileSvg("oneWay");if(e)return e;var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=t.namespaceURI;t.setAttribute("width","24px"),t.setAttribute("height","24px"),t.setAttribute("viewBox","4 4 24 24");var a=document.createElementNS(r,"path");return t.appendChild(a),a.setAttribute("fill","#000"),a.setAttribute("d","M4.538 16.618h21.626l-4.48 4.463a.537.537 0 0 0 0 .761c.21.211.551.211.761 0l5.328-5.327a.543.543 0 0 0 0-.762l-5.328-5.327a.537.537 0 0 0-.761 0 .537.537 0 0 0 0 .761l4.48 4.354H4.538a.538.538 0 1 0 0 1.077z"),t}},{key:"getTwoWaySvg",value:function(){var e=this.getProfileSvg("twoWay");if(e)return e;var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=t.namespaceURI;t.setAttribute("width","24px"),t.setAttribute("height","24px"),t.setAttribute("viewBox","4 4 24 24");var a=document.createElementNS(r,"path");return t.appendChild(a),a.setAttribute("fill","#000"),a.setAttribute("d","M27.391 10.382H5.764l4.481-4.463a.538.538 0 0 0-.761-.761l-5.328 5.328a.542.542 0 0 0 0 .761l5.328 5.328a.538.538 0 0 0 .761-.761L5.764 11.46H27.39a.539.539 0 0 0 .001-1.078zM4.538 21.618h21.626l-4.48 4.463a.537.537 0 0 0 0 .761c.21.211.551.211.761 0l5.328-5.327a.543.543 0 0 0 0-.762l-5.328-5.327a.537.537 0 0 0-.761 0 .537.537 0 0 0 0 .761l4.48 4.354H4.538a.538.538 0 1 0 0 1.077z"),t}},{key:"getStarSvg",value:function(e,t,r){var a=this.getProfileSvg("star",t,r,e);if(a)return a;var n=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=n.namespaceURI;n.setAttribute("width",t||"24"),n.setAttribute("height",r||t||"24"),n.setAttribute("viewBox","0 0 24 24"),e=e||"#000";var o=document.createElementNS(i,"path");return n.appendChild(o),o.setAttribute("fill",e),o.setAttribute("d","M9.362 9.158l-5.268.584c-.19.023-.358.15-.421.343s0 .394.14.521c1.566 1.429 3.919 3.569 3.919 3.569-.002 0-.646 3.113-1.074 5.19a.504.504 0 0 0 .196.506.494.494 0 0 0 .538.027c1.844-1.047 4.606-2.623 4.606-2.623l4.604 2.625c.168.092.379.09.541-.029a.5.5 0 0 0 .195-.505l-1.07-5.191s2.353-2.14 3.918-3.566a.499.499 0 0 0-.279-.865c-2.108-.236-5.27-.586-5.27-.586l-2.183-4.83a.499.499 0 1 0-.909 0l-2.183 4.83z"),n}},{key:"getBody",value:function(){var e=this,t=e.wDom,r=e.wSheets.getSheet();r.add({body:{extend:_.styleReset,backgroundColor:"#fcefb4",color:"#000",cursor:"pointer",marginTop:"0px",display:"table !important",opacity:"1 !important",position:"fixed",top:"0px",left:"0px",fontWeight:"normal",font:"normal normal 14px Arial, sans-serif",width:"100%",height:"55px",lineHeight:"normal",zIndex:"2147483647","&:hover":{backgroundColor:"#ffeb91"}},itemLeft:{display:"table-cell",verticalAlign:"middle"},itemLeftCloseBtn:{marginLeft:"4px",marginTop:"10px"},itemMiddle:{display:"table-cell",verticalAlign:"middle",textAlign:"center"},content:{maxWidth:"1100px",display:"inline-block",width:"100%",textAlign:"left",position:"relative"},contentChild:{fallbacks:[{display:"block"},{WebkitAlignItems:"center",WebkitFlexDirection:"row",display:"-webkit-flex"}],display:"flex",alignItems:"center",flexDirection:"row",whiteSpace:"pre"},closeBtn:{width:"45px",opacity:"0.3",display:"block",height:"45px",textAlign:"center",cursor:"pointer","&:hover":{opacity:"0.7"}},rightPadding:{width:"45px",display:"table-cell",verticalAlign:"middle"},"@media only screen and (max-width: 1150px)":{content:{maxWidth:"960px"}},"@media only screen and (max-width: 1050px)":{content:{maxWidth:"810px"},closeBtn:{width:"24px"},rightPadding:{width:"24px"}},"@media only screen and (max-width: 850px)":{content:{maxWidth:"700px"}}});var a,n=_.create("div",{class:r.classes.body,style:{position:"fixed",top:"0px",left:"0px",display:"table",width:"100%",height:"55px",lineHeight:"normal",opacity:"1",zIndex:"2147483647"},on:["click",function(t){t.stopPropagation(),t.preventDefault(),e.content.moreBtnClick()}],append:[_.create("div",{class:r.classes.itemLeft,append:_.create("a",{class:r.classes.closeBtn,href:"#close",title:k.language.close,on:["click",function(t){t.preventDefault(),t.stopPropagation(),t.isTrusted&&(e.close(!0),e.content.onClose())}],append:_.create(e.getCloseSvg("24"),{class:r.classes.itemLeftCloseBtn})})}),_.create("div",{class:r.classes.itemMiddle,append:_.create("div",{class:r.classes.content,append:a=_.create("div",{class:r.classes.contentChild})})}),_.create("div",{class:r.classes.rightPadding})]});t.wGet(n).setCheckStyles(["display","position","top","left","marginTop","marginLeft","marginRight","marginBottom","opacity","zIndex","transform","visibility"]);var i=function(e){e.stopPropagation()},o=[!1,!0];return["pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup"].concat(["mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseout","mouseup"]).forEach((function(e){o.forEach((function(t){"mouseenter"===e&&t||n.addEventListener(e,i,t)}))})),{node:n,content:a}}},{key:"insertBody",value:function(e){var t=document.body,r=k.currentProfile,a=r.bodySelector;if(a){"function"==typeof a&&(a=r.bodySelector());var n=document.querySelector(a);n?t=n:k.error("Body insert container is not found!")}var i=this.wrapNode(e.node),o=i.strip();return this.wDom.get(o).setAttribute("style","display: none;"),t.appendChild(o),e.removeWatcher.start(),new Promise((function(e){return setTimeout(e,1)})).then((function(){i.restore()}))}},{key:"replaceBody",value:function(e,t){var r=t.parentNode;if(!r)return this.insertBody(e);var a=this.wrapNode(e.node),n=a.strip();return this.wDom.get(n).setAttribute("style","display: none;"),r.replaceChild(n,t),e.removeWatcher.start(),new Promise((function(e){return setTimeout(e,1)})).then((function(){a.restore()}))}},{key:"insertStyle",value:function(e){var t=document.body,r=k.currentProfile,a=r.styleSelector;if(a){"function"==typeof a&&(a=r.styleSelector());var n=document.querySelector(a);n?t=n:k.error("Style insert container is not found!")}var i=this.wrapNode(e.node);return t.appendChild(i.strip()),e.removeWatcher.start(),new Promise((function(e){return setTimeout(e,1)})).then((function(){i.restore()}))}},{key:"replaceStyle",value:function(e,t){var r=t.parentNode;if(!r)return this.insertStyle(e);var a=this.wrapNode(e.node);return r.replaceChild(a.strip(),t),e.removeWatcher.start(),new Promise((function(e){return setTimeout(e,1)})).then((function(){a.restore()}))}},{key:"destroy",value:function(){this.styleWatcher.destroy(),this.body.changeWatcher.destroy(),this.style.changeWatcher.destroy(),this.body.removeWatcher.destroy(),this.style.removeWatcher.destroy(),this.wDom.destroy()}},{key:"remove",value:function(){if(!this.isRemoved){this.isRemoved=!0,this.destroy();var e=this.body.node.parentNode;e&&e.removeChild(this.body.node),(e=this.style.node.parentNode)&&e.removeChild(this.style.node)}}},{key:"wrapNode",value:function(e){var t=this,r=[];return{strip:function(){return function e(a){var n=t.wDom.get(a);return[].slice.call(n.refNode.attributes).forEach((function(e){r.push({type:"setAttribute",wNode:n,name:e.name,value:e.value}),n.removeAttribute(e.name)})),[].slice.call(n.refNode.childNodes).forEach((function(a){var n=t.wDom.getByRef(a);3===n.refNode.nodeType?(r.push({type:"setTextContent",wNode:n,value:n.refNode.textContent}),n.setTextContent("")):1===n.refNode.nodeType&&e(n.node)})),a}(e)},restore:function(){r.splice(0).forEach((function(e){var t=e.wNode;switch(e.type){case"setAttribute":t.setAttribute(e.name,e.value);break;case"setTextContent":t.setTextContent(e.value)}}))}}}},{key:"insert",value:function(){var e=this,t=this.body,a=this.style;return Promise.all([this.insertBody(t),this.insertStyle(a)]).then((function(){r(e,!0),e.styleWatcher.start()}))}},{key:"replace",value:function(e){var t=this;e.isRemoved=!0,e.isClosed=!0,e.destroy();var r=e.body,a=this.body,n=e.style,i=this.style;return Promise.all([this.replaceBody(a,r.node),this.replaceStyle(i,n.node)]).then((function(){t.styleWatcher.start()}))}},{key:"close",value:function(t){try{if(!this.isClosed&&(this.isClosed=!0,this.remove(),r(this,!1),t))return e.watcher.stopObserver(),s.sendMessage({action:"tbrCloseBar",hostname:this.siteTag})}catch(e){k.trackError(e)}}}]),t}();return{current:null,create:function(e){var t=this.current,r=this.current=new c(e),a=!1;return Promise.resolve().then((function(){return t&&!t.isClosed?(a=!0,r.replace(t)):r.insert()})).then((function(){a?r.content.onReplace():r.content.onAppend(),r.content.onShow()}))},aviaBarSaveInHistory:function(e,t){if(k.appInfo.history){var r="",a="",n="",i="";if(t.data.some((function(e){return r=e.origin,a=e.originName,n=e.destination,i=e.destinationName,!0})),r&&a&&n&&i){var o={origin:r,originCity:a,destination:n,destinationCity:i,dateStart:e.dateStart,dateEnd:e.dateEnd,time:parseInt(Date.now()/1e3)};return k.emit("history",o)}}}}},xe=function(){var e=k.main,t={price:function(e,t,r){var a=e.page;r.key||(r.key="price");for(var n,i=0;n=t.added[i];i++){var o=_.preparePrice(n.textContent);a.setPrice(r.key,o)}},currency:function(e,t,r){var a=e.page;r.key||(r.key="currency");for(var n,i=0;n=t.added[i];i++){var o=n.textContent,c=o&&o.replace(/[\s\t]/g,"");r.currencyMap&&r.currencyMap[c]&&(c=r.currencyMap[c]),a.set(r.key,c)}}},r=function(t){var r=this,a=null,n={},i={},o=function(){if(a){var r=e[a].page.getPriceId(n);delete s().barRequestData,function(){for(var e in i)delete i[e]}(),t.matchPrice=!!r}},c=_.debounce((function(t){var i=e[a].page.getData(n,t);i&&r.setData(a,i)}),50);this.setData=function(e,t){t.type=e;var r=s();for(var a in t)r[a]=t[a];l(t)},this.setType=function(e){a=e},this.set=function(e,t){t=_.validate(e,t);var r,a,i=n[e];r=t,a=i,(Array.isArray(r)&&a?JSON.stringify(r)===JSON.stringify(a):r===a)||(n[e]=t,k.log("Page set",e,t),o())},this.get=function(e){return n[e]||null},this.setPrice=function(t,r){if(!(r=_.validate(t,r)))return k.error("setPrice error, value is not valid",t,r);if(!a)return k.error("setPrice error, type is not found!",n);var o=function(e){var t=i[e];return t||(i[e]=t={}),t}(e[a].page.getPriceId(n)),s=o[t];r&&s!==r&&(!s||s>r)&&(o[t]=r,k.log("Page setPrice",t,r),c(o))},this.clear=function(){for(var e in k.log("Page clear"),t.matchPrice=!1,a=null,n)n[e]=null}},a=function(e,t){var r=null;this.stop=function(){r&&r.stop(),r=null},this.start=function(){r&&r.stop(),r=function(e,t){var r=[],a=[];return Object.keys(t).forEach((function(e){var n=t[e].query;return Array.isArray(n)||(n=[n]),n.forEach((function(t){a.push(e),r.push(t)}))})),_.mutationWatcher.run({callback:function(r){for(var n,i=0;n=r[i];i++)if(0!==n.added.length||0!==n.removed.length){var o=t[a[i]];e.summaryStack.push([o,n])}},queries:r})}(e,t)},this.destroy=this.stop},n=function(e){var r=[],a=t,n=function(){var t=r.length;if(t>30&&r.shift(),1===t)return function t(){var n=r[0];if(n){var i=n[0],o=n[1],c=Promise.resolve();i.isPrice&&!e.matchPrice||(i.cb&&(c=c.then((function(){return i.cb(e,o)}))),i.template&&(c=c.then((function(){return(0,a[i.template])(e,o,i)})))),c.catch((function(e){k.error("Parse item error!",e),k.trackError(e)})).then((function(){var e=r.indexOf(n);-1!==e&&r.splice(e,1),t()}))}}()};this.push=function(e){return r.push(e),n()}},i=function(e){var t=this,i={};for(var o in e.formWatcher)i[o]=e.formWatcher[o];for(var c in e.priceWatcher)i[c]=e.priceWatcher[c],i[c].isPrice=!0;t.matchPrice=!1,t.summaryStack=new n(t),t.watcher=new a(t,i),t.page=new r(t),t.watcher.start(),t.destroy=function(){t.watcher&&t.watcher.destroy()}},o=null,c={},s=function(){var e=location.href,t=c[e];return t||(t=c[e]={}),t},l=function(){var t=s(),r=e[t.type];return r?r.onGetData(t):k.error("Type is not found!",t)};return{closeCurrentBar:function(){var t=e.bar.current;e.bar.isAborted=!0,t&&!t.isClosed&&t.close()},stopObserver:function(){o&&o.destroy()},clearInfoObj:function(e){for(var t in c)c[t]!==e&&delete c[t]},initProfile:function(e){o&&o.destroy(),o=new i(e)}}};!function(e){if(-1!==["interactive","complete"].indexOf(document.readyState))e();else{var t=function t(){document.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1),e()};document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)}}((function(){Promise.resolve().then((function(){if(!document.body)throw new l("Not document!");if(_.isFrame())throw new l("Inside frame!");if(_.isDeny())throw new l("Is deny!");k.hostname=location.hostname,k.siteTag="unknown";var e=function(){for(var e,t=location.origin||location.protocol+"//"+location.hostname,r=S,a=Object.keys(r),n={},o=0;e=a[o];o++)if(new RegExp(C(e)).test(t)){n.pattern=e;var c=Object(i.a)(r[e],2),s=c[0],l=c[1];n.id=s,n.tag=l;break}return n.id||(n=null),n}();if(!e)throw k.error("Profile is not exists!",location.href),new l("Profile is not exists!");return k.siteTag=e.tag,s.sendMessagePromise=function(e){return new Promise((function(t){try{s.sendMessage(e,t)}catch(e){throw k.error("API error",e),new l("API error")}}))},s.sendMessagePromise({action:"tbrGetInfo"}).then((function(t){if(_.extend(k.appInfo,t),k.log("Version",k.version),k.log("Set info",t),!t.id)throw new l("Partner id is not set!");var r=null;return k.appInfo.useTemplates&&(r=s.sendMessagePromise({action:"tbrGetTemplate",id:e.id})),r})).then((function(t){if(k.currentProfile=B(e,t),!k.currentProfile)throw k.error("Invalid location!",location.href),new l("Invalid location!")})).then((function(){return s.sendMessagePromise({action:"tbrIsAllow",hostname:k.hostname}).then((function(e){if(!e)throw k.log("Bar is closed!",k.hostname),new l("Bar is closed!");if(_.tbrExists())throw new l("Bar exists!");if(!_.mutationWatcher.isAvailable())throw new l("MutationObserver is not support!");_.tbrSetGlobal(),k.language=$}))}))})).then((function(){var e,t=k.main;t.avia=U(),t.hotel=j(),t.cars=z(),t.currency=(e=null,{exists:function(t){return!!e[t]},load:function(){return e?Promise.resolve(e):_.request({url:"https://api.travelbar.tools/v1/as/currencies/all_currencies_rates?"+_.param({partnerId:k.appInfo.id})}).then((function(t){var r=JSON.parse(t.body),a={};return Object.keys(r).forEach((function(e){a[e.toUpperCase()]=r[e]})),e=a}))},convert:function(t,r,a){return a=a.toUpperCase(),r=r.toUpperCase(),t*e[r]/e[a]}}),t.bar=ke(),t.watcher=xe(),t.watcher.initProfile(k.currentProfile)})).catch((function(e){e instanceof l?k.log(e.message):(k.error("Init error!",e),k.trackError(e))}))}))}])}),(function(){return!Object(p.a)()&&d.a.callFn("getPreferences").then((function(e){return!!e.hasAviaBar&&!!e.aviaBarEnabled}))}))}});